eV.prototype.eUa=qQ(211,function(a){this.J=nb(arguments,0)});function SW(a){Nf(this,a,0,-1,null,null)}x(SW,Mf);function TW(a){Nf(this,a,0,-1,null,null)}x(TW,Mf);function UW(a,b){W(a,1,b)}function yIc(a,b){W(a,3,b)}function zIc(a,b){W(a,6,b)}function VW(a,b){return V(a,2,b)}function AIc(a,b,c,d,e){return b3b(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.H,!0)},a))}function BIc(a,b){a.D=b}
function CIc(a){var b=0;z(a,function(c,d){c.length>a[b].length&&(b=d)});return Wa(a[b],function(b,d){return Wa(a,function(a){return a[d]})})}function DIc(a){a=vI(a.D);return null!=a?a.toString():"0"}function EIc(a,b){var c={row:0,xj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Vc()+1?c.row=b.Vc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Xc()+1&&(c.xj=b.Xc()+1));return c}
function FIc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=DIc(a);c=EIc(e,c);(a=AIc(a.C,b,e,c.row,c.xj))&&d&&a.length<a[0].length&&(a=CIc(a));return a}function GIc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function HIc(a,b){dV(a);for(var c=0;c<b.length;c++)Yzc(a,b[c])}function IIc(a,b){if(a.Qb()){if(b){var c=ye(document);c&&c==a.D.Qa()&&a.C.focus()}Fh(a.Qa(),"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}}
var JIc=[2];function KIc(a){Nf(this,a,0,-1,JIc,null)}x(KIc,Mf);var LIc={fDc:0,Qya:1,tza:2},MIc=[1,2];function NIc(a){Nf(this,a,0,-1,MIc,null)}x(NIc,Mf);var OIc=[1];function PIc(a){Nf(this,a,0,-1,OIc,null)}x(PIc,Mf);var QIc=[1];function RIc(a){Nf(this,a,0,-1,QIc,null)}x(RIc,Mf);var SIc=[1];function TIc(a){Nf(this,a,0,-1,SIc,null)}x(TIc,Mf);var UIc=[3];function VIc(a){Nf(this,a,0,-1,UIc,null)}x(VIc,Mf);VIc.prototype.getChartType=function(){return F(this,1)};
function WIc(a){Nf(this,a,0,-1,null,null)}x(WIc,Mf);function XIc(a){Nf(this,a,0,-1,null,null)}x(XIc,Mf);XIc.prototype.getChartType=function(){return F(this,1)};function YIc(a){Nf(this,a,0,-1,null,null)}x(YIc,Mf);YIc.prototype.qf=function(){return F(this,2)};
function WW(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function XW(a){return a[WW(a.length,1)[0]]}function ZIc(a){var b={};z(a,function(a){b[a]||(b[a]=0);b[a]++});ob(a);tb(a,function(a,d){return b[d]-b[a]})}
function $Ic(){return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function aJc(a,b,c){b=c||b;return P(O(Br({Kd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:sr(""+O(Ds({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+O(Br({Kd:"waffle-assistant-zoom-button",content:sr(""+O(Ds({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}function YW(){}x(YW,jr);ta(YW);YW.prototype.hc=n("waffle-assistant-button");function bJc(a,b,c){b=c||b;a=rr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+O(Ds({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+R(a)+'" aria-label="'+R(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+R("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+O(Ds({icon:"docs-icon-img docs-icon-cancel"},b))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return P(a)};function ZW(a){M.call(this,a);this.D=new lr("",new YW,this.oa());this.Fa(this.D);this.H=new YU(!1,"#4285f4");this.Fa(this.H);this.C=this.J=this.F=null}q(ZW,M);ZW.prototype.xa=function(){this.Yc(N(bJc))};ZW.prototype.Yc=function(a){M.prototype.Yc.call(this,a)};
ZW.prototype.Ga=function(){M.prototype.Ga.call(this);var a=this.oa();this.C=a.Ia("waffle-assistant-answers-query-box",this.Qa());this.D.hb(a.Ia("waffle-assistant-answers-clear-query-button",this.C));this.F=a.Ia("waffle-assistant-answers-spinner-container",this.C);this.H.render(this.F);this.J=a.Ia("waffle-assistant-answers-input-box",this.C)};ZW.prototype.setVisible=function(a){this.getElement()&&(L(this.getElement(),a),(a=Qt)&&a.dispatchEvent("resize"))};function cJc(a,b,c,d,e,f){D.call(this,"sqc");this.O=a;this.F=f||"";this.V=b;this.H=d;this.Ba=e;this.C=c}x(cJc,D);cJc.prototype.Fj=g("V");function dJc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;D.call(this,"answers-submit-query");this.O=a;this.V=b;this.H=c;this.F=d;this.Ba=e;this.C=f;this.Ha=h}x(dJc,D);function eJc(){this.F=[];this.D={};this.J=null;this.C=new dw}function fJc(a,b,c,d){function e(a){return a.toLowerCase()}ob(b,void 0,e);ob(c,void 0,e);ob(d,void 0,e);z(b,a.H,a);z(c,a.H,a);z(d,a.H,a)}eJc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function gJc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}eJc.prototype.vH=function(a,b,c){if(Lb(a||"")){var d=this.J.Bm();d=hJc(this,a.substring(0,d));var e=iJc(this,b-d.length,a);d=kb(d,e)}else d=iJc(this,b);d.length>b&&(d=nb(d,0,b));c(a,d)};
function iJc(a,b,c){var d=c||"";c=ic(a.D,function(a){return Fb(a,d)});var e=jJc(nc(c),d?1:2,1);a=Ua(a.F,function(a){return Fb(a.query,d)&&!e[a.query.toLowerCase()]});b=jJc(a,b-mc(e),2);b=nc(b);var f=Wa(b,function(a,b){a.Ura=b;return a.IVa});z(b,function(a){a.Sra=f});return kb(b,nc(e))}
function hJc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={yba:h.yba,K_:h.K_,tS:h.tS},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.tS={};h.K_=0;h.yba=f.substr(k);var l=a.C.Ue(h.yba);z(l,function(b){return function(c){var d=c.length-b.yba.length;b.K_=Math.max(d,b.K_);c=a.C.get(c);b.tS[d]||(b.tS[d]=[]);mb(b.tS[d],c)}}(h));for(l=0;l<=h.K_&&0<d;++l){var m=h.tS[l];if(m)for(var r=0;r<m.length&&0<d;++r){var u=m[r];Rb(b.toLowerCase(),u.toLowerCase())||e[u]||(--d,c.push({text:u,xo:"",
wA:0,dBa:f.length-k,IVa:void 0,Sra:[],Ura:-1}),e[u]=!0)}}}return c}function jJc(a,b,c){b=WW(a.length,Math.min(a.length,b));var d={};z(b,function(b){b=a[b];var e=ma(b)?b:b.query;d[e.toLowerCase()]={text:e,xo:ma(b)?"":b.xo,wA:c,dBa:0,IVa:ma(b)?void 0:b.type,Sra:[],Ura:-1}});return d};function $W(){yO.call(this,"",null,!1)}x($W,yO);$W.prototype.nD=function(a,b){if(2==a.wA||1==a.wA)return $W.ea.nD.call(this,a.text,b);var c=this.La(),d=this.Bm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.dBa)+a.text;e||(f+=" ");a=$W.ea.nD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.hk;b.blur();b.focus();this.N0(f.length);return a};
$W.prototype.Uf=function(a){var b=$W.ea.Uf.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,LSb(b)&&b.fC()&&a.preventDefault(),b=!0);return b};function kJc(a,b,c){b=c||b;return P('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+O(Ds({icon:"docs-icon-img docs-icon-help"},b))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+O(Ds({icon:"docs-icon-img docs-icon-clock"},b))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+O(Ds({icon:"docs-icon-img docs-icon-arrow-tilted"},b))+
'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')};function lJc(a){this.pb=a||Ld()}
lJc.prototype.Bu=function(a,b,c){b=N(kJc);var d=this.pb.Ia("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.pb.Re(d,a.text);d=this.pb.Ia("waffle-assistant-answers-ac-entity-icon",b);var e=this.pb.Ia("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.pb.Ia("waffle-assistant-answers-ac-session-query-icon",b);L(d,0==a.wA);L(e,2==a.wA);L(f,1==a.wA);d="";switch(a.wA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Bh(c,d);this.pb.appendChild(c,b)};function aX(a,b,c){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Lb(b),dj(a,b,void 0),Vtc(a),a.setAttribute("data-tooltip-delay",500),Z9b(a,t(c)?c:1))};function mJc(a){var b=a.type;switch(ma(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function nJc(a,b){var c=a.type;switch(ma(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(ma(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":ma(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function oJc(a,b,c,d){A.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new $W;this.H.bGa=!0;this.H.Ha=!0;this.qa(this.H);this.V=c;this.V.J=this.H;a=new wO(null,new lJc(a.oa()));this.C=new uO(this.V,a,this.H);this.qa(this.C);this.ma=b;this.J=!1;this.$=Aj(new zj,d).build();this.Ja=new Ih(this);this.qa(this.Ja);pJc(this)}q(oJc,A);
function pJc(a){qJc(a);a.H.C=a.C;a.C.IY=!1;a.C.P9=6;bTb(a.H,a.D);aX(a.F.getElement(),"Clear query");a.Ja.R(a.C,"update",a.Knb).R(a.L,"submit",a.gMb).R(a.L,"focus",function(){return rJc(a,!0)},!0).R(a.L,"blur",function(){return rJc(a,!1)},!0).R(a.F,"action",a.$7a).R(a.D,"input",a.JWa).R(a.D,"focus",a.mTa);a.F.setVisible(!1)}p=oJc.prototype;p.Ea=function(){A.prototype.Ea.call(this);this.V.J=null};function sJc(a,b,c){c=void 0===c?!1:c;nJc(a.D,b);c&&a.D.focus();a.JWa()}
function qJc(a){a=a.C.Nd();a.className="waffle-assistant-answers-ac-renderer";a.RM="waffle-assistant-answers-ac-row";a.s3="waffle-assistant-answers-ac-active";a.Ema="waffle-assistant-answers-ac-highlighted"}p.Knb=function(a){a.row&&(a=a.row,2==a.wA?(tJc(this,1,a.Sra,a.Ura,a.xo,2),this.ma.Vb(2652,this.$)):0==a.wA?(this.J=!0,this.ma.Vb(2651,this.$)):1==a.wA&&tJc(this,3))};function rJc(a,b){Fh(a.L,"waffle-assistant-answers-query-box-focused",b);vO(a.C)&&!b&&a.C.Th()}p.JWa=function(){this.F.setVisible(!!mJc(this.D))};
p.mTa=function(){this.C.cw(this.D);var a=Xb(mJc(this.D));this.H.N0(a.length);ISb(this.C,a||"  ");this.C.update(!0)};p.gMb=function(a){a.stopPropagation();a.preventDefault();tJc(this,2)};function tJc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Lb(mJc(a.D));a.F.setVisible(!!h);uJc(a);a.O.dispatchEvent(new dJc(b,h,a.J,c,d,e,f));a.J=!1}p.$7a=function(){nJc(this.D,"");this.F.setVisible(!1)};function uJc(a){a.D.blur();vO(a.C)&&a.C.Th()};function vJc(a,b){M.call(this,b);this.F=a;this.H=new eJc;this.C=new ZW(this.oa());this.Fa(this.C);this.D=null}q(vJc,M);vJc.prototype.Yc=function(a){M.prototype.Yc.call(this,a);this.C.render(a)};vJc.prototype.Ga=function(){M.prototype.Ga.call(this);this.D=new oJc(this.C,this.F,this.H,4);this.qa(this.D);Bh(this.C.Qa(),"waffle-assistant-answers-input-with-icon")};function wJc(){return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function xJc(a,b,c){b=c||b;return P(O(Br({Kd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:sr(""+O(Ds({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+O(Br({Kd:"waffle-assistant-zoom-button",content:sr(""+O(Ds({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))};function yJc(a){var b='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',c='By <span class="waffle-assistant-facet-title">'+(O(a.g8a)+"</span>"),d=0==a.tFa.length;b=b+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=P('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.tFa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+O(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=P(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(iB?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return P(b)};function bX(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;D.call(this,a,b);this.C=b;this.Ka=c;this.H=d;this.O=e;this.Ma=f}q(bX,D);bX.prototype.cj=g("Ka");function zJc(a,b,c,d,e,f,h){h=void 0===h?null:h;bX.call(this,"Yd",null,d,e,f);this.V=a;this.Ba=b;this.Dc=c;this.F=h}q(zJc,bX);zJc.prototype.Zd=g("Dc");function AJc(a,b,c,d,e,f,h,k){M.call(this,k);this.J=a;this.D=b;this.O=e;this.V=f;this.F=h;this.C=this.Dc=null;this.L=Aj(new zj,10).build()}x(AJc,M);AJc.prototype.Ga=function(){AJc.ea.Ga.call(this);(new iT(yJ,this.D.eh)).send(v(this.H,this,this.D))};AJc.prototype.hKa=function(a,b){a=new zJc(this.J.clone(),this.O,this.Dc,2746,a,b);this.dispatchEvent(a)};
AJc.prototype.H=function(a,b){var c=this;if(b)if(b.Ti())kJ.zE(this.Qa(),b);else{a.Af(b.Zd());sU(a,a.Zd());var d=(b=a.Zd())?b.toJSON():null,e=new ritz.charts.model.GvizChart;e.updateChartWrapperJsonString(a.toJSON());d&&e.updateDataTableJsonString(d);nzc(e,this.Qa(),this.V,this.F,function(a){BJc(c,a)});this.Dc=b}};
function BJc(a,b){a.getHandler().R(b,"waffle-tvizchart-tooltip-shown",function(){a.C=Fa()}).R(b,"waffle-tvizchart-tooltip-hidden",function(){pa(a.C)&&500<Fa()-a.C&&a.F.Vb(2750,a.L);a.C=null})};function CJc(){return P('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function DJc(a,b){M.call(this,b);this.D=a;this.C=new lr("",new $U,this.oa());this.Fa(this.C)}x(DJc,M);p=DJc.prototype;p.xa=function(){this.Ua=N(CJc)};p.Ga=function(){DJc.ea.Ga.call(this);var a=this.Ia("waffle-assistant-feedback-card-link");this.C.hb(a);this.getHandler().R(this.Qa(),"mousedown",this.U2b).R(this.C,"action",this.Htb);this.show(!1)};p.U2b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Qa(),c=this.Ia("waffle-assistant-feedback-card-link");Fh(b,"waffle-assistant-feedback-card-hidden",!a);te(c,a)};p.Htb=function(){K.Qu.Wb({source:this.D});this.show(!1);this.dispatchEvent(new D("feedback-dialog-opened"))};function EJc(a,b,c){b=c||b;a='<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?'+('</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+O(Ds({icon:"docs-icon-img docs-icon-thumb-up"},b))+'</div><div class="waffle-assistant-thumbs-down-button">'+O(Ds({icon:"docs-icon-img docs-icon-thumb-down"},b))+"</div></div></div>");return P(a)};function cX(a){M.call(this,a);this.C=new lr("",new YW,this.oa());this.Fa(this.C);this.D=new lr("",new YW,this.oa());this.Fa(this.D)}x(cX,M);cX.prototype.xa=function(){this.Ua=N(EJc)};cX.prototype.Ga=function(){cX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-thumbs-down-button");this.C.hb(a);aX(a,"Not useful");a=this.Ia("waffle-assistant-thumbs-up-button");this.D.hb(a);aX(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function FJc(a,b){a.oa().Re(a.Ia("waffle-assistant-thumbs-text"),b)}cX.prototype.F=function(){this.dispatchEvent(new D("thumbs-down"));L(this.Qa(),!1)};cX.prototype.H=function(){this.dispatchEvent(new D("thumbs-up"));L(this.Qa(),!1)};function GJc(a,b,c,d,e,f){M.call(this,f);this.J=a;this.Ka=b;this.Ma=c;this.Ba=d;this.va=e;this.L=tw(this.J,23);this.Ha=V(this.J,22);this.C=V(this.J,26);this.ma=[];this.Pc=new xw;this.O=this.F=this.D=null;this.V=!1;this.$=new Cr("",this.oa());this.Fa(this.$);this.H=null}x(GJc,M);p=GJc.prototype;p.xa=function(){GJc.ea.xa.call(this);this.Ua=N(yJc,{g8a:this.C,tFa:this.L});this.Qa().style.visibility="hidden"};
p.Ga=function(){GJc.ea.Ga.call(this);var a=this.Ia("waffle-assistant-facet-toggle");this.$.hb(a);this.getHandler().R(this.Qa(),"mousedown",this.D2b).R(this.$,"action",this.QGb);iB&&(this.O=new DJc("assistantAutovisFacetFeedback",this.oa()),this.O.render(this.Ia("waffle-assistant-facet-feedback-container")),this.D=new cX(this.oa()),this.Fa(this.D),this.D.render(this.Ia("waffle-assistant-facet-thumbs-container")),FJc(this.D,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.D,
"thumbs-up",this.F2b).R(this.D,"thumbs-down",this.E2b));HJc(this,J(I(),"fefsbd"))};p.Ld=g("V");p.D2b=function(a){a.stopPropagation()};p.QGb=function(){var a=Ah(this.Ia("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");HJc(this,a);IJc(this,a?2647:2646)};
function HJc(a,b){var c=a.Ia("waffle-assistant-facet-toggle");re(c,b?"HIDE":"SHOW");Fh(a.Ia("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);z(a.Oi("waffle-assistant-faceted-chart"),function(a){te(a,b)});a.D&&L(a.D.Qa(),b);var d='Show chart broken down by "'+(a.C+'"');a='Hide chart broken down by "'+(a.C+'"');aX(c,b?a:d)}
function JJc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function KJc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function LJc(a){a.V||z(a.ma,v(function(a){var b=a.Qa();if(!this.va.contains(b)){var d=this.va;a=new MJc(b,a);wzb(d,a)}},a))}p.F2b=function(){IJc(this,2649)};p.E2b=function(){IJc(this,2648);this.O.show(!0)};function IJc(a,b){var c=a.Ba,d=new NU,e=a.H.getChartType();d.J=e;e=a.H.Zd();d.C=e?e.clone():null;fzc(c,b,d,10,a.H,a.H.eh)};var NJc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function OJc(a){var b=new tJ(Ac(NJc));return Tzc(a,b)}
function PJc(a){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.Oc("useFirstColumnAsDomain")&&a.Zd()&&"number"===a.Zd().cd(0)&&a.setOption("hAxis.gridlines.count",
-1);return a};function QJc(){return P('<div class="waffle-assistant-card" tabindex="0" role="region">'+(iB?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(iB?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function dX(a,b){var c=this;M.call(this,b);this.H=a;this.Ka=this.Ha=this.O=null;this.Bb=new YU(!0,"#4285f4");this.Fa(this.Bb);this.Sb=this.Wc=this.Ud=!1;this.Ra=new Mi(function(){c.Ra.stop();c.Qa().parentNode.querySelector(":hover")==c.Qa()?c.Ra.start():c.sG()},100);this.qa(this.Ra);this.Wf=this.Lc=!1}x(dX,M);p=dX.prototype;p.KA=Ie;p.D8=Je;p.XB=Ke;p.WB=Ke;p.E6=Ke;p.Vja=Ke;p.Uja=Ke;p.nt=ca("Wf");p.Ld=g("Wf");p.xa=function(){this.Ua=N(QJc)};
p.Ga=function(){dX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-card-spinner-container");this.Bb.render(a);Sh(this.Ia("waffle-assistant-card-inner"),"visibility","hidden");if(this.KA()){a=this.Qa();var b=new zq(a);this.qa(b);this.getHandler().R(b,"focusin",this.Eob).R(b,"focusout",this.Dob).R(a,"mouseenter",this.pL).R(a,"mouseleave",this.sG)}RJc(this,!1);iB&&(this.Ka=new DJc(this.rz(),this.oa()),this.Ka.render(this.Ia("waffle-assistant-card-feedback-container")),this.getHandler().R(this.Ka,"feedback-dialog-opened",
this.Itb).R(this,"trigger_feedback",this.tYb),this.D8()?(this.Ha=new cX(this.oa()),this.Ha.render(this.Ia("waffle-assistant-thumbs-container")),SJc(this,!0),a=Xb(this.E6()),Jb(a)||FJc(this.Ha,a),a=Xb(this.Vja()),Jb(a)||aX(this.Ha.Ia("waffle-assistant-thumbs-up-button"),a),a=Xb(this.Uja()),Jb(a)||aX(this.Ha.Ia("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.Ha,"thumbs-down",this.S2b).R(this.Ha,"thumbs-up",this.T2b)):SJc(this,!1));this.zA()};
function eX(a){return a.Ia("waffle-assistant-card-content-container")}function fX(a){a.KA();return a.Ia("waffle-assistant-card-options")}function SJc(a,b){iB&&L(a.Ia("waffle-assistant-thumbs-container"),a.D8()&&b)}p.zJ=function(){this.isDisposed()||(this.Ud=!0,TJc(this))};function UJc(a,b){!a.Wc&&b&&(a.Wc=!0,TJc(a))}function TJc(a){if(a.Ud&&a.Wc){var b=v(a.R2b,a);a.wy(b)}}p.pL=function(){this.Sb||(RJc(this,!0),this.Sb=!0,this.Ra.start())};p.sG=function(){RJc(this,!1);this.Sb=!1};
p.Eob=function(){RJc(this,!0)};p.Dob=function(){var a=this,b=new Mi(function(){pe(a.Qa(),document.activeElement)||a.Qa().parentNode.querySelector(":hover")==a.Qa()||RJc(a,!1)},0);this.qa(b);b.start()};p.S2b=function(){VJc(this,!0);SJc(this,!1);var a=this.WB();this.dispatchEvent(new bX("ce",this,a))};p.T2b=function(){SJc(this,!1);var a=this.XB();this.dispatchEvent(new bX("ce",this,a))};p.Itb=function(){VJc(this,!1)};p.tYb=function(){VJc(this,!0)};
function RJc(a,b){var c=a.Ia("waffle-assistant-card-options");a=a.KA();L(c,a&&b)}p.R2b=function(){ZU(this.Bb,!1);L(this.Bb.Qa(),!1);Sh(this.Ia("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new D("content-rendered"))};function VJc(a,b){Fh(a.Ia("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.Ka.show(b)};function WJc(a,b,c,d,e,f,h){h=void 0===h?null:h;bX.call(this,"Xd",null,d,e,f);this.V=a;this.Ba=b;this.Ha=c;this.F=h}q(WJc,bX);WJc.prototype.Xw=g("V");function XJc(a,b,c){var d=a.Vc(),e=a.Xc();switch(b){case 0:d=Math.min(d,a.mc()+c);break;case 1:e=Math.min(e,a.kc()+c)}return RA(a.Ab(),a.mc(),a.kc(),d,e)}function YJc(a){var b=new Yfa;G(b,1,""+a.jd);var c=a.rect.mc();G(b,2,c);c=a.rect.Vc();G(b,3,c);b.zr(a.rect.kc());b.$x(a.rect.Xc());return b}function ZJc(a){var b=new wg;if(a){var c=new yg;a=YJc(a);Tf(c,7,a);Tf(b,58,c)}return b};function $Jc(a){a.setLegendPositionType(0);var b=a.getAxis(ritz.charts.model.AxisName.X);b&&(b.setSlantedTextAngle(0),b.getTickTextStyle().setFontSize(11));(b=a.getAxis(ritz.charts.model.AxisName.Y))&&b.getTickTextStyle().setFontSize(11);(b=a.getAxis(ritz.charts.model.AxisName.RIGHT))&&b.getTickTextStyle().setFontSize(11);b=a.getGlobalTextStyle();b.setFontSize(10);b.setItalic(!1);a=a.getTitleTextStyle();a.setBold(!1);a.setFontSize(12)};function gX(a,b,c,d,e,f,h,k){dX.call(this,a,k);this.C=V(a,8);this.Cb=b;this.xb=c;this.Hb=d;this.L=e;this.Ta=f;this.Zb=h;this.V=new Cr("",this.oa());this.Fa(this.V);this.$=new Cr("",this.oa());this.Fa(this.$);this.Pc=new xw;this.ub=null;this.Ba=!1;this.jb=[];this.Wa=[];this.Oa=[];this.Ma=this.va=this.D=this.J=this.ma=null;a=ZJc(this.Zb);this.F=Bj(Aj(new zj,10),a).build()}x(gX,dX);
var hX={mYa:"waffle-assistant-after-chart-preview",JYa:"waffle-assistant-before-chart-preview",VYa:"waffle-assistant-card-draggable",J2:"waffle-assistant-chart-highlights",W0a:"waffle-assistant-insert-chart-button",Tda:"waffle-assistant-chart-preview",G3a:"waffle-assistant-button-separator",r4a:"waffle-assistant-styled-border",s4a:"waffle-assistant-styled-rect",J5a:"waffle-assistant-zoom-button"};p=gX.prototype;p.wy=function(a){var b=this;ritz_api.ChartsApi?(this.ub=a,aKc(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.wy(a)})};
p.zA=function(){bKc(this,v(function(a){a=cvc(this.Cb,a);yh(this.Qa(),a)},this),!1)};p.KA=Je;p.rz=n("autovisFeedback");p.XB=n(2208);p.WB=n(2207);p.E6=n("Was this chart useful?");p.xa=function(){gX.ea.xa.call(this);eX(this).appendChild(N(wJc));fX(this).appendChild(N(xJc));if(ow(this.C,22)){this.D=new GJc(this.C,this.O,this.Hb,this.L,this.Ta,this.oa());this.Fa(this.D,!0);var a=this.D,b=this.Ld();a.V=b;LJc(a)}};
p.Ga=function(){gX.ea.Ga.call(this);Bh(this.Qa(),hX.VYa);var a=this.Ia(hX.W0a);this.V.hb(a);aX(a,"Insert chart");a=this.Ia(hX.J5a);this.$.hb(a);aX(a,"View full size");a=this.Ia(hX.JYa);var b=this.Ia(hX.mYa);this.getHandler().R(this.Qa(),"keydown",this.B2b).R(a,"focus",this.hob).R(b,"focus",this.Vmb).R(this.V,"action",this.iwb).R(this.V.Qa(),"mousedown",this.kta).R(this.$,"action",this.EIb).R(this.$.Qa(),"mousedown",this.kta).R(this.Ia(hX.J2),"mousedown",this.kta).R(DH(this.Cb),"rb",this.C2b);cKc(this);
this.L.Vb(2790,this.F);this.D&&this.L.Vb(2791,this.F)};p.nt=function(a){gX.ea.nt.call(this,a);cKc(this);this.Qb()&&dKc(this)};function cKc(a){if(a.Qb()){var b=a.Ld();a.V.setVisible(!b);a=a.oa().Ia(hX.G3a,fX(a));L(a,!b)}}p.B2b=function(a){13==a.keyCode&&a.target==this.Qa()&&(a.preventDefault(),a.stopPropagation(),eKc(this,2255))};
function fKc(a){var b=a.getChartType(),c=!!V(a.C,14),d=V(a.C,16),e=!!V(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=qT(tw(a.H,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var r=h[m].rect;r=c!=b?D_a(r,new Id(r.width,1)):D_a(r,new Id(1,r.height));mb(l,r)}c=pG(a.xb).D;var u=[];for(w in ky)u.push(PMb(c,ky[w]));var w=Wa(l,function(a){return Wa(u,Da(BA,a))});f&&e&&(w=nb(w,1));a.Oa=gKc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=pG(a.xb);for(e=0;e<w.length;e++)for(f=a.Oa[e],b=0;b<w[e].length;b++)w[e][b]&&NA(w[e][b])&&
(k=ftc(d,w[e][b],hX.s4a),a.qa(k),iO(d.V,"default",k,!0),Sh(k.Qa(),"background-color",f),k.setVisible(!0),a.jb.push(k),k=kO(d,w[e][b],hX.r4a,1,0),a.qa(k),FNb(k,f),k.setVisible(!0),a.Wa.push(k))}function hKc(a){Bb(a.jb);Bb(a.Wa);a.jb=[];a.Wa=[];a.Oa=[]}p.C2b=function(){this.Ba&&(hKc(this),fKc(this))};p.pL=function(){gX.ea.pL.call(this);this.va=Fa();this.Ba||(fKc(this),this.Ba=!0)};
p.sG=function(){gX.ea.sG.call(this);pa(this.va)&&500<Fa()-this.va&&this.L.Vb(2789,this.F);this.va=null;hKc(this);this.Ba=!1};p.hob=function(){var a=this.Ia(hX.J2);oi(a)?a.focus():this.Qa().nextSibling&&this.Qa().nextSibling.focus()};p.Vmb=function(){var a;if(a=this.Ka)a=this.Ka,a.yb("waffle-assistant-feedback-card-hidden")?a=!1:(a.Ia("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.$.Qa().focus()};p.iwb=function(){eKc(this,2255)};p.kta=function(a){a.stopPropagation()};
p.EIb=function(){E3a.Wb(this,this.F)};p.hKa=function(a,b){eKc(this,2257,a,b)};function eKc(a,b,c,d){if(J(I(),"fecpmr")){var e=iKc(a);a.dispatchEvent(new WJc(e,V(a.C,28),a.O,b,c,d,yj(a.F)))}else bKc(a,v(function(a){a=new zJc(a,this.O,this.J&&this.J.Zd(),b,c,d,yj(this.F));this.dispatchEvent(a)},a),!1)}function jKc(a,b){nzc(b,a.Ia(hX.Tda),a.Hb,a.L,function(b){kKc(a,b)})}
function kKc(a,b){null!==a.ma&&(sn(qn(),a.ma),a.ma=null);a.isDisposed()||(a.getHandler().R(b,"waffle-tvizchart-tooltip-shown",function(){a.Ma=Fa()}).R(b,"waffle-tvizchart-tooltip-hidden",function(){pa(a.Ma)&&500<Fa()-a.Ma&&a.L.Vb(2750,a.F);a.Ma=null}),a.ub(),dKc(a))}function dKc(a){if(!a.Ld()){var b=a.Ia(hX.Tda);if(!a.Ta.contains(b)){var c=a.Ta;a=new MJc(b,a);wzb(c,a)}}}
function lKc(a,b,c){var d=[];try{var e=a.Pc.serialize(c);d=Wa(Kzc(Da(ritz_api.RitzModelApi.getVerbalHighlightsForProto,e),b).call(),Hzc)}catch(f){d=[]}a=a.Ia(hX.J2);L(a,0<d.length);0<d.length&&(a.appendChild(d[0]),te(a,!0))}function iKc(a){mKc(a);var b=new ritz.charts.model.ChartImpl,c=V(a.C,28);b.setChartModel(a.Pc.serialize(c.Xw()));b.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(a.Pc.serialize(c)));return b}
function nKc(a){mKc(a);V(a.C,16);var b=OJc(a.C);b.Gaa(yJ);var c=Vzc(a.H);b.qj(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}function mKc(a){a.Lc&&(a.ma=rn(qn(),$A.Wta),a.Lc=!1)}
function aKc(a){var b=nKc(a);b=PJc(b,a.Ia("waffle-assistant-card-inner"));if(J(I(),"fecpmr")){var c=iKc(a);$Jc(c);lKc(a,c,V(a.C,28));jKc(a,c)}else(new iT(yJ,b.eh)).send(function(c){var d=b;if(c)if(c.Ti())kJ.zE(a.Ia(hX.Tda),c);else{d.Af(c.Zd());sU(d,d.Zd());c=new bA;c.setContext(d.toJSON());var f=!!V(a.C,14);W(c,3,f);var h=V(a.C,16);W(c,4,h);W(c,5,f);W(c,8,0);V(a.C,24)&&(f=V(a.C,25),W(c,9,f));f=qT(tw(a.H,4));for(h=0;h<f.length;h++)c.addRange(UA(f[h].rect,f[h].jd));f=(f=d.Zd())?f.toJSON():null;h=new ritz.charts.model.GvizChart;
h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);lKc(a,h,c);a.J=d;c=(c=d.Zd())?c.toJSON():null;f=new ritz.charts.model.GvizChart;f.updateChartWrapperJsonString(d.toJSON());c&&f.updateDataTableJsonString(c);jKc(a,f)}});a.D&&bKc(a,v(function(a){var c=this.D,d=b;a=new tJ(a.toJSON());d=new tJ(d.toJSON());var h=c.Oi("waffle-assistant-faceted-chart");if(1<h.length){KJc(a);var k=d;JJc(k);k.setOption("pieSliceText","percentage");k.setOption("axisFontSize",0);k.setOption("hAxis.title",
null);k.setOption("hAxis.textPosition","none");k.setOption("vAxes.0.title",null);k.setOption("vAxes.0.textPosition","none");k.setOption("vAxes.1.title",null);k.setOption("vAxes.1.textPosition","none");k.setOption("legend","none");k.setOption("titleTextStyle.fontSize",0)}else k=a,KJc(k),k.setOption("applyAggregateData",void 0),k.setOption("legend","right"),JJc(d);k=qT(tw(c.J,27));fpb(c.F,k);k=V(c.J,25);for(var l=0;l<h.length;l++){var m=ma(c.L[l])?c.L[l]:null,r=k.clone(),u=c.Ha,w=new gA;W(w,1,u);ma(m)&&
w.Pa(m);W(r,7,w);c.F.Ac("dt",encodeURIComponent(JSON.stringify(c.Pc.serialize(r))));u=new tJ(a.toJSON());u.qj(c.F.toString());r=d.clone();r.qj(c.F.toString());var y=c,B=u.Oc("title");B||(B=ruc(u));w=B+(' when "'+(y.C+('" is "'+(m+'"'))));y=B+(' by "'+(y.C+'"'));w=m?w:y;u.setOption("title",w);r.setOption("title",w);y=new AJc(u,r,c.C,m,c.Ka,c.Ma,c.Ba,c.oa());c.Fa(y);w=h[l];y.hb(w);c.ma.push(y);y=c;B=ruc(u);u=B+(' broken down by "'+(y.C+('" for "'+(m+'"'))));y=B+(' broken down by "'+(y.C+'"'));yh(w,
m?u:y);c.H=r}LJc(c);c.Qa().style.visibility="visible"},a),!1)}function bKc(a,b,c){var d=nKc(a);(new iT(yJ,d.eh)).send(function(a){a?(a=a.Zd(),c&&d.Af(a),sU(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function gKc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=cxc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&mb(d,d);return d};function MJc(a){jL.apply(this,arguments)}q(MJc,jL);MJc.prototype.fka=g("element");function oKc(){hL.call(this);Pyb(this,this);this.Ra="waffle-assistant-dragged-card"}x(oKc,vzb);oKc.prototype.contains=function(a){return!!z(this.L,function(b){if(b.element==a)return!0})};oKc.prototype.cka=function(a){var b=oKc.ea.cka.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function pKc(){return P('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function qKc(a,b){dX.call(this,a,b);this.C=V(a,8)}x(qKc,dX);p=qKc.prototype;p.zA=sa;p.rz=n("assistantWordCloudFeedback");p.XB=n(2634);p.WB=n(2633);p.xa=function(){qKc.ea.xa.call(this);eX(this).appendChild(N(pKc));Bh(eX(this),"waffle-assistant-word-cloud-content-container")};
p.wy=function(a){for(var b=tw(this.C,19),c=tw(this.C,20),d=this.Ia("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(rKc(this,b,c,e),120<d.clientHeight){rKc(this,b,c,e-1);break}b=this.oa();c=V(this.C,2);c=De(b,c);d=this.Ia("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function rKc(a,b,c,d){var e=a.Ia("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(De(a," "));var l=a.createElement("SPAN");a.appendChild(l,De(a,b[k]));a.appendChild(e,l);Bh(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function sKc(a,b,c){b=c||b;c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="';var d=" "+(R(a.title)+" Section ");c+=vr(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+O(a.title)+"</div>";c+=O(Br({Kd:"waffle-assistant-section-more-button",content:sr("More"),style:4},b));return P(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')};function tKc(){var a=P;var b='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+O(N1b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">';b=P(b+'Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function uKc(a,b,c){b=c||b;return P('<div class="waffle-assistant-panel-title-bar">'+O(Br({Kd:"waffle-assistant-panel-back-button",content:sr(""+O(Ds({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white",Dt:"waffle-assistant-panel-back-button-icon"},b))),style:4},b))+'<div class="waffle-assistant-title-text" role="heading">'+O(a.title)+"</div></div>")};function iX(a){M.call(this,a);this.zc=new YU(!1,"#4285f4");this.Fa(this.zc);this.H=new M(this.oa());this.Fa(this.H);this.C=[];this.re=this.Zb=!1;this.hd=this.Wc=this.Ta=this.va=null;this.Hb=new Cr("",a,4);fj(this.Hb,2,!1);this.Fa(this.Hb)}x(iX,M);var vKc={defaultHelpArticleId:"6280499"};p=iX.prototype;p.xa=function(){iX.ea.xa.call(this);this.Ua=N(tKc);this.Wc=this.Ia("waffle-assistant-panel-content-container");this.hd=this.Ia("waffle-assistant-empty-list")};
p.Ga=function(){iX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-spinner-container");this.zc.render(a);this.H.hb(this.Ia("waffle-assistant-panel-card-holder"));this.Hb.hb(this.Ia("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Hb,"action",this.W2b).R(this.Qa(),"scroll",Otc(this.gca,10,this))};p.setVisible=function(a){var b=this;L(this.Qa(),a);z(this.C,function(a){if(!a.Qb()){var c=b.H.ad();a.O=c;b.H.Fa(a,!0);a.zJ()}});(this.Zb=a)&&0<this.C.length&&this.C[0].Qa().focus()};
p.hqa=function(a,b){var c=this.oa();this.va&&this.z4();this.va=new M;this.Fa(this.va);a=gr(a,uKc,{title:b});this.Ta=new Cr("",this.oa());this.va.Fa(this.Ta);this.Ta.hb(c.Ia("waffle-assistant-panel-back-button",a));aX(this.Ta.Qa(),"Back");this.va.getHandler().R(this.Ta,"action",this.V2b)};p.z4=function(){this.va.dispose();this.va=null};function wKc(a,b){ZU(a.zc,b);L(a.Ia("waffle-assistant-panel-pane"),!b)}p.NH=function(a){L(this.hd,a);L(this.Wc,!a)};
function xKc(a,b){ib(a.C,b);a.H.removeChild(b);a.H.kh(b,0);a.C.push(b)}p.sH=function(a){ib(this.C,a);-1!=Bi(this.H,a)&&this.H.removeChild(a,!0)};p.rW=function(){this.H.Fd(!0);Bb(this.C);this.C=[]};p.gca=function(){var a=this.Qa();a=a.scrollTop+li(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(UJc(d,!0),b+=li(d.Qa()).height):UJc(d,!1)}};function yKc(a,b){a.re=b;z(a.C,function(a){a.nt(b)})}p.Ld=g("re");p.W2b=function(){K.Vn.Wb(vKc)};p.V2b=function(){this.dispatchEvent("Ud")};function jX(a,b,c,d){M.call(this,d);this.$=a;this.Ta=b;this.va=new Cr("",this.oa());this.Fa(this.va);this.L=new M(this.oa());this.Fa(this.L);this.C=null;this.Ra=[];this.ma=this.Oa=!1;this.V=c}x(jX,M);p=jX.prototype;p.CMa=Ie;p.kra=Je;p.xa=function(){jX.ea.xa.call(this);this.Ua=N(sKc,{title:this.getTitle()})};
p.Ga=function(){jX.ea.Ga.call(this);this.L.hb(this.Ia("waffle-assistant-section-card-holder"));this.va.hb(this.Ia("waffle-assistant-section-more-button"));this.getHandler().R(this.va,"action",this.uyb);this.C=this.YBa();this.qa(this.C);L(zKc(this),this.CMa());this.setVisible(!1)};p.setVisible=function(a){if(this.Qb()&&this.isVisible()!=a&&(L(this.Qa(),a),a)){L(this.va.Qa(),this.SUa());a=new yg;G(a,4,this.b2());var b=new wg;Tf(b,58,a);a=Bj(Aj(new zj,10),b).build();this.V.Vb(2774,a)}};
p.isVisible=function(){return this.Qb()&&oi(this.Qa())};p.SUa=function(){return this.Ra.length>this.$};p.YBa=function(){return new iX(this.oa())};p.JN=function(a){this.ma=a;z(AKc(this),function(b){b.nt(a)});yKc(this.C,a)};p.Ld=g("ma");p.Mf=sa;
p.FN=function(a){this.Ra=a;for(var b=0;b<a.length;b++){if(this.L.ad()<this.$){var c=this.lP(a[b]);c.nt(this.ma);var d=this.L.ad();c.O=d;this.L.Fa(c,!0)}if(this.kra()&&(this.C.NH(!1),c=this.lP(a[b]),c.nt(this.ma),d=this.C,d.C.push(c),d.Zb)){wKc(d,!1);var e=d.H.ad();c.O=e;d.H.Fa(c,!0);c.zJ()}}};function AKc(a){var b=[];a.L.xf(function(a){b.push(a)});return b}function zKc(a){return a.Ia("waffle-assistant-section-content")}p.tma=function(){return this.L.y8()};
p.qU=function(){this.Ra=[];Bb(this.L.Fd(!0));this.setVisible(!1);this.kra()&&(this.C.rW(),this.C.NH(!0))};function BKc(a){a.L.xf(function(a,c){c<this.$&&a.zJ()},a)}p.d2=function(a){var b=0;if(this.Oa)this.C.gca();else if(this.tma()){this.setVisible(!0);b=li(this.Ia("waffle-assistant-section-header")).height+li(zKc(this)).height;for(var c=AKc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.DJa(c[d]),UJc(c[d],!0),b+=li(c[d].Qa()).height):UJc(c[d],!1)}else this.setVisible(!1);return a-b};p.DJa=sa;
p.rU=function(a){(this.Oa=a)||this.C.z4()};p.Rb=g("Oa");p.MXa=function(a){this.C&&wKc(this.C,a)};function CKc(a,b){a.C.hqa(b,a.getTitle())}p.uyb=function(){this.rU(!0);this.dispatchEvent("$d")};function kX(a,b,c,d,e,f){var h=nh(I(),"fmnac");h||(h=20);jX.call(this,h,e,d,f);this.Ba=a;this.J=b;this.Ha=c;this.D=new oKc;this.qa(this.D);this.F=null;this.H=0;this.O=null}x(kX,jX);p=kX.prototype;p.Ga=function(){kX.ea.Ga.call(this);this.D.Me();this.getHandler().R(this.D,"drag",this.A2b).R(this.D,"dragend",this.z2b)};p.getTitle=n("Analysis");p.hW=function(a){return 0==a};
p.lP=function(a){return"WordCloud"==V(a,8).getChartType()?new qKc(a,this.oa()):new gX(a,this.Ba,this.J,this.Ha,this.V,this.D,this.O,this.oa())};p.JN=function(a){kX.ea.JN.call(this,a);a&&Ryb(this.D)};p.DJa=function(a){this.getHandler().Sc(a,"content-rendered",this.y2b);this.H++};p.FN=function(a,b){this.O=b||null;kX.ea.FN.call(this,a,b)};p.y2b=function(){0==--this.H&&this.dispatchEvent("Wd")};p.A2b=function(){this.F=fi(this.D.Nc.target)};
p.z2b=function(a){var b=this.F,c=pG(this.J).C;if(Nh(wN(c,"page",!1,!1)).contains(b)){var d=gO(c,b.x,b.y,"page");c=VM(c,d,"page");b=new Dd(b.x-c.left,b.y-c.top);a.C.getData().hKa(d,b)}this.F=null};p.b2=n(2);var DKc={a5a:0,iea:1,uca:2,Eda:3,u5a:4,m4a:5,Fwa:6,DU:7,c4a:8,d4a:9},EKc={UNKNOWN_ERROR:0,MDc:1,iuc:2,Ufc:3},FKc={uDc:0,ogc:1,Aca:2,gk:3,kDc:4,Z5b:5,Chc:6},GKc={rDc:0,aB:1,ouc:2,Xtc:3,Zwc:4},HKc={lDc:0,kuc:1,uE:2,yrc:3},IKc={bDc:0,ICc:1,pkc:2,GBc:3,FBc:4,B9b:5,gsc:6},JKc={LAc:0,vE:1,rZa:2,ACc:3,Jzc:4,G2a:5,JDc:6,mwa:7,Tta:8,Dua:9,QU:10},KKc={UNKNOWN:0,I5b:1,H5b:2,G5b:3,a7b:4,R8b:5,v9b:6,fcc:7,Qgc:8,Ssc:9,jxc:10,txc:11,YAc:12,ZAc:13,hCc:14,Kwc:15};var LKc={DEFAULT:0,RIGHT:1,LEFT:2,wE:3,fE:4},MKc={l4a:0,$rc:1};function NKc(){T.call(this)}x(NKc,T);var OKc=null;function lX(){T.call(this)}x(lX,T);var PKc=null;lX.prototype.getTitle=function(){return V(this,1)};function mX(){T.call(this)}x(mX,T);var QKc=null;mX.prototype.getPosition=function(){return V(this,1)};mX.prototype.setPosition=function(a){W(this,1,a)};function nX(){T.call(this)}x(nX,T);var RKc=null;function oX(){T.call(this)}x(oX,T);var SKc=null;
oX.prototype.getTitle=function(){return V(this,3)};NKc.prototype.Ca=function(){var a=OKc;a||(OKc=a=vw(NKc,{0:{name:"ChartScale",qb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",Aa:14,defaultValue:0,type:MKc},2:{name:"factor",Aa:1,type:Number}}));return a};NKc.Ca=NKc.prototype.Ca;lX.prototype.Ca=function(){var a=PKc;a||(PKc=a=vw(lX,{0:{name:"ChartTitle",qb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",Aa:9,type:String}}));return a};lX.Ca=lX.prototype.Ca;
mX.prototype.Ca=function(){var a=QKc;a||(QKc=a=vw(mX,{0:{name:"ChartLegend",qb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",Aa:14,defaultValue:0,type:LKc}}));return a};mX.Ca=mX.prototype.Ca;nX.prototype.Ca=function(){var a=RKc;a||(RKc=a=vw(nX,{0:{name:"ChartAxis",qb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",Aa:11,type:NKc}}));return a};nX.Ca=nX.prototype.Ca;
oX.prototype.Ca=function(){var a=SKc;a||(SKc=a=vw(oX,{0:{name:"ChartOptions",qb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",Aa:11,type:nX},2:{name:"v_axis",Aa:11,type:nX},3:{name:"title",Aa:11,type:lX},4:{name:"subtitle",Aa:11,type:lX},5:{name:"legend",Aa:11,type:mX},6:{name:"chart_conversation",Aa:8,type:Boolean}}));return a};oX.Ca=oX.prototype.Ca;function pX(){T.call(this)}x(pX,T);var TKc=null;pX.prototype.Dh=function(){return V(this,1)};function qX(){T.call(this)}x(qX,T);var UKc=null;qX.prototype.getText=function(){return V(this,1)};qX.prototype.$q=function(){return ow(this,1)};function rX(){T.call(this)}x(rX,T);var VKc=null;rX.prototype.getStatus=function(){return V(this,1)};rX.prototype.Fj=function(){return V(this,2)};rX.prototype.getError=function(){return V(this,9)};function sX(){T.call(this)}x(sX,T);var WKc=null;
function XKc(){T.call(this)}x(XKc,T);var YKc=null;function tX(){T.call(this)}x(tX,T);var ZKc=null;tX.prototype.wx=function(){return ow(this,1)};tX.prototype.Fj=function(){return V(this,2)};tX.prototype.getType=function(){return V(this,3)};tX.prototype.setType=function(a){W(this,3,a)};function $Kc(){T.call(this)}x($Kc,T);var aLc=null;function bLc(){T.call(this)}x(bLc,T);var cLc=null;
pX.prototype.Ca=function(){var a=TKc;a||(TKc=a=vw(pX,{0:{name:"Error",qb:"ritz.assistant.Error"},1:{name:"message",Aa:9,type:String},2:{name:"code",Aa:14,defaultValue:0,type:EKc},3:{name:"unsupported_op_reason",Aa:14,defaultValue:0,type:FKc}}));return a};pX.Ca=pX.prototype.Ca;
qX.prototype.Ca=function(){var a=UKc;a||(UKc=a=vw(qX,{0:{name:"AnswerQueryPhrase",qb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Aa:9,type:String},2:{name:"start_byte",Aa:5,type:Number},3:{name:"num_bytes",Aa:5,type:Number}}));return a};qX.Ca=qX.prototype.Ca;
rX.prototype.Ca=function(){var a=VKc;a||(VKc=a=vw(rX,{0:{name:"AnswerResponse",qb:"ritz.assistant.AnswerResponse"},1:{name:"status",Aa:5,type:Number},10:{name:"parse_status",Aa:14,defaultValue:0,type:GKc},11:{name:"answer_status",Aa:14,defaultValue:0,type:HKc},2:{name:"formula",Aa:9,type:String},3:{name:"debug_parse_response",Aa:9,type:String},4:{name:"interpretation",Aa:9,type:String},5:{name:"debug_interpretation_response",Aa:9,type:String},6:{name:"unused_phrase",yc:!0,Aa:11,type:qX},7:{name:"used_entity_phrase",
yc:!0,Aa:11,type:qX},8:{name:"unused_entity_phrase",yc:!0,Aa:11,type:qX},9:{name:"error",Aa:11,type:pX},12:{name:"alternate_suggestion",yc:!0,Aa:11,type:tX},14:{name:"deprecated_formula_builder_used",Aa:9,type:String},15:{name:"answer_visualization_type",yc:!0,Aa:14,defaultValue:0,type:JKc},16:{name:"formula_builder_used",Aa:14,defaultValue:0,type:KKc},17:{name:"charting_info",Aa:11,type:XKc},18:{name:"answer_field_info",yc:!0,Aa:11,type:sX},19:{name:"charting_formula",Aa:9,type:String},21:{name:"parse_info",
yc:!0,Aa:11,type:$Kc},22:{name:"answer_field_info_for_ranges",yc:!0,Aa:11,type:sX},23:{name:"va_query",Aa:9,type:String},24:{name:"pivot_table_def",Aa:11,type:Xy}}));return a};rX.Ca=rX.prototype.Ca;sX.prototype.Ca=function(){var a=WKc;a||(WKc=a=vw(sX,{0:{name:"AnswerFieldInfo",qb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Aa:14,defaultValue:0,type:sUa},2:{name:"range_ref",Aa:9,type:String}}));return a};sX.Ca=sX.prototype.Ca;
XKc.prototype.Ca=function(){var a=YKc;a||(YKc=a=vw(XKc,{0:{name:"ChartingInfo",qb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",yc:!0,Aa:14,defaultValue:0,type:JKc},2:{name:"recommended",Aa:8,type:Boolean},3:{name:"user_requested_type",yc:!0,Aa:14,defaultValue:0,type:JKc},4:{name:"show_only_chart",Aa:8,type:Boolean},5:{name:"chart_options",Aa:11,type:oX}}));return a};XKc.Ca=XKc.prototype.Ca;
tX.prototype.Ca=function(){var a=ZKc;a||(ZKc=a=vw(tX,{0:{name:"QuerySuggestion",qb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Aa:9,type:String},2:{name:"formula",Aa:9,type:String},3:{name:"type",Aa:14,defaultValue:0,type:IKc},4:{name:"deprecated_formula_builder_used",Aa:9,type:String},5:{name:"formula_builder_used",Aa:14,defaultValue:0,type:KKc}}));return a};tX.Ca=tX.prototype.Ca;
$Kc.prototype.Ca=function(){var a=aLc;a||(aLc=a=vw($Kc,{0:{name:"ParseInfo",qb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",yc:!0,Aa:11,type:bLc}}));return a};$Kc.Ca=$Kc.prototype.Ca;bLc.prototype.Ca=function(){var a=cLc;a||(cLc=a=vw(bLc,{0:{name:"IntentInfo",qb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Aa:14,defaultValue:0,type:DKc}}));return a};bLc.Ca=bLc.prototype.Ca;function dLc(){this.D=this.O="";this.J=!1;this.F=0;this.L=!1;this.H=0;this.C=""}dLc.prototype.getTitle=g("O");var eLc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),fLc=[{Uj:["Thank you","Thankyou","Thanks"],pq:"No problem"},{Uj:["you are amazing","This is great","omg"],pq:"Happy to help"},{Uj:["I love you"],pq:"Must be in the air"},{Uj:["How do you know","How are you so smart"],pq:"It's all in the data"},{Uj:["Are you sure"],pq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Uj:["How are you"],pq:"Pretty good, thanks"},
{Uj:["Hi","Hello","Hey"],pq:"Hi, there. Try asking a question about your data."},{Uj:["You are stupid","This is dumb","You are wrong"],pq:"Help improve this experience by sending feedback"},{Uj:["How smart are you"],pq:"Pretty smart"}];function gLc(a){for(var b=0;b<fLc.length;++b)if(-1!=ab(fLc[b].Uj,function(b){return Fb(a,b)}))return b;return-1};function hLc(a,b,c,d){var e=new TIc;G(e,2,c);z(b,function(a){Pf(e,1).push(a)});G(e,3,d);d=new TW;G(d,1,a);G(d,3,b[c]);Tf(d,11,e);return d}function iLc(a,b,c,d){var e=new PIc;G(e,2,c);z(b,function(a){Pf(e,1).push(a)});G(e,3,d);d=new TW;G(d,1,a);G(d,2,b[c]);Tf(d,10,e);return d}function jLc(a){var b=new NIc;z(a,function(a){var c=a.type;Pf(b,1).push(c);a.YFa&&(a=a.YFa,Pf(b,2).push(a))});return b}function kLc(a){var b=new RIc;z(a,function(a){a=a.type;Pf(b,1).push(a)});return b}
function lLc(a,b,c,d){var e=new VIc;a&&G(e,1,a);b&&G(e,2,b);for(a=0;a<c.length;a++)b=c[a],Pf(e,3).push(b);G(e,4,d);return e};function uX(a,b){this.D=a;this.C=b}uX.prototype.getChartType=g("D");var vX={2:new uX("ColumnChart","Column chart"),3:new uX("LineChart","Time series"),4:new uX("ScatterChart","Scatter chart"),5:new uX("PieChart","Pie chart"),10:new uX("Histogram","Histogram"),7:new uX("LineChart","Line chart")};function wX(a,b,c,d,e,f,h){this.D=a;this.NV=b;this.H=(void 0===h?null:h)||b;this.C=d;this.xo=c;this.Ka=d?tw(d,6):[];this.Ma=d?tw(d,7):[];this.Ha=d?tw(d,8):[];this.error=e||1;this.interpretation=d&&ow(d,4)?V(d,4):null;this.ma=new dLc;this.O=d?tw(d,12):[];this.Ba=d?tw(d,21):[];this.va=f;this.F=null;this.$=this.J=!1;this.L=[];this.V=null;mLc(this)}function nLc(a){return 1==a.error&&null!=a.xo}
function oLc(a){return{wM:pLc(a),interpretation:a.interpretation,NV:a.NV,xo:a.xo,ZL:1<a.NV.length&&1<a.NV[0].length,Sj:a.Sj(),MWb:a.$,Pz:a.Pz(),FJb:a.L}}wX.prototype.Sj=function(){return null!=this.F&&(this.F in vX?!0:!1)&&2<this.H.length};wX.prototype.Pz=function(){return J(I(),"feapt")&&null!==this.C&&ow(this.C,24)};wX.prototype.getChartType=function(){if(!this.Sj())return null;var a=this.F;if(a in vX)return vX[a].getChartType();throw Error("Unknown chart type.");};
function qLc(a){a.Sj();return a.H[0][0]}function rLc(a){a.Sj();return a.H[0][1]||""}function sLc(a){return Wa(tw(a.C,22),function(b){if(V(b,2)){var c=a.va.C;return sF(V(b,2),c)}},a)}function tLc(a){return{wM:pLc(a),error:uLc(a)}}function vLc(a,b,c){var d=c.length;if(0==d)return a;1<d&&ib(a,10);c=V(c[0],1);2<d&&9==c&&ib(a,4);2<d&&ib(a,5);2!=c&&3!=c&&12!=c&&ib(a,3);bb(b,10)&&bb(a,10)&&Baa(a,function(a){return 10!=a});return a}
function mLc(a){var b=null;a.J=!1;a.F=null;if(a.C&&ow(a.C,17)){var c=V(a.C,17);a.$=V(c,4)||!1;var d=tw(c,3),e=vLc(tw(c,1),d,tw(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=Ua(e,function(a){return bb(d,a)}),c=Ua(d,function(a){return!bb(e,a)}),ib(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):bb(d,10)&&bb(e,2)?(a.J=!0,a.F=2,ib(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=wLc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=wLc(a,e),a.J=V(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=lLc(a.F,b,e,a.J))}}function wLc(a,b){if(!tw(a.C,18).length)return b[0];a=xLc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(bb(b,a[c]))return a[c];return b[0]}function yLc(a,b,c){var d={};null!=b?(d.v=zLc(a,b,c),d.f=b):d.v=null;return d}
function xLc(a){for(var b=new cJ,c=a.H[0],d=nb(a.H,1),e=tw(a.C,18),f=[],h=0;h<c.length;h++)null!=e[h]&&ow(e[h],1)?f.push(ALc(V(e[h],1))):f.push(0==h?"string":"number"),b.zs({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(yLc(a,d[e][k],f[k]));b.Xu(h)}return b}
function zLc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=a.va.O.F,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),dc(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Kb(a[0])&&Kb(a[1])&&(Kb(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Kb(a[d])&&(c[d]=dc(a[d]));
"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function ALc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function BLc(a){if(!ow(a.C,9))return"";if(ow(a.C.getError(),3))switch(V(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Dh()||""}
function uLc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return BLc(a)||"Sorry, couldn't understand your question.";case 7:return a=gLc(a.D),-1!=a?fLc[a].pq:""}return""}
function pLc(a){var b=[];if(nLc(a)){var c=[];z(kb(a.Ka,a.Ha),function(a){c.push(CLc(a,"waffle-assistant-answercard-question-unused-phrase"))});z(a.Ma,function(a){c.push(CLc(a,"waffle-assistant-answercard-question-used-entity"))});tb(c,function(a,b){return a.WT>b.WT?1:-1});var d=0;z(c,function(c){var e=c.length,h=c.WT;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Ek}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function CLc(a,b){return{WT:V(a,2),length:V(a,3),Ek:b}};function DLc(a,b,c){return P('<div class="waffle-assistant-answers-card-remove">'+O(Ds({icon:"docs-icon-img docs-icon-trash"},c||b))+"</div>")}
function ELc(a,b){var c=a.error;a=a.showHelp;b='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+O(Ds({icon:"docs-icon-img docs-icon-unsupported-black"},b))+'</div><div class="waffle-assistant-errorcard-content">';a?(b+='<div class="waffle-assistant-errorcard-text">',c=O(c)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',b=b+c+"</div>"):b+='<div class="waffle-assistant-errorcard-text">'+O(c)+
"</div>";return P(b+"</div></div>")};function FLc(a,b,c){b=c||b;c=P;var d='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+GLc({wM:a.iB.wM}),e=a.iB.NV;var f=a.iB.xo;var h=a.iB.interpretation,k=a.iB.ZL,l=a.iB.Sj,m=a.iB.Pz,r=a.iB.MWb;a=a.iB.FJb;null==e||va(e);va(a);h=h={interpretation:h};h=h.interpretation;var u='<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+vr("Answer");u=u+'"><span aria-hidden="true">Answer'+("</span></div>"+(h?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
O(h)+"</div></div>":""));var w='<div class="waffle-assistant-answercard-answer-container">'+P(u)+'<div class="waffle-assistant-answercard-answer-content">';if(e){if(!r)if(l&&(w+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab" id="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
m)w+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{w+='<div class="waffle-assistant-answercard-answer">';if(k){w+='<div class="waffle-assistant-answercard-answer-rowheader">';r=e[0];h=r.length;for(u=0;u<h;u++)w+='<span class="waffle-assistant-answercard-answer-col">'+O(r[u])+"</span>";w+="</div>"}w+='<div class="waffle-assistant-answercard-answer-rows">';r=rr("waffle-assistant-answercard-answer-row"+(k?" waffle-assistant-answercard-answer-list-row":""));h=e.length;for(u=0;u<
h;u++){var y=e[u];if(k&&0==u)y="";else{var B=r;va(y);B='<div class="'+R(B)+'">';for(var H=y.length,Q=0;Q<H;Q++){var Y=y[Q];Y?B+='<span class="waffle-assistant-answercard-answer-col">'+O(Y)+"</span>":(B+='<span class="'+R("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">',B+="N/A",B+="</span>")}y=P(B+"</div>")}w+=y}w+="</div></div>"}w+=l?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<a.length){w+='<div class="waffle-assistant-answercard-info-msgs">';e=a.length;for(k=0;k<e;k++)w+='<div class="waffle-assistant-answercard-info-msg">* '+O(a[k])+"</div>";w+="</div>"}w+='<div class="waffle-assistant-answercard-footer">';m&&(w+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>');l&&(w+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');m||(w=w+'<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert'+
('</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+O(Ds({icon:"docs-icon-img docs-icon-insert-formula"},b))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+O(f)+"</div></div></div></div></div>"));f=P(w+"</div></div></div>");return c(d+f+"</div></div>")}
function GLc(a){va(a.wM);a=a.wM;var b='<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+vr("Question");b+='"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+R(e.className)+'">'+O(e.text)+"</span>":O(e.text)}return P(b+"</div></div></div>")}
function HLc(a,b,c){b=c||b;a=a.Pz;return P(O(DLc(null,b))+(a?'<div class="waffle-assistant-button-separator"></div>'+O(Br({Kd:"waffle-assistant-zoom-button",content:sr(""+O(Ds({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)):""))};function ILc(a){this.C=a}function JLc(a,b){var c=new SW;G(c,3,b);G(c,8,!0);b=new eT;Tf(b,4,c);c=new wg;Tf(c,46,b);c=Bj(Aj(new zj,10),c).build();a.C.Vb(2753,c)};function KLc(a,b,c,d){E.call(this);this.$=a;this.V=b;this.ma=c;this.Ka=d;this.Ja=new Ih(this);this.qa(this.Ja);this.C=new eV;this.qa(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;mAc(this.C,this.$);this.C.va=10;this.C.Ra=!0;this.C.V=!1;this.C.eUa("waffle-assistant-visible");this.C.L=Lb("waffle-assistant-dragged-formula").split(" ");this.C.Me();this.Ja.R(this.C,fAc,this.Ba).R(this.C,iAc,this.Ha).R(this.C,jAc,this.va)}x(KLc,E);
KLc.prototype.Ba=function(a){a=Sa(this.$.childNodes,a.C);this.O=this.L[a]};
KLc.prototype.Ha=function(a){var b=a.event instanceof yq?a.event.Zi:a.event;this.H?(a.H.lx(b,!0),a.preventDefault()):(Yh(a.F,a.event.clientX,a.event.clientY),a=Zh(a.F),b=pG(this.V).C,Nh(wN(b,"page",!1,!1)).contains(a)?(a=gO(b,a.x,a.y,"page"),(b=NH(OJ(this.ma),a.y,a.x))?a=new Dd(b.kc(),b.mc()):b=zA(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=pG(this.V),C(this.D),this.D=ftc(a,b,"waffle-assistant-formula-insertion-rect"),this.qa(this.D),iO(a.V,"default",this.D),C(this.F),this.F=kO(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.qa(this.F),FNb(this.F,"#000"),this.F.setVisible(!0))):LLc(this))};KLc.prototype.va=function(a){if(this.J){MO(pG(this.V),!1);var b=this.J,c=OJ(this.ma);b=new SL(c,b,this.O);this.Ka.C(b);this.dispatchEvent(new D("formula_inserted"))}a.H.lx(null,!0);a.preventDefault();this.O="";LLc(this)};function LLc(a){a.J=null;C(a.D);a.D=null;C(a.F);a.F=null};function xX(a,b,c,d,e,f,h,k,l,m,r,u,w){dX.call(this,new VF,w);this.F=a;this.Oh=sLc(a);this.Cb=a.Sj();this.va=a.Pz();this.Df=r;this.L=this.C=this.ub=null;this.Wa=a.Sj()&&a.J;this.kf=a.$;this.Hb=!1;this.wg=b;this.Se=c;this.Le=d;this.Li=l;this.Ki=h;this.$=e;this.jh=f;this.Kg=k;this.Fe=m;this.re=Aj(new zj,10).build();this.Ed=new lr("",new YW,this.oa());this.Fa(this.Ed);this.Nh=u;this.Ta=new lr("",new YW,this.oa());this.Fa(this.Ta);this.xb=new lr("",new YW,this.oa());this.Fa(this.xb);this.Ba=null;this.V=
new lr("",new $U,this.oa());this.Fa(this.V);this.D=a.ma;this.Oa=new lr("",new $U,this.oa());this.Fa(this.Oa);this.jb=new lr("",new YW,this.oa());this.Fa(this.jb);this.ma=new XT;this.Fa(this.ma);this.Ma=new sO("");this.Fa(this.Ma);this.Pc=new xw;this.J=null;this.Zb=2;this.Dc=xLc(this.F);this.hd=new bV(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.qa(this.hd);this.qd=!1}x(xX,dX);p=xX.prototype;p.$ia=g("Kg");
p.xa=function(){xX.ea.xa.call(this);fX(this).appendChild(N(HLc,{Pz:this.va}))};
p.Ga=function(){xX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-answers-card-remove");this.Ed.hb(a);aX(a,"Remove card",0);this.getHandler().Sc(this.Ed,"action",this.I2b);if(this.F.Pz()){a=OJ(this.Se).$b();var b=this.F;b.Pz();b=b.C?V(b.C,24):null;var c=Xzc(this.Nh,b);this.ub=new $zc(c,b,this.Li.O.C,this.Df,a,this.Le)}else this.getHandler().R(this.V,"action",this.QDb).R(this.Oa,"action",this.mvb).Sc(this.V,"action",this.COa).Sc(this.Oa,"action",this.pLb)};
function MLc(a){function b(b,d,e,f){var c=new VT("");c.hb(a.Ia(b));a.ma.Fa(c);a.getHandler().Sc(c,"action",v(a.mLb,a,d));f||c.setVisible(!1);e&&f&&a.ma.fN(c)}a.ma.hb(a.Ia("waffle-assistant-answercard-tabs"));a.getHandler().R(a.ma,"select",a.pGb);b("waffle-assistant-answercard-formula-tab",0,!a.Wa,!a.va);b("waffle-assistant-answercard-pivot-tab",1,!a.Wa,a.va);b("waffle-assistant-answercard-chart-tab",2,a.Wa,!0)}
function NLc(a){var b=V(a.F.C,17);b=tw(b,1);for(var c=0;c<b.length;c++)a.Ma.yd(OLc(b[c]));a.Ma.hb(a.Ia("waffle-assistant-answercard-chart-type-select"));Ur(a.Ma,OLc(a.F.F));b=a.Ia("waffle-assistant-answercard-insert-chart");a.jb.hb(b);PLc(a);a.getHandler().R(a.jb,"action",a.G2b).R(a.Ma.tc(),"action",a.mpb)}
p.wy=function(a){eX(this).appendChild(N(FLc,{iB:oLc(this.F)}));if(this.F.Pz()){this.Cb&&(MLc(this),NLc(this));var b=this.Ia("waffle-assistant-answercard-insert-pivot");this.Ta.hb(b);b=this.Ia("waffle-assistant-zoom-button");this.xb.hb(b);aX(b,"Preview Pivot Table");this.getHandler().R(this.Ta,"action",this.H2b).R(this.xb,"action",this.LXa);QLc(this);b=this.oa();this.C=b.xa("CANVAS","waffle-pivottable-pivot-canvas");b.wk(this.C,!0);yh(this.C,"Pivot table canvas");b=this.Ia("waffle-assistant-answercard-pivot-content");
this.oa().appendChild(b,this.C);this.getHandler().Cg(this.C,ff,this.LXa);bAc(this.ub,this.C);this.Zb=this.Wa?1:3}else this.V.hb(this.Ia("waffle-assistant-answercard-see-formula-link")),this.Oa.hb(this.Ia("waffle-assistant-answercard-hide-formula-link")),this.Ba=new KLc(this.Ia("waffle-assistant-answercard-formula-text-container"),this.wg,this.Se,this.Le),b=this.Ld(),this.Ba.H=b,this.Ba.L=[this.F.xo],this.qa(this.Ba),b=this.Ia("waffle-assistant-answercard-formula-text"),yh(b,"Formula: "+(this.F.xo+
". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Sc(this.Ba,"formula_inserted",this.oLb).Cg(this.Ia("waffle-assistant-answercard-formula-text"),ff,this.wub),RLc(this,this.Fe),SLc(this),this.Fe&&(TLc(this,!0),this.getHandler().Qc(this.V,"action",this.COa)),this.Cb&&(this.kf?(ULc(this,this.F.getChartType()),this.Hb=!0):MLc(this),NLc(this),this.Zb=1);a()};function VLc(a){return J(I(),"feepts")&&J(I(),"feapp")&&a.va}
function OLc(a){if(a in vX)return new Bk(vX[a].C,a);throw Error("Unknown chart type.");}p.mpb=function(a){a=a.target.Sa();if(a in vX)ULc(this,vX[a].getChartType());else throw Error("Unknown chart type model.");};
function WLc(a,b){a.D.D&&b.setSubtitle(a.D.D);var c=b.getAxis(ritz.charts.model.AxisName.X);c&&(c.setLogScale(a.D.J),a.D.F&&c.setScaleFactor(a.D.F));if(c=b.getAxis(ritz.charts.model.AxisName.Y))c.setLogScale(a.D.L),a.D.H&&c.setScaleFactor(a.D.H);if(a.D.C){c=0;switch(a.D.C.toLowerCase()){case "none":c=0;break;case "left":c=3;break;case "right":c=4;break;case "top":c=1;break;case "bottom":c=2;break;case "in":c=5;break;case "labeled":c=6}b.setLegendPositionType(c)}}
function XLc(a,b){a.D.D&&b.setOption("subtitle",a.D.D);b.setOption("hAxis.logScale",a.D.J);b.setOption("vAxis.logScale",a.D.L);a.D.C&&b.setOption("legend.position",a.D.C);a.D.F&&b.setOption("hAxis.formatOptions.scaleFactor",a.D.F);a.D.H&&b.setOption("vAxis.formatOptions.scaleFactor",a.D.H)}
function ULc(a,b){if(ritz_api.ChartsApi){a.J=new NF;var c=new bA;W(a.J,28,c);var d=new Yz;W(c,10,d);W(a.J,1,b);d.setType(ritz.charts.model.GvizChartUtil.toChartTypeOrdinal(b));var e=a.F.interpretation||"";W(a.J,2,e);var f=new wz;W(d,5,f);var h=new vz;W(f,1,h);UW(h,e);e=new Oz;W(d,7,e);d=new Ez;W(e,1,d);f=new Dz;W(d,1,f);d=new vz;W(f,1,d);f=new Ez;W(e,2,f);e=new Dz;W(f,1,e);f=new vz;W(e,1,f);"Histogram"===b?(yIc(a.J,qLc(a.F)),UW(d,qLc(a.F)),zIc(a.J,"Count"),UW(f,"Count")):"LineChart"===b||"ColumnChart"===
b?(e=0,"number"!=a.Dc.cd(0)&&(yIc(a.J,a.Dc.Of(0)),UW(d,a.Dc.Of(0)),e=1),1==a.Dc.getNumberOfColumns()-e?(zIc(a.J,a.Dc.Of(e)),UW(f,a.Dc.Of(e))):(zIc(a.J,"Values"),UW(f,"Values"))):(yIc(a.J,qLc(a.F)),UW(d,qLc(a.F)),zIc(a.J,rLc(a.F)),UW(f,rLc(a.F)));d=new jA;c.Af(d);Ksc(d,a.Dc.toJSON());W(d,2,"0.6");d=a.Ia("waffle-assistant-answercard-chart");J(I(),"fecpmr")?(f=YLc(a,c),$Jc(f),WLc(a,f),f.setTitle(a.D.getTitle())):(e=OJc(a.J),e.Af(a.Dc),e=PJc(e),sU(e,e.Zd()),XLc(a,e),e.setOption("title",a.D.getTitle()),
h=(f=e.Zd())?f.toJSON():null,f=new ritz.charts.model.GvizChart,f.updateChartWrapperJsonString(e.toJSON()),h&&f.updateDataTableJsonString(h));nzc(f,d,a.Df.C,a.$,void 0,void 0,c);a.Hb=!0}else ritz_api.RitzEntryPoint.loadChartsApi(function(){ULc(a,b)})}function YLc(a,b){var c=new ritz.charts.model.ChartImpl;c.setChartModel(a.Pc.serialize(b.Xw()));a=ritz_api.ChartsApi.createChartDataSource(a.Pc.serialize(b));c.setChartDataSource(a);c.setHasLabels(1<a.getColumnCount());return c}
p.H2b=function(){aAc(this.ub);this.dispatchEvent("close-sidebar");this.$.C(35619,Aj(new zj,67).build())};p.LXa=function(){var a=Aj(new zj,67).build();this.$.C(35620,a);this.getHandler().Qc(this.L,"od",this.KXa).Qc(this.L,"pd",this.JXa);C(this.L);this.L=new dAc(this.ub,this.F.interpretation||"",this.$,a,35621,this.oa());this.getHandler().R(this.L,"od",this.KXa).R(this.L,"pd",this.JXa);this.L.render();this.qa(this.L);IIc(this.L,this.Ld())};p.KXa=function(){this.C.focus()};p.JXa=function(){this.dispatchEvent("close-sidebar")};
p.G2b=function(){if(this.J)if(J(I(),"fecpmr")){var a=V(this.J,28),b=YLc(this,a);WLc(this,b);this.D.getTitle()&&b.setTitle(this.D.getTitle());this.dispatchEvent(new WJc(b,a,this.O,2874,void 0,void 0,ZLc(this)))}else a=OJc(this.J),a.Af(this.Dc),XLc(this,a),this.D.getTitle()&&a.setOption("title",this.D.getTitle()),sU(a,a.Zd()),this.dispatchEvent(new zJc(a,this.O,this.Dc,2874,void 0,void 0,ZLc(this)))};p.zA=function(){yh(this.Qa(),"Answer Card for question: "+this.F.D)};p.KA=Je;p.rz=n("assistantAnswersFeedback");
p.XB=n(2628);p.WB=n(2627);p.E6=n("Was this answer correct?");p.Vja=n("Correct");p.Uja=n("Incorrect");p.EN=g("F");p.nt=function(a){xX.ea.nt.call(this,a);this.Ba&&(this.Ba.H=a);this.L&&IIc(this.L,a);SLc(this);PLc(this);QLc(this)};p.pL=function(){xX.ea.pL.call(this);this.qd||(HIc(this.hd,this.Oh),this.qd=!0)};p.sG=function(){xX.ea.sG.call(this);dV(this.hd);this.qd=!1};
p.pGb=function(){var a=Nvc(this.ma),b=1==a;if(this.va){this.xb.setVisible(b);var c=this.oa().Ia("waffle-assistant-button-separator",fX(this));L(c,b)}b=2==a;L(this.Ia("waffle-assistant-answercard-chart-container"),b);this.va?L(this.Ia("waffle-assistant-answercard-pivot-content"),!b):(L(this.Ia("waffle-assistant-answercard-answer"),!b),L(this.Ia("waffle-assistant-answercard-formula-holder"),!b));PLc(this);!this.Hb&&b&&ULc(this,this.F.getChartType());switch(a){case 1:QLc(this);break;case 2:QLc(this)}};
function SLc(a){var b=a.yb("waffle-assistant-answercard-formula-help");b&&L(b,!a.Ld())}function PLc(a){var b=(a.kf||2==Nvc(a.ma))&&!a.Ld();a.jb.setVisible(b)}function QLc(a){var b=a.va&&!a.Ld()&&(!a.Cb||1==Nvc(a.ma));a.Ta.setVisible(b)}function RLc(a,b){a.V.setVisible(!b);a.Oa.setVisible(b);L(a.Ia("waffle-assistant-answercard-formula"),b);b?a.Ia("waffle-assistant-answercard-formula-text").focus():(a.V.Qa().focus(),a.V.Jp(!0))}p.I2b=function(){JLc(this.jh,!0);this.dispatchEvent(new D("rc"))};
p.QDb=function(){RLc(this,!0)};p.mvb=function(){RLc(this,!1)};p.COa=function(){TLc(this,!0)};p.pLb=function(){TLc(this,!1)};function TLc(a,b){var c=new SW;G(c,9,b);b=new eT;Tf(b,4,c);c=new wg;Tf(c,46,b);c=Bj(Aj(new zj,10),c).build();a.$.Vb(2849,c)}p.mLb=function(a){var b=this.F.V,c=new WIc;Tf(c,1,b);switch(a){case 0:G(c,2,2);break;case 1:G(c,2,3);break;case 2:G(c,2,1);break;default:G(c,2,0)}a=new SW;Tf(a,10,c);c=new eT;Tf(c,4,a);a=new wg;Tf(a,46,c);c=Bj(Aj(new zj,10),a).build();this.$.Vb(2850,c)};
function ZLc(a){var b=a.F.F;a=new XIc;G(a,1,b);b=new SW;Tf(b,11,a);a=new eT;Tf(a,4,b);b=new wg;Tf(b,46,a);return b}p.oLb=function(){this.$.Vb(2709,this.re)};p.wub=function(){var a=this.oa().Pb(),b=a.createElement("textarea");b.textContent=this.F.xo;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&($Lc(this.Ki,"Formula copied to clipboard",this.oa()),this.$.C(35534,this.re))};function aMc(a,b,c){b=c||b;return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+O(GLc({wM:a.eFa.wM}))+O(ELc({error:a.eFa.error,showHelp:a.showHelp},b))+"</div></div>")}function bMc(){return P('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function yX(a,b,c,d,e){dX.call(this,new VF,e);this.F=a;this.V=b;this.L=d;this.$=c;this.J=new lr("",new YW,this.oa());this.Fa(this.J);this.C=new lr("",new $U,this.oa());this.Fa(this.C);this.D=new lr("",new $U,this.oa());this.Fa(this.D)}x(yX,dX);p=yX.prototype;p.zA=function(){yh(this.Qa(),"Error Card for question: "+this.F.D)};p.rz=n("assistantAnswersFeedback");p.KA=Je;p.D8=Ie;p.nt=function(a){yX.ea.nt.call(this,a)};p.xa=function(){yX.ea.xa.call(this);fX(this).appendChild(N(DLc))};
p.Ga=function(){yX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-answers-card-remove");this.J.hb(a);this.D.setVisible(this.L);aX(a,"Remove card",0);this.getHandler().Sc(this.J,"action",this.O2b).Sc(this.C,"action",this.bEb).R(this.D,"action",this.N2b)};
p.wy=function(a){eX(this).appendChild(N(aMc,{eFa:tLc(this.F),showHelp:this.L}));if(iB){var b=N(bMc);this.oa().appendChild(this.Qa(),b);this.C.hb(this.Ia("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.hb(this.Ia("waffle-assistant-answers-helpcenter-link"));a()};p.$ia=g("V");p.EN=g("F");p.bEb=function(){this.C.setVisible(!1);L(this.Ia("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new D("trigger_feedback"))};p.O2b=function(){JLc(this.$,!1);this.dispatchEvent(new D("rc"))};
p.N2b=function(){K.Vn.Wb()};function cMc(a){dX.call(this,new VF,a);this.C=this.oa().createElement("div");re(this.C,"Previous")}x(cMc,dX);p=cMc.prototype;p.zA=function(){yh(this.Qa(),"Previous questions below")};p.xa=function(){cMc.ea.xa.call(this);Dh(this.Qa(),"waffle-assistant-card");Bh(this.Qa(),"waffle-assistant-answers-previousheadercard")};p.wy=function(a){0<this.oa().Jh(eX(this)).length||eX(this).appendChild(this.C);a()};p.D8=Ie;p.rz=n("assistantAnswersFeedback");function dMc(a,b,c){b=c||b;c=""+(a.B5?O(ELc({error:a.B5,showHelp:a.showHelp},b)):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+O(a.title)+"</div>":"");var d=rr("Suggested question");c+='<div class="waffle-assistant-suggested-questions">';a=a.fw;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+R(d)+'">'+O(Ds({icon:"docs-icon-img docs-icon-help"},
b))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+O(h)+"</div></div></div>"}return P(c+"</div>")};function zX(a,b,c,d,e,f){dX.call(this,a,f);this.C=e||null;this.V=b;this.D=d;this.$=c;this.L=this.C?5==this.C.error:!1;this.F=new lr("",new $U,this.oa());this.Fa(this.F);this.J=new lr("",new YW,this.oa());this.Fa(this.J)}x(zX,dX);p=zX.prototype;p.xa=function(){zX.ea.xa.call(this);this.KA()&&fX(this).appendChild(N(DLc))};
p.Ga=function(){zX.ea.Ga.call(this);Bh(this.Qa(),"waffle-assistant-answers-suggestioncard");this.F.setVisible(this.L);this.getHandler().R(this.F,"action",this.P2b);if(this.KA()){var a=this.Ia("waffle-assistant-answers-card-remove");this.J.hb(a);aX(a,"Remove card",0);this.getHandler().Sc(this.J,"action",this.Q2b)}};p.XB=function(){return bb([eMc,fMc],this.D)?2799:bb([gMc,hMc],this.D)?2801:null};p.WB=function(){return bb([eMc,fMc],this.D)?2798:bb([gMc,hMc],this.D)?2800:null};p.E6=n("Were these interesting?");
p.Vja=n("Interesting");p.Uja=n("Not interesting");p.rz=n("assistantAnswersFeedback");p.KA=function(){return this.C?!nLc(this.C):!1};p.zA=function(){var a=this.D.title;a&&this.C?(a=(uLc(this.C)||"")+(" "+(a+(" for question : "+this.C.D))),yh(this.Qa(),a)):yh(this.Qa(),"Suggested questions")};
p.wy=function(a){var b=this;this.$.then(function(c){if(b.Qb()){if(0==c.length)L(b.Qa(),!1);else{var d=b.oa(),e=eX(b);if(0==d.Jh(e).length){var f=N(dMc,{title:b.D.title,fw:Wa(c,function(a){return a.query}),B5:b.C?uLc(b.C):"",showHelp:b.L});e.appendChild(f);var h=Wa(c,function(a){return a.type});e=b.Oi("waffle-assistant-answercard-question-container");z(e,function(a,e){var f=new lr("",new YW,d);b.Fa(f);f.hb(a);b.getHandler().R(f,"action",v(b.aGb,b,c[e],h,e))});b.L&&b.F.hb(b.Ia("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.Q2b=function(){JLc(this.V,!1);this.dispatchEvent(new D("rc"))};p.aGb=function(a,b,c){this.dispatchEvent(new cJc(this.D.n1,a.xo||null,b,c,this.D.mW,a.query))};p.P2b=function(){K.Vn.Wb()};var iMc={title:"",mW:0,n1:null},eMc={title:"",mW:5,n1:1},fMc={title:"Suggested questions",mW:5,n1:1},hMc={title:"Did you mean?",mW:2,n1:4},gMc={title:"Related questions",mW:4,n1:4};function jMc(a){var b=[];if(ow(a,25)&&(a=V(a,25)))for(var c=0;c<pw(a,1);c++){var d=V(a,1,c);if(ow(d,2)){var e=V(d,2);e&&b.push(kMc(e,lMc(d)))}}return b}function mMc(a){var b=jMc(a);ow(a,6)&&(a=V(a,6))&&b.push(kMc(a,0));return b}function lMc(a){return(a=ow(a,4)?V(a,4):0)?a:0}function kMc(a,b){return{name:a,e6a:b}};function nMc(a,b,c){this.va=a;this.Ba=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.ma=[];this.C={};this.F={};this.V={};this.D={};oMc(this,c)}function pMc(a,b){return a[b]?a[b].values.Dd():[]}
function oMc(a,b){for(var c=new Pm,d=new Pm,e=0;e<b.length;e++){for(var f=mMc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.va[m]){var r=a.va[m];c.add(r);h.push(r)}void 0!=a.Ba[m]&&(m=a.Ba[m],d.add(m),k.push(m))}qMc(a,h,k)}a.L=c.Dd();a.O=d.Dd();tb(a.L);tb(a.O);a.H=Wa(nc(a.C),function(a){return a.key});tb(a.H);a.J=Wa(nc(a.F),function(a){return a.key});tb(a.J);a.$=Wa(nc(a.V),function(a){return a.key});tb(a.$);a.ma=Wa(nc(a.D),function(a){return a.key});tb(a.ma)}
function qMc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(rMc(a.C,b[d],b[e]),rMc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)rMc(a.F,b[d],c[e]),rMc(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(rMc(a.D,c[b],c[d]),rMc(a.D,c[d],c[b]))}function rMc(a,b,c){var d;a[b]?d=a[b].values:d=new Pm;d.add(c);a[b]={key:b,values:d}};function sMc(a,b){this.C=a;for(var c={},d=0;d<a.yj();d++)c[a.kd(d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<pw(a,1);d++)c[V(a,1,d).getName().toLowerCase()]=d;this.V=c;c={};for(d=0;d<this.C.yj();d++)c[V(this.C.kd(d),11)]=d;this.ma=c;c={};for(d=0;d<pw(this.C,1);d++)c[V(V(this.C,1,d),4)]=d;this.va=c;c=[];for(d=0;d<a.yj();d++)AX(a.kd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<pw(a,1);d++)AX(V(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<pw(a,1);d++){for(var e=V(a,1,d).getName(),
f=!0,h=0;h<tMc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+tMc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ha=c;this.Ma=uMc(a,0);this.$=uMc(a,1);c=[];for(d=0;d<a.yj();d++).8<=V(a.kd(d),6)&&c.push(d);this.Ba=c;c=[];for(d=0;d<a.yj();d++)e=a.kd(d),.95<=tw(e,2).length/V(e,8)&&c.push(d);this.Oa=c;c=[];for(d=0;d<pw(a,3);d++){e=a.kd(V(a,3,d));a:if(.5<tw(e,2).length/V(e,8)||.3>pw(e,3)/pw(e,2))e=!1;else{for(f=0;f<pw(e,10);f++)if(.95<V(e,10,f)/V(e,8)){e=!1;break a}e=!0}e&&c.push(V(a,3,d))}tb(c);this.Ka=
c;this.F=vMc(a.yj());this.H=vMc(pw(a,1));this.D=new nMc(this.O,this.V,b)}function vMc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function uMc(a,b){for(var c=[],d=0;d<a.yj();d++)a.kd(d).getType()==b&&c.push(d);return c}function wMc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=xMc(c,a[d]);for(a=0;a<b.length;a++)d=xMc(c,b[a]),c=0<d.length?d:c;return c}
function BX(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.Ma),m.push(a.Ba));d&&m.push(a.Ka);e&&m.push(a.Oa);null!=h&&-1!=h?l.push(pMc(a.D.V,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=wMc(m,l);b=xMc(a,b);return 0<b.length?{index:XW(b),vB:3}:0<a.length?{index:XW(a),vB:1}:yMc()}
function CX(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Ha);null!=e&&-1!=e?h.push(pMc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.ma);a=wMc(k,h);b=xMc(a,b);return 0<b.length?{index:XW(b),vB:3}:0<a.length?{index:XW(a),vB:1}:yMc()}function zMc(a,b){for(var c=5;;){var d=a.C.kd(b),e=WW(pw(d,2),1)[0];c--;if(AX(VW(d,e))||0==c)return e}}function AMc(a,b){for(var c=5;;){var d=a.C.kd(b),e=WW(pw(d,3),1)[0];e=V(d,3,e);c--;if(AX(VW(d,e))||0==c)return e}}
function DX(a,b){b=a.C.kd(b);a=b.getName();AX(a)||(b=BMc(tw(b,7)),a=null==b?a:b);return a}function EX(a,b){b=V(a.C,1,b);a=b.getName();AX(a)||(b=BMc(tw(b,2)),a=null==b?a:b);return a}function BMc(a){for(var b=0;b<a.length;b++)if(AX(a[b]))return a[b];return null}function AX(a){return null==a?!1:50>=a.length}function CMc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function yMc(){return{index:-1,vB:0}}
function DMc(a){for(var b=WW(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],vB:1});return c}function xMc(a,b){tb(a);tb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var tMc=["average","total","sum","mean","median"];function FX(a){this.Ma=a;this.fw=[];this.C=this.va=this.ma=this.xL=this.WH=null;this.V=[];this.Ka=[];this.O=new Pm;this.Ba=new Pm;this.$=!1;this.D=[];this.F=[]}p=FX.prototype;p.Me=function(a,b,c,d,e,f){this.reset();this.WH=b;this.xL=c;this.ma=d;this.va=a;this.Ka=f;this.V=e;this.C=new sMc(a,e)};
p.c$=function(){EMc(this);for(var a=[],b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.xk(13)||this.xk(2)){var d=V(c,6);if(d&&-1!=CMc(this.C,d)){var e=FMc(this,c);1<e.length&&(this.xk(23)?GX(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.xk(2)&&GX(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=FMc(this,c);1<f.length&&(this.xk(23)?GX(this,a,"Scatter chart of "+f[0].name+" vs "+f[1].name,23,2):
this.xk(2)&&GX(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=jMc(c),m=0;m<l.length&&-1!=CMc(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].e6a&&(this.xk(20)?GX(this,a,"Chart of distribution of "+h[0].name,20,2):this.xk(14)&&GX(this,a,"Distribution of "+h[0].name,14,1.5))}}if(this.xk(26))for(var r=ha(this.Ka),u=r.next();!u.done;u=r.next()){var w=u.value;ow(w,3)&&GX(this,a,w.hg(),26,2)}if(this.xk(1)){var y=this.C.C,B=CX(this.C,
this.F,!1,!0),H=B.index,Q=BX(this.C,this.D,!0,!1,!0,!0,H),Y=Q.index;if(-1!=Y&&-1!=H){var U=10<=pw(y.kd(Y),2)?"5 ":"",ja=DX(this.C,Y),oa=EX(this.C,H);if(ja!=oa){var za=HX(1,[B],[Q]);GX(this,a,this.GHa(1)+" "+U+ja+" by "+oa,1,za)}}}if(this.xk(2)&&1<pw(this.C.C,1)){a:{var Ia=this.C,Ka=this.F;if(2>Ia.H.length)var Ba=[yMc(),yMc()];else{var qb=CX(Ia,Ka,!1,!1,void 0,!0),Eb=qb.index;if(-1!=Eb){var Va=pMc(Ia.D.D,Eb);if(0<Va.length){var zb=[qb],yc=XW(Va),$b=2,Ec=xMc(Va,Ka);0<Ec.length&&(yc=XW(Ec),$b=3);zb.push({index:yc,
vB:$b});Ba=zb;break a}}Ba=DMc(2<=Ia.L.length?Ia.L:Ia.H)}}var Mc=Ba,Rc=EX(this.C,Mc[0].index),Ed=EX(this.C,Mc[1].index);if(Rc!=Ed){var Mb=HX(1,Mc,[]);GX(this,a,"Correlation of "+Rc+" and "+Ed,2,Mb)}}if(this.xk(3)){var Wf=this.C.C,sb=CX(this.C,this.F,!0),ge=sb.index;if(-1!=ge){var ce=HX(1,[sb],[]);GX(this,a,this.cQ(tw(V(Wf,1,ge),3),3)+" of "+EX(this.C,ge),3,ce)}}if(this.xk(5)){var Gg=this.C.C,Jf=CX(this.C,this.F,!0,!0),Ph=Jf.index,sf=BX(this.C,this.D,!0,!0,!1,!0,Ph),Xg=sf.index;if(-1!=Ph&&-1!=Xg){var Nj=
EX(this.C,Ph),gl=Gg.kd(Xg),qj=DX(this.C,Xg);if(0<pw(gl,3)&&qj!=Nj){var ii=HX(1,[Jf],[sf]),Oj=AMc(this.C,Xg);GX(this,a,this.cQ(tw(V(Gg,1,Ph),3),5)+" of "+Nj+" when "+qj+" is "+VW(gl,Oj),5,ii)}}}if(this.xk(9)){var mn=CX(this.C,this.F,!1,!0),hl=mn.index,Qh=BX(this.C,this.D,!0,!1,!0,!0,hl),Ti=Qh.index;if(-1!=Ti&&-1!=hl){var Pk=EX(this.C,hl),vm=DX(this.C,Ti);if(vm!=Pk){var rj=HX(1,[mn],[Qh]);GX(this,a,vm+" with "+this.Ija(9)+" "+Pk,9,rj)}}}if(this.xk(10)&&0<pw(this.C.C,1)){var il=CX(this.C,this.F),jl=
HX(1,[il],[]),Rl=EX(this.C,il.index);GX(this,a,this.Ija(10)+" "+Rl,10,jl)}if(this.xk(11)){var Ui=this.C.C,kl=BX(this.C,this.D,!0,!0,!1,!1,-1),xb=kl.index;if(-1!=xb){var Pj=DX(this.C,xb);if(0<pw(Ui.kd(xb),3)){var Qj=HX(1,[],[kl]);GX(this,a,"Most frequent "+Pj,11,Qj)}}}if(this.xk(12)){var Rj=this.C.C,wu=CX(this.C,this.F,!0),hp=wu.index;a:{var wm=this.C;if(1==wm.$.length){var ll=wm.$[0];if(!V(wm.C.kd(ll),5)){var eo=ll;break a}}eo=-1}var xm=eo;if(-1!=xm&&-1!=hp){var Sj=EX(this.C,hp),Tj=Rj.kd(xm);if(0<
pw(Tj,2)){var Qk=HX(1,[wu],[]),Mr=zMc(this.C,xm);GX(this,a,this.cQ(tw(V(Rj,1,hp),3),12)+" of "+Sj+" "+XW(GMc)+" "+VW(Tj,Mr),12,Qk)}}}if(this.xk(15)){var sj=this.C.C,ym=CX(this.C,this.F,!0),ip=ym.index,jp=BX(this.C,this.D,!1,!0,!1,!0,ip),zm=jp.index;if(-1!=ip&&-1!=zm){var fo=EX(this.C,ip),nn=DX(this.C,zm);if(nn!=fo){var qk=sj.kd(zm);if(2<=pw(qk,3)){var Rk=HX(1,[ym],[jp]),rk=WW(pw(qk,3),2);GX(this,a,"Compare "+this.cQ(tw(V(sj,1,ip),3),15)+" "+fo+" for "+nn+" "+VW(qk,V(qk,3,rk[0]))+" and "+VW(qk,V(qk,
3,rk[1])),15,Rk)}}}}if(this.xk(16)){var Vi=BX(this.C,this.D,!0,!0,!1,!1),Am=Vi.index;if(-1!=Am){var go=DX(this.C,Am),Uj=HX(1,[],[Vi]);GX(this,a,"List unique values in "+go,16,Uj)}}if(this.xk(17)){var kp=this.C.C,ho=BX(this.C,this.D,!0,!0,!1,!1),ji=ho.index;if(-1!=ji){var Sk=kp.kd(ji),Ys=DX(this.C,ji);if(!(1>pw(Sk,3))){var on=AMc(this.C,ji),Nr=HX(1,[],[ho]);GX(this,a,"What percentage of "+Ys+" is "+VW(Sk,on),17,Nr)}}}if(this.xk(13)){var vq=this.C.C,Zs=CX(this.C,this.F,!0,!0),lp=Zs.index,Sl=BX(this.C,
this.D,!0,!0,!1,!0,lp),io=Sl.index;if(-1!=lp&&-1!=io){var $s=EX(this.C,lp),jo=DX(this.C,io);if(jo!=$s){var rp=HX(1,[Zs],[Sl]);GX(this,a,this.cQ(tw(V(vq,1,lp),3),13)+" of "+$s+" by "+jo,13,rp)}}}if(this.xk(18)){var vn=CX(this.C,this.F),Wl=vn.index;if(-1!=Wl){var Gm=HX(2,[vn],[]);GX(this,a,"Histogram of "+EX(this.C,Wl),18,Gm)}}if(this.xk(24)){var iz=BX(this.C,this.D,!0,!0),Fw=iz.index;if(-1!=Fw){var QB=HX(1,[iz],[]);GX(this,a,"Count of "+DX(this.C,Fw),24,QB)}}if(this.xk(25)){var bG=this.C.C,jz=BX(this.C,
this.D,!0,!0),wk=jz.index;if(-1!=wk){var tp=bG.kd(wk),xn=zMc(this.C,wk),Jq=HX(1,[jz],[]);GX(this,a,"Count when "+DX(this.C,wk)+" is "+VW(tp,xn),25,Jq)}}var xk=3>a.length;if((xk||0==WW(5,1)[0])&&this.xk(7)){var wo=this.C.C,xo=CX(this.C,this.F,!1,!0),yo=BX(this.C,this.D,!1,!1,!1,!0,xo.index);if(-1!=yo.index&&-1!=xo.index){var RB=wo.kd(yo.index),UK=DX(this.C,yo.index),SB=EX(this.C,xo.index);if(0<pw(RB,2)&&UK!=SB){var Zl=HX(1,[xo],[yo]),kz=zMc(this.C,yo.index);GX(this,a,"Show "+SB+" for "+UK+" "+VW(RB,
kz),7,Zl)}}}if((xk||0==WW(5,1)[0])&&this.xk(8)){var kt=this.C.C;a:{var Kq=this.C,ql=this.D;if(2>Kq.F.length)var Gw=[yMc(),yMc()];else{var Tu=BX(Kq,ql,!0,!1,!1,!1,void 0,!0),$l=Tu.index;if(-1!=$l){var zo=pMc(Kq.D.C,$l);if(0<zo.length){var VK=[Tu],lt=XW(zo),Uu=2,TB=xMc(zo,ql);0<TB.length&&(lt=XW(TB),Uu=3);VK.push({index:lt,vB:Uu});Gw=VK;break a}}var yn=DMc(2<=Kq.J.length?Kq.J:Kq.F);yn[0].index!=$l&&(yn[1]=yn[0],yn[0]=Tu);Gw=yn}}var Ao=Gw,lz=Ao[0].index;if(1<kt.yj()&&-1!=lz){var mt=Ao[1].index,Vu=kt.kd(mt),
Hw=DX(this.C,mt),nt=DX(this.C,lz);if(0<pw(Vu,2)&&Hw!=nt){var UB=HX(1,[],Ao),mz=zMc(this.C,mt);GX(this,a,"What is "+nt+" where "+Hw+" is "+VW(Vu,mz),8,UB)}}}this.fw=HMc(a)};function EMc(a){if(a.$){var b=$H(OJ(a.Ma)),c=uw(a.C.C,4);z(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.ma[d+b],k=a.C.va[d+b];h&&0<=h&&eb(a.D,h);k&&0<=k&&eb(a.F,k)}})}}p.reset=function(){this.fw=[];this.F=[];this.D=[];this.Ba=new Pm;this.O=new Pm};p.d$=function(){return mf(this.fw.slice())};
function HMc(a){tb(a,function(a,c){return c.weight-a.weight});return Wa(a,function(a){return a.Tra})}function GX(a,b,c,d,e){e=a.EHa(d,e);a.Ba.contains(c)||(b.push({Tra:{query:c,xo:void 0,type:d},weight:e}),a.O.add(d),a.Ba.add(c))}p.xk=function(a){return!this.O.contains(a)};function IMc(a,b){return a.d$().then(function(a){return a.length<=b?a:nb(a,0,b)},null,a)}function HX(a,b,c){z(b,function(b){3==b.vB&&a++});z(c,function(b){3==b.vB&&a++});return a}
function FMc(a,b){var c=[];b=jMc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.V?e.V[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.cQ=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=JMc;break a;case 4:a=KMc;break a}a=LMc}return XW(a)};p.GHa=function(){return XW(MMc)};p.Ija=function(){return XW(NMc)};
var LMc=["Average","Median"],JMc=["Total","Average","Median"],KMc=["Median"],NMc="Minimum Maximum Most Least Highest Lowest".split(" "),MMc=["Top","Bottom"],GMc=["before","after"];var OMc={};hc({a5a:{type:0,yA:"",vA:[]},iea:{type:1,yA:"Sum",vA:[3,5,13,12,15]},uca:{type:2,yA:"Average",vA:[3,5,13,12,15]},Eda:{type:3,yA:"Mode",vA:[3]},u5a:{type:4,yA:"Variance",vA:[3]},m4a:{type:5,yA:"Standard deviation",vA:[3]},Fwa:{type:6,yA:"Median",vA:[3,5,13,12]},DU:{type:7,yA:"Count",vA:[24,25]},c4a:{type:8,yA:"Bottom",vA:[1,10,14]},d4a:{type:9,yA:"Top",vA:[1,11,10,14]}},function(a){OMc[a.type]=a});function PMc(a){if(a=OMc[a])return a};function QMc(a){FX.call(this,a);this.H=[]}q(QMc,FX);p=QMc.prototype;p.reset=function(){FX.prototype.reset.call(this);this.H=[]};p.EHa=function(a,b){return 1+b};p.xk=function(a){return!this.O.contains(a)&&0<RMc(this,a).length};p.GHa=function(a){return SMc(this,a)};p.cQ=function(a,b){return SMc(this,b)};p.Ija=function(a){return SMc(this,a)};function TMc(a,b){a.reset();z(b,function(b){z(tw(b,1),function(b){a.H.push(V(b,1))},a)},a);ZIc(a.H);a.c$();return IMc(a,3)}
function RMc(a,b){return Ua(a.H,function(a){return bb(PMc(a).vA,b)},a)}function UMc(a,b){a=$a(a.H,function(a){return PMc(a).type==b},a);return PMc(a)}function SMc(a,b){b=RMc(a,b);return UMc(a,XW(b)).yA};function IX(a,b,c,d,e,f,h,k,l,m,r,u,w,y){iX.call(this,y);this.Le=c;this.Ud=d;this.Fe=e;this.Lc=a;this.jb=new QMc(this.Ud);this.Ra=h;this.ma=m;this.Se=r;this.Db=u;this.J=this.V=this.O=this.Cb=this.D=null;this.Wa="";this.Ha=new eJc;this.L=f;this.Ka=this.Sb=this.Oa=this.F=null;this.Ma=k;this.Ed=!1;this.Bb=Aj(new zj,10).build();this.Pc=new xw;this.xb=l;this.$={};this.qd=qn();this.ub="";this.Ba=null;this.kf=w}x(IX,iX);p=IX.prototype;p.Ga=function(){IX.ea.Ga.call(this);this.NH(null==this.F)};
p.hqa=function(a,b){IX.ea.hqa.call(this,a,b);b=this.oa();var c=this.va;this.O=new ZW(b);c.Fa(this.O,!0);b.appendChild(a,this.O.Qa());this.O.Ga();this.V=new oJc(this.O,this.L,this.Ha,10);c.qa(this.V);c.getHandler().R(this.O,"answers-submit-query",v(this.K2b,this))};p.z4=function(){IX.ea.z4.call(this);this.V=this.O=null};
p.NH=function(a){var b=this;this.O&&this.O.setVisible(!a);a?(this.Ba&&this.Ba.dispose(),this.Ba=new Mi(function(){IX.ea.NH.call(b,a)},300,this),this.qa(this.Ba),this.Ba.start()):(this.Ba&&this.Ba.stop(),IX.ea.NH.call(this,a))};p.Mf=ca("Cb");
function VMc(a,b,c,d,e,f,h){h=void 0===h?[]:h;var k=void 0===k?[]:k;a.jb.Me(c,b,d,e,h,k);h=Wa(tw(c,1),function(a){return a.getName()});var l=[],m=[];z(tw(c,2),function(a){l.push(a.getName());m=m.concat(tw(a,2))});fJc(a.Ha,h,l,m);a.Lc.d$().then(function(a){this.Ha.F=a;this.V&&(a=this.V,Ge(a.O.oa())==a.D&&a.mTa())},null,a);a.F=b;a.Oa=d;a.Sb=e;a.Ka=c;a.Bb=Bj(Aj(new zj,10),WMc(a)).build();if(f)for(c=Wa(a.C,function(a){if(a instanceof xX||a instanceof yX)return a.EN().D}),a.rW(),d=0;d<c.length;d++)if(e=
c[d])f=new TW,G(f,1,5),XMc(a,e,f);a.NH(null==b)}p.reset=function(){tT(this.$);tT(this.Ha.D);var a=this.Ha;a.F=[];a.C.clear();this.J=null;this.iha()};
function XMc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;G(c,13,a.ma.O.J);var f=new SW;Tf(f,5,c);uJc(a.V);var h=Lb(b.toLowerCase());if(!a.Cb||a.Cb.getStatus().getState().Bh())if(a.$[h])YMc(a,b,!1);else{d=new wX(b,null,null,null,2,a.ma);ZMc(a,d,!0,f);return}else{var k=a.$[h];k&&k instanceof yX&&2==k.EN().error&&delete a.$[h]}b&&a.F?a.$[h]&&!d?(a.L.Vb(2681,a.Bb),YMc(a,b,!0)):(a.$[h]&&d&&$Mc(a,a.$[h],!1),h=WMc(a),k=Rf(Rf(h,eT,46),SW,4),G(k,2,e),e=Bj(Aj(new zj,10),h).build(),a.L.Vb(2635,e),e=uF(a.F.rect),
f=Qv(Um(Ps(Wu(Os(a.Cb.Te("/answers/parse").Cf("q",b,"qt",F(c,1),"gid",a.F.jd,"range",e,"context",a.Wa),v(a.Zk,a,b,f)),v(a.J2b,a,b,f)),"POST"),2)),a.Oa&&null!=a.Sb&&(b=0==a.Oa.rect.width||0==a.Oa.rect.height?"":uF(a.Oa.rect),f.Cf("headerRange",b,"tableRecordDimension",""+a.Sb)),d&&f.Cf("sgfml",d),f.we(),a.ub=rn(a.qd,$A.Sta),aNc(a,!0)):sJc(a.V,"")}function YMc(a,b,c){var d=a.$[Lb(b.toLowerCase())];d!=Ra(a.C)&&(1<a.C.length&&bNc(a),c&&cNc(a,d.EN()).then(function(a){dNc(this,d,a)},null,a),xKc(a,d))}
p.K2b=function(a){var b=a.O;var c=a.Ha;var d=a.F,e=a.Ba;c?c=hLc(b,d,e,c):(c=new TW,G(c,1,b));XMc(this,a.V,c,a.C,a.H)};p.J2b=function(a,b){if(this.F){var c=F(Rf(b,TW,5),1);c=1==c||4==c?LIc.Qya:LIc.tza;var d=WMc(this),e=Rf(Rf(d,eT,46),SW,4);G(e,1,c);G(b,1,c);c=Bj(Aj(new zj,10),d).build();this.L.Vb(2640,c);eNc(this,a,b)}};function eNc(a,b,c){aNc(a,!1);b=new wX(b,null,null,null,3,a.ma);ZMc(a,b,!1,c);fNc(a)}
p.Zk=function(a,b,c){this.F&&this.Ma.C.D.C.then(function(){var d=null,e=null,f=!1,h=Rf(b,TW,5),k=F(h,1),l=WMc(this);k=1==k||4==k?LIc.Qya:LIc.tza;var m=Rf(Rf(l,eT,46),SW,4);G(m,1,k);G(b,1,k);k=Bj(Aj(new zj,10),l).build();if(c.bl()){e=this.Pc.Ad(rX.Ca(),c.sf());if(f=e.getStatus()){switch(f){case 1:var r=2639;break;case 2:r=2643;break;case 3:r=2644;break;case 4:r=2638;break;case 5:r=2707;break;case 6:r=2706}r&&this.L.Vb(r,k)}r=V(e,10);G(h,4,r);r=V(e,11);G(h,5,r);ow(e,16)&&(r=V(e,16),G(h,16,r));if(1==
f){eNc(this,a,b);return}if(2==f){e=-1!=gNc(a);h=-1!=gLc(a);f=4;d=Rf(b,TW,5);e?(f=5,G(d,8,2)):h&&(f=7,G(d,8,1));h=new wX(a,null,null,null,f,this.ma);e?(e=new yX(h,!0,this.xb,!0,this.oa()),hNc(this,h,e,b)):ZMc(this,h,!0,b);aNc(this,!1);fNc(this);return}l=ow(e,2)?e.Fj():null;f=!0;if(l){r="";d=FIc(this.Ma,l,this.F,!!this.Ka&&!!V(this.Ka,4));G(h,14,!!d);if(!d){if(m=l.match(/([A-Z]*)\(/)){var u=Rf(Rf(yj(k),eT,46),SW,4);G(u,7,m[1]);G(b,7,m[1])}this.L.Vb(2645,k)}d&&GIc(d)||(r=this.Ma,u=this.F,k="="!=l[0]?
"="+l:l,m=DIc(r),u=EIc(m,u),r=L_b(r.C,k,m,u.row,u.xj));k=ow(e,19)?FIc(this.Ma,V(e,19)||"",this.F,!!this.Ka&&!!V(this.Ka,4)):d;d=new wX(a,d,"="!=l[0]?"="+l:l,e,null,this.ma,k);if(ow(e,23)&&d.Sj()){if(ow(e,17)&&ow(V(e,17),5)){k=V(V(e,17),5);l=d.ma;if(ow(k,5))switch(V(k,5).getPosition()){case 1:l.C="right";break;case 2:l.C="left";break;case 3:l.C="top";break;case 4:l.C="bottom"}ow(k,1)&&ow(V(k,1),1)&&ow(V(V(k,1),1),1)&&1==V(V(V(k,1),1),1)&&(l.J=!0);ow(k,2)&&ow(V(k,2),1)&&ow(V(V(k,2),1),1)&&1==V(V(V(k,
2),1),1)&&(l.L=!0);ow(k,1)&&ow(V(k,1),1)&&ow(V(V(k,1),1),2)&&(m=V(V(V(k,1),1),2),l.F=m);ow(k,2)&&ow(V(k,2),1)&&ow(V(V(k,2),1),2)&&(m=V(V(V(k,2),1),2),l.H=m);ow(k,3)&&(m=k.getTitle().getTitle(),l.O=m);ow(k,4)&&(k=V(k,4).getTitle(),l.D=k)}this.Wa=uw(e,23)}else this.Wa="";r&&d.L.push(r);d.Sj()&&Tf(h,15,d.V);d.Pz()&&ow(e,24)&&(r=wAc(uw(e,24)),Tf(h,17,r))}else!d&&ow(e,24)?(d=new wX(a,[[]],"",e,null,this.ma,[[]]),this.Wa=uw(e,23),r=wAc(uw(e,24)),Tf(h,17,r)):ow(e,9)&&(r=e.getError(),d=new wX(a,null,null,
e||null,6,this.ma),l=V(r,2),G(h,6,l),ow(r,3)&&(r=V(r,3),G(h,12,r)))}else this.L.Vb(2640,k);d||(d=new wX(a,null,null,e||null,4,this.ma));aNc(this,!1);nLc(d)?iNc(this,d,f,b):ZMc(this,d,f,b);fNc(this)},function(){eNc(this,a,b)},this)};function fNc(a){""!=a.ub&&(sn(a.qd,a.ub),a.ub="")}function jNc(a){if(null!=a.xo)return gMc;switch(a.error){case 4:case 6:return 0<a.O.length?hMc:fMc;case 5:return fMc}return iMc}
function WMc(a){var b=new SW;G(b,8,!0);var c=new eT;Tf(c,4,b);a=ZJc(a.F);Tf(a,46,c);return a}function gNc(a){return ab(eLc,function(b){return Fb(a,b)})}function kNc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=a.Ma,f=b[d].Fj(),h=!!a.Ka&&!!V(a.Ka,4);e=FIc(e,f,a.F,h);GIc(e)&&(e={query:V(b[d],1),xo:b[d].Fj(),type:b[d].getType()},ow(b[d],5)&&(e.YFa=V(b[d],5)),c.push(e))}return mf(c)}
function iNc(a,b,c,d){c=new xX(b,a.Le,a.Ud,a.Fe,a.L,a.xb,a.Ra,c,a.ma,a.Ed,a.kf,a.Ma,a.oa());hNc(a,b,c,d)}function lNc(a,b){if(a.D&&a.D.isVisible())BP(a.D);else{var c=a.Se.D.C["ritz-ap"]||null;VLc(b)&&(a.D=bZb(a.Db,a.oa(),c,void 0,"answersPivotPromo"),a.D&&(a.getHandler().Sc(a.D.C,"beforeshow",function(){return a.OYb}).Sc(a,"Ud",a.iha),a.D.show(),a.qa(a.D),mMa(c,"answersPivotPromo")))}}p.gca=function(){IX.ea.gca.call(this);this.D&&this.D.isVisible()&&this.D.C.vd()};
p.OYb=function(){var a=this.oa().Ia("docs-promo-text-container",this.D.C.Qa());Bh(a,"waffle-assistant-answercard-pivot-promo-text-container")};p.iha=function(){this.D&&this.D.isVisible()&&BP(this.D)};function ZMc(a,b,c,d){c=new yX(b,c,a.xb,!1,a.oa());hNc(a,b,c,d)}
function hNc(a,b,c,d){bNc(a);var e=cNc(a,b,d);mNc(a,c);c instanceof xX&&lNc(a,c);nNc(a);nLc(b)&&gJc(a.Ha,b.D);e.then(function(a){if(d){if(c instanceof xX){var b=Rf(d,TW,5);G(b,18,c.Zb)}b=WMc(this);var e=Rf(b,eT,46);Tf(e,4,d);b=Bj(Aj(new zj,10),b).build();this.L.Vb(2781,b)}dNc(this,c,a)},null,a);c.$ia()&&(a.$[Lb(b.D.toLowerCase())]=c);a.getHandler().R(c,"rc",a.KLa)}function dNc(a,b,c){b instanceof yX&&null!=c&&oi(c.getElement())&&(b=b.getElement(),L(b,!1),a.getHandler().R(c,"rc",a.KLa))}
function bNc(a){oNc(a);z(a.C,function(a){a instanceof yX&&(a=a.getElement(),L(a,!0))});pNc(a)}function pNc(a){0!=a.C.length&&(a.J?xKc(a,a.J):(a.J=new cMc(a.oa()),mNc(a,a.J)))}function oNc(a){z(a.C,function(b){b instanceof xX||b instanceof yX||b==a.J||a.sH(b)})}function qNc(a,b){var c=mf([]);b=b.Ba;0<b.length&&(c=TMc(a.jb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?IMc(a.Lc,c).then(function(a){return kb(b,a)}):mf(b)})}
function cNc(a,b,c){var d=jNc(b),e=null;d==gMc||d==hMc?0<b.O.length&&(e=kNc(a,b)):d==fMc&&(e=qNc(a,b));var f=null;return e?(f=new zX(new VF,a.xb,e,d,b,a.oa()),mNc(a,f),a.L.Vb(2769,a.Bb),a.getHandler().R(f,"sqc",v(a.$Fb,a)),e.then(function(a){if(c){var b=Rf(c,TW,5);bb([gMc,hMc],f.D)?(a=jLc(a),Tf(b,7,a)):bb([eMc,fMc],f.D)&&(a=kLc(a),Tf(b,9,a))}return f},null,a)):mf(f)}p.$Fb=function(a){sJc(this.V,a.F,!0);var b=a.O;b=1==b?hLc(b,a.C,a.H,3):iLc(b,a.C,a.H,a.Ba);XMc(this,a.F,b,a.Fj());this.L.Vb(2762,this.Bb)};
function aNc(a,b){a.O&&(a=a.O,L(a.F,b),L(a.oa().Ia("waffle-assistant-answers-button-container",a.C),!b),ZU(a.H,b))}function mNc(a,b){b.nt(a.Ld());a.C.push(b);if(a.Zb){wKc(a,!1);var c=a.H.ad();b.O=c;a.H.kh(b,0,!0);b.zJ()}UJc(b,!0)}function nNc(a){for(var b=a.C;5<b.length;)a.sH(b[0])}p.rW=function(){IX.ea.rW.call(this);this.reset()};p.KLa=function(a){$Mc(this,a.target)};p.JCb=function(a){iNc(this,a.EN(),a.$ia());$Lc(this.Ra,"Remove answer undone",this.oa())};
p.sH=function(a){if(a.Qb()){if(a instanceof xX||a instanceof yX)delete this.$[Lb(a.EN().D.toLowerCase())],a==Ra(this.C)&&oNc(this);IX.ea.sH.call(this,a);this.iha()}C(a)};
function $Mc(a,b,c){c=void 0===c?!0:c;var d=a.oa();if(b instanceof xX)a.sH(b),c&&$Lc(a.Ra,"Answer removed",d,v(a.JCb,a,b));else if(b instanceof yX)a.sH(b),c&&$Lc(a.Ra,"Card removed",d);else if(b instanceof zX&&b.C&&!nLc(b.C)){var e=b.C.D;z(a.C,function(b){b instanceof yX&&b.EN().D==e&&(a.sH(b),c&&$Lc(a.Ra,"Card removed",d))})}b=a.C;!a.J||b[0]!=a.J&&b[b.length-1]!=a.J||(a.sH(a.J),a.J=null)};function rNc(a,b,c){b=c||b;a=P('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
O(Ds({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input class="waffle-assistant-answers-input-box" placeholder="';a+=vr("Ask a question about your data");return P(a+'"/></div></form></div>')};function sNc(a,b,c){FX.call(this,a);this.J=[];this.L=this.H=null;this.Ha=b;this.Ra=c;this.Oa=Aj(new zj,10).build()}q(sNc,FX);p=sNc.prototype;p.c$=function(){this.reset();FX.prototype.c$.call(this);tNc(this)};p.reset=function(){FX.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.d$=function(){return this.H?this.H.then(function(){return this.J.slice()},null,this):FX.prototype.d$.call(this)};p.EHa=function(a,b){return Math.pow(Math.random(),1/(uNc(a)*b))};p.Mf=ca("L");
function uNc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;case 26:return.5;default:return.3}}
function tNc(a){var b=null;a.H=new kf(function(a){if(!this.L||this.L.getStatus().getState().Bh())this.J=this.fw,a();var c=uF(this.WH.rect),e=Wa(this.fw,function(a){return a.query});c=Ps(Qv(Um(Wu(Os(this.L.Te("/answers/parsesuggestions").Cf("gid",this.WH.jd,"range",c),v(function(b){vNc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.Ra.Vb(2833,this.Oa);this.J=this.fw;a()},this)).setContent(["queries",Vl(e)]).setTimeout(2E3),1)),"POST");this.xL&&null!=this.ma&&(e=0==this.xL.rect.width||0==
this.xL.rect.height?"":uF(this.xL.rect),c.Cf("headerRange",e,"tableRecordDimension",""+this.ma));b=c.we()},a);rf(a.H,function(){b&&b.dispose()})}function vNc(a,b){return a.Ha.C.D.C.then(function(){var a=[];if(b.bl())for(var d=b.sf(),e=0;e<d.length;e++){var f;if(f=d[e]){f=this.Ha;var h=!!this.va&&!!V(this.va,4);f=FIc(f,d[e],this.WH,h);f=GIc(f)}f&&(this.fw[e].xo=d[e],a.push(this.fw[e]))}this.J=a},function(){this.J.length=0},a)};function JX(a,b,c,d,e,f,h,k,l,m,r){jX.call(this,1,f,e,r);this.ub=c;this.Ma=null;this.Ba=new lr("",new $U,this.oa());this.Fa(this.Ba);this.Ha=new lr("",new $U,this.oa());this.Fa(this.Ha);f=new a3b(a,!0,!0);f=new Wzc(f,c);this.Wa=new ILc(e);this.O=new sNc(this.ub,f,e);this.H=new IX(this.O,a,b,c,d,e,this.Ta,f,this.Wa,h,k,l,m,r);a=wNc;this.D=new bV(b,a.kda,a.lda);this.qa(this.D);this.F=this.J=null;this.jb=Aj(new zj,10).build();this.Ka=!1}x(JX,jX);
var wNc={kda:"waffle-assistant-answers-styled-border",lda:"waffle-assistant-answers-styled-rect",V0a:"waffle-assistant-answers-input-box",X2a:"waffle-assistant-answers-query-box",Hxc:"waffle-assistant-answers-query-box-focused",k1a:"waffle-assistant-answers-learn-more",asc:"waffle-assistant-answers-logging-message-container",q2a:"waffle-assistant-answers-logging-opt-out"};p=JX.prototype;p.xa=function(){JX.ea.xa.call(this);var a=N(rNc);this.oa().appendChild(zKc(this),a)};
p.Ga=function(){JX.ea.Ga.call(this);var a=wNc,b=this.Ia(a.X2a),c=this.Ia(a.V0a);this.Ha.hb(this.Ia(a.q2a));this.Ba.hb(this.Ia(a.k1a));this.getHandler().R(b,"focus",this.YBb,!0).R(b,"blur",this.WBb,!0).R(b,"mouseover",this.$Bb).R(b,"mouseout",this.ZBb).R(b,"click",this.XBb).R(c,"input",this.L2b).R(this.Ha,"action",this.$zb).R(this.Ba,"action",this.Twb).R(DH(this.ub),"rb",Otc(this.M2b,25,this));this.setVisible(null!=this.J);xNc(this,s1a&&t1a&&mB("showAnswersLoggingOptOut"))};p.SUa=Ie;p.CMa=Je;
p.kra=Ie;p.getTitle=n("Answers");p.b2=n(1);p.hW=function(a){return 3==a||0==a||1==a};p.FN=function(a,b){tb(a,function(a,b){return V(b,2)-V(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=uw(a[f],1);3==h?e=a[f]:0==h?c.push(V(a[f],8)):1==h&&d.push(a[f])}if(e&&V(e,2)){f=b||null;h=ow(e,11)?V(e,11):null;var k=null==h?null:pT(V(e,10));0<pw(e,4)?yNc(this,pT(gT(e)),V(e,9),k,h,c,d):yNc(this,f,V(e,9),k,h,c,d);this.F||(JX.ea.FN.call(this,a,b),this.getHandler().R(this.F,"sqc",this.YFb))}else this.qU(!0)};
p.lP=function(a){if(!this.F){var b=IMc(this.O,3);this.F=new zX(a,this.Wa,b,eMc,void 0,this.oa())}return this.F};p.YBa=g("H");p.tma=function(){return this.isVisible()};
p.qU=function(a,b,c){this.O.reset();(a||b)&&this.F&&(JX.ea.qU.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(JX.ea.qU.call(this,a,b,c),this.F.dispose(),this.F=null),this.Qb()&&(this.O.reset(),this.J=null,a=this.H,a.Qb()&&(b=a.Ha,b.F=[],b.C.clear(),a.V&&(b=a.V,b.O.Qb()&&(nJc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.rW(),a.jb.reset(),a.F=null,a.NH(!0)),this.setVisible(!1),this.Rb()&&dV(this.D));c&&this.H.reset()};p.MXa=function(a,b){b||wKc(this.H,a)};
p.Mf=function(a){this.Ma=a;this.H.Mf(a);this.O.Mf(a)};p.rU=function(a){JX.ea.rU.call(this,a);a?cV(this.D,this.J):dV(this.D)};function zNc(a,b){a.Rb()&&(b?dV(a.D):cV(a.D,a.J))}function xNc(a,b){L(a.Ia("waffle-assistant-answers-logging-message-container"),b)}function ANc(a,b){a=a.Ia("waffle-assistant-answers-query-box");Fh(a,"waffle-assistant-answers-query-box-focused",b)}p.M2b=function(){this.Rb()&&cV(this.D,this.J)};p.YBb=function(){ANc(this,!0);cV(this.D,this.J)};
p.WBb=function(){ANc(this,!1);this.Rb()||dV(this.D)};p.$Bb=function(){cV(this.D,this.J)};p.ZBb=function(){this.Rb()||dV(this.D)};p.XBb=function(){BNc(this,"")};p.L2b=function(){var a=this.Ia("waffle-assistant-answers-input-box");BNc(this,a.value);a.value=""};p.YFb=function(a){var b=this,c=a.F;BNc(this,c);var d=hLc(1,a.C,a.H,1),e=new Mi(function(){XMc(b.H,c,d,a.Fj())},300);this.qa(e);e.start();this.V.Vb(2652,this.jb)};function BNc(a,b,c){a.rU(!0);a.dispatchEvent("$d");CNc(a,b,c)}
function CNc(a,b,c){c=void 0===c?!1:c;var d=new Mi(function(){sJc(a.H.V,b,!0);var d=a.H,f=c||!1;d.Ed=f;d.Lc.$=f;d.jb.$=f},300);a.qa(d);d.start()}function yNc(a,b,c,d,e,f,h){c=c||new QF;a.J=b;a.O.Me(c,b,d,e,f,h);a.O.c$();a.setVisible(null!=b);VMc(a.H,b,c,d,e,a.Ka,f);a.Ka=!1;a.Rb()&&cV(a.D,a.J)}p.$zb=function(a){a.stopPropagation();a.preventDefault();this.Ma&&(Ps(Wu(Os(this.Ma.Te("/answers/logoptout"),v(this.xxb,this)),v(this.wxb,this)),"POST").we(),this.V.Vb(2663,this.jb))};
p.Twb=function(a){a.stopPropagation();a.preventDefault();Dp("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.xxb=function(a){a.bl()&&xNc(this,!1)};p.wxb=ba();function DNc(a,b,c){b=c||b;c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+O(Br({content:rr("INSERT CHART"),style:4,Kd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=O(Br({Kd:"waffle-autovis-lightbox-close",content:sr(""+O(Ds({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:rr("Close")},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+vr("Previous chart");d+='"';c+=O(Br({content:sr("&#10094;"),style:4,Kd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:tr(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+vr("Next chart");d+='"';c+=O(Br({content:sr("&#10095;"),style:4,Kd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:tr(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
O(a.WNb)+"</div></div></div>";return P(c)}function ENc(){return P('<div class="waffle-autovis-lightbox-chart"></div>')};function FNc(a,b,c,d,e){M.call(this,e);this.F=a;this.D=b;this.$=c;this.V=d;this.H=[];this.C=new Cr("",this.oa());this.Fa(this.C);this.O=new Cr("",this.oa());this.Fa(this.O);this.L=new Cr("",this.oa());this.Fa(this.L);this.J=new Cr("",this.oa());this.Fa(this.J)}x(FNc,M);p=FNc.prototype;p.xa=function(){FNc.ea.xa.call(this);this.Ua=N(DNc,{WNb:this.F.length})};
p.Ga=function(){FNc.ea.Ga.call(this);var a=D3a.isEnabled();GNc(this,!a);a=this.Ia("waffle-autovis-lightbox-close");this.C.hb(a);a=this.Ia("waffle-autovis-lightbox-insert");this.O.hb(a);var b=this.Ia("waffle-autovis-lightbox-previous");this.L.hb(b);b=this.Ia("waffle-autovis-lightbox-next");this.J.hb(b);HNc(this);INc(this,this.D,!1);this.getHandler().R(document.body,"focusin",this.jZb).R(this.Qa(),"keydown",this.kZb).R(Wd(),"resize",this.nZb).R(this.C,"action",this.close).R(this.O,"action",this.jwb).R(this.L,
"action",this.mZb).R(this.J,"action",this.lZb);b=new yN(this.Qa(),this.oa());zN(b);this.qa(b);a.focus()};function HNc(a){var b=a.Ia("waffle-autovis-lightbox-content"),c=a.Ia("waffle-autovis-lightbox-content-inner");a=a.Ia("waffle-autovis-lightbox-page-count");var d=Ud();a=li(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;gi(c,d,e);gi(b,d,e+a.height+35)}function GNc(a,b){Fh(a.Qa(),"waffle-autovis-lightbox-readonly",b)}
function INc(a,b,c){c&&zB("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?JNc(a,b):a.F[b]&&(J(I(),"fecpmr")?(c=iKc(a.F[b]),KNc(a,c,b)):bKc(a.F[b],function(c){if(!a.isDisposed()&&c){var d=c.Zd();d=d?d.toJSON():null;var f=new ritz.charts.model.GvizChart;f.updateChartWrapperJsonString(c.toJSON());d&&f.updateDataTableJsonString(d);KNc(a,f,b)}},!0))}function KNc(a,b,c){var d=a.Ia("waffle-autovis-lightbox-container"),e=N(ENc);d.appendChild(e);a.H[c]=e;nzc(b,e,a.$,a.V);JNc(a,c)}
function JNc(a,b){L(a.H[a.D],!1);L(a.H[b],!0);a.L.Na(0!=b);a.J.Na(b!=a.F.length-1);var c=a.Ia("waffle-autovis-lightbox-page-number");re(c,b+1);a.D=b}p.jZb=function(a){!pe(this.Qa(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};p.kZb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&INc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||LNc(this);a.stopPropagation()};
p.nZb=function(){var a=this.Ia("waffle-autovis-lightbox-container");ee(a);this.H=[];HNc(this);INc(this,this.D,!0)};p.jwb=function(){this.close();eKc(this.F[this.D],2256)};p.mZb=function(){0!=this.D&&INc(this,this.D-1,!0);0==this.D&&this.J.Qa().focus()};p.lZb=function(){LNc(this);this.D==this.F.length-1&&this.L.Qa().focus()};function LNc(a){a.D!=a.F.length-1&&INc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.xd=function(){FNc.ea.xd.call(this);var a=this.F[this.D];a&&a.Qa()&&a.Qa().focus()};function MNc(a){a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+R(a.title)+'">'+O(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=vr("Press enter to insert formula");return P(a+'"></span></div>')};function KX(a,b){M.call(this);this.C=a;this.D=b}x(KX,M);p=KX.prototype;p.xa=function(){this.Ua=N(MNc,{name:this.C,title:this.D})};p.Ga=function(){KX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-quicksum-entry-name");aX(a);this.getHandler().R(this.Qa(),"keypress",this.x2b);L(this.Qa(),!1)};p.getFunctionName=g("C");p.Pa=function(a){re(this.Ia("waffle-assistant-quicksum-entry-value"),a||"");L(this.Qa(),!!a)};p.isVisible=function(){return oi(this.Qa())};
p.x2b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new D("insert",this)))};function LX(a,b,c,d,e){M.call(this,e);this.Ka=a;this.Ba=b;this.O=c;this.J=d;this.D=a.C;this.Ha=new xw;this.$=Aj(new zj,17).build();this.V=Aj(new zj,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}x(LX,M);
LX.prototype.Ga=function(){LX.ea.Ga.call(this);this.kh(new KX(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.kh(new KX(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.kh(new KX(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.kh(new KX(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.kh(new KX(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new KLc(this.Qa(),
this.Ba,this.D,this.O);this.C.H=this.L;this.qa(this.C);this.getHandler().R(this,"insert",this.ma).R(this.C,"formula_inserted",this.va)};
LX.prototype.refresh=function(){function a(a){return k?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,l):null}if(qG(this.D)){var b=OJ(this.D),c=$H(b),d=NJ(this.D);if(Za(c,b.Rl,b)){b=[];this.F=[];for(var e=0;e<c.length;e++){var f=c[e],h=RA(d+"",f.mc(),f.kc(),f.Vc(),f.Xc());b.push(this.Ha.serialize(h));this.F.push(f)}if(c=ritz_api.RitzModelApi.quickSum(b)){L(this.Qa(),!0);d=c.count;b=c.countNumberFormat;var k=1<c.numericCount,l=k?c.valueNumberFormat:null;this.ld(0).Pa(a(c.sum));this.ld(1).Pa(a(c.average));
this.ld(2).Pa(a(c.min));this.ld(3).Pa(a(c.max));1<d?this.ld(4).Pa(ritz_api.RitzModelApi.renderNumberAsFormattedString(d,b)):L(this.Qa(),!1);if(this.C){this.C.L=[];this.H=[];for(c=0;c<this.ad();++c)d=this.ld(c),this.H.push(NNc(this,d.getFunctionName()));this.C.L=this.H}}else L(this.Qa(),!1)}else L(this.Qa(),!1)}else L(this.Qa(),!1)};
LX.prototype.ma=function(a){var b=a.target;a=this.F[0];a=new Dd(a.left,a.Vc());b=b.getFunctionName();b=NNc(this,b);a=new SL(OJ(this.D),a,b);this.O.C(a);this.J.Vb(2624,this.V)};LX.prototype.va=function(){this.J.Vb(2624,this.$)};function NNc(a,b){var c=a.Ka.O.D;a=Wa(a.F,function(a){return uF(a)});return"="+b+"("+a.join(c)+")"};function ONc(a,b,c){E.call(this);this.C=kdb(XF.getInstance(),a,b,c);this.D=Bf()}x(ONc,E);ONc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!$a(c,function(a){return A_a(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].lh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&Qsc(this.C),this.D=PNc(),this.D.addCallback(function(){return Itc(d.C,b,!0)}))};ONc.prototype.Mf=function(a){this.C.Mf(a)};
function PNc(){var a=null,b=new uf(function(){null===a||Ki(a)});a=Ji(function(){b.Nb()});return b};function MX(a,b,c,d,e,f,h){aV.call(this,h);this.Fe=a;this.qd=b.C;this.wg=YF(b);this.Ba=c;this.Se=d;this.H=f;this.kf=e;this.jb=new LX(b,c,d,f,this.oa());this.Fa(this.jb);this.V=new YU(!1,"#4285f4");this.Fa(this.V);this.O=null;this.hd=this.Wc=!1;this.Sb=!0;this.Hb=qn();this.Bb=this.xb="";this.zc=null;this.Ra=Aj(new zj,10).build()}x(MX,aV);p=MX.prototype;p.xa=function(){MX.ea.xa.call(this);this.Ua=N(QNc,{lN:this.wg})};
p.Ga=function(){MX.ea.Ga.call(this);var a=this.Ia("waffle-assistant-quicksum-panel");this.jb.hb(a);a=this.Ia("waffle-assistant-spinner-container");this.V.render(a);a=this.Fe.C;this.getHandler().R(this,"close-sidebar",this.ema).R(a,"recommender-load-started",this.Tla).R(a,"recommender-load-ended",this.Sla).R(a,"recommender-calc-started",this.sla).R(a,"recommender-calc-ended",this.rla).R(this.Ia("waffle-assistant-scroll-pane"),"scroll",Otc(this.ica,10,this));a=D3a.isEnabled();this.hca(!a)};
p.resize=function(){var a=this.Ia("waffle-assistant-sidepane-content");a=li(a).height;var b=this.Ia("waffle-assistant-spinner-container");Sh(b,"margin-top",a/2-16+"px");this.ica()};p.Mf=sa;function RNc(a,b){var c=SNc(a);0!=c.length&&(C(a.O),c=c.filter(function(a){return a instanceof gX}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new FNc(c,b,a.kf,a.H,a.oa()),a.O.render(),a.qa(a.O),GNc(a.O,a.hd)))}
p.hca=function(a){this.hd=a;Fh(this.Qa(),"waffle-assistant-readonly",a);var b=this.jb;b.L=a;b.C&&(b.C.H=a);Fh(b.Qa(),"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&GNc(this.O,a)};
p.setVisible=function(a){var b=this.isVisible();MX.ea.setVisible.call(this,a);if(a&&!b){var c=Dtc(this.Fe.C,a);c?(b=new YIc,G(b,1,KA(c,"r")),G(b,2,KA(c,"c")),G(b,3,c.lh()),c=new uj,Tf(c,4,b),b=Dj(Ej(this.Ra),c).build()):b=this.Ra;this.Bb=rn(this.Hb,$A.sva,!1,b);ZU(this.V,!0);TNc(this)}a||UNc(this,!0)};p.Tla=function(){this.isVisible()&&(UNc(this,!0),ZU(this.V,!0))};p.Sla=function(){this.isVisible()&&ZU(this.V,!1)};
p.sla=function(a){this.isVisible()&&(this.H.C(2775,this.Ra),UNc(this,void 0,a.C,a.F),VNc(this)||ZU(this.V,!0),TNc(this),this.Sb=!1)};
p.rla=function(a){if(this.isVisible()){this.H.C(2776,this.Ra);var b=a.C;0<b.length&&(this.xb=rn(this.Hb,$A.qva));UNc(this,!1);ZU(this.V,!1);a=a.F;for(var c=ha(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ha(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=uw(h,1);d.hW(k)&&e.push(h)}0<e.length?d.FN(e,a):d.qU(!0)}b=ha(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==uw(a,1)){this.b4();this.Ka=V(a,12);this.ma=gT(a);this.Ma=V(a,11);WNc(this);a=this.ma;c=!1;for(d=this.Ta.length-
1;0<=d;d--)N_a(this.Ta[d],a)&&(c=!0,this.Ta.splice(d,1));this.Ta.push(a);a=c;2!=this.Ka||a||XNc(this,!0)}b=SNc(this);0<b.length&&this.Wc&&(b[b.length-1].Lc=!0);this.Wc=!1;TNc(this);YNc(this);this.ica()}};function TNc(a){var b=VNc(a),c=oi(a.Ia("waffle-assistant-quicksum-panel")),d=a.V.Rb();b=b||c||d;a=a.Ia("waffle-assistant-empty-list");L(a,!b)}p.Gc=sa;p.oqa=sa;p.Ld=g("hd");p.ema=sa;
p.ILb=function(){""!=this.xb&&(sn(this.Hb,this.xb),this.xb="");""!=this.Bb&&(sn(this.Hb,this.Bb),this.Bb="");this.zc=Fa();this.Sb||(this.H.Vb(2777,this.Ra),this.Sb=!0)};function QNc(a,b,c){b=c||b;a=a||{};c=P;var d=sr('<div class="waffle-assistant-replaceable-title">'+ZNc(null,b)+"</div>");var e=e=a||{};var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+O(N1b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=e.lN?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=P(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');e=P('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit'+
('</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(O(gV(qr({title:d,Tk:sr(""+e),id:rr("autovis"),OH:rr("waffle-assistant-sidepanel"),
uba:rr("waffle-assistant-title"),DW:rr("waffle-assistant-sidepane-content")},a),b)))}function ZNc(){return P('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+O(N1b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+O("Explore")+"</div></div>")};function $Nc(a,b,c){a=P;b=""+O(Br({Kd:"waffle-assistant-datavalidation-apply-button",content:rr("Apply"),style:4},c||b));b=P(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function aOc(a){return P('<div class="waffle-assistant-datavalidation-detail-chip">'+O(a.k9a)+"</div>")};function bOc(a,b,c,d){dX.call(this,a,d);this.D=new bV(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.D);this.C=new Cr("",this.oa());this.Fa(this.C);this.F=gT(a);this.J=c}q(bOc,dX);p=bOc.prototype;p.xa=function(){dX.prototype.xa.call(this);eX(this).appendChild(N($Nc))};
p.Ga=function(){dX.prototype.Ga.call(this);var a=this.Ia("waffle-assistant-datavalidation-apply-button");this.C.hb(a);aX(a,"Apply data validation");this.getHandler().R(this.C,"action",this.znb).R(this.Qa(),"mouseenter",this.hMb).R(this.Qa(),"mouseleave",this.iMb);a=new yg;Csc(a,yAc(gx(V(V(this.H,13),3))));var b=new wg;Tf(b,58,a);a=Bj(Aj(new zj,10),b).build();this.J.C(35577,a)};
p.wy=function(a){var b=uF(WA(this.F)),c=V(V(this.H,13),3);switch(gx(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=hx(c).map(function(a){return V(a.Do().La(),2)});break;case 1:d="Numeric validation";c=["Greater than "+V(hx(c)[0].Do().La(),3)];break;case 7:d="Numeric validation";c=hx(c);c=["Between "+(V(c[0].Do().La(),3)+(" and "+V(c[1].Do().La(),3)))];
break;case 5:d="Numeric validation";c=hx(c);c=["Equal to "+V(c[0].Do().La(),3)];break;default:d="unrecognized",c=[]}var e=new Bp,f=e.text(d)+(" for "+(e.le("SPAN".toString(),{UE:"waffle-assistant-datavalidation-range"})+e.text(b)+e.ue("SPAN".toString())));sd(this.Ia("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Ia("waffle-assistant-datavalidation-details");z(c,function(a){a=N(aOc,{k9a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));
yh(this.Qa(),b);a()};p.zA=ba();p.rz=n("assistantDataValidationFeedback");p.XB=n(35551);p.WB=n(35550);p.znb=function(){this.dispatchEvent(new bX("Td",this,35549))};p.hMb=function(){cV(this.D,pT(this.F))};p.iMb=function(){dV(this.D)};function NX(a,b,c,d){Js.call(this,a,b,c,d,void 0,void 0,!0)}x(NX,Js);NX.prototype.xa=function(){NX.ea.xa.call(this);Bh(this.Qa(),"waffle-assistant-toast");Bh(this.Ia("docs-ui-toast-content"),"waffle-assistant-toast-content")};NX.prototype.Bw=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=yi(this,b);NX.ea.Bw.call(this,a,b,c)};NX.prototype.og=function(a,b,c,d){this.Bw(a,b,d);a=Ai(this,b);this.getHandler().Cg(a,ff,v(function(){this.setVisible(!1);c()},this))};function cOc(){A.call(this);this.C=null}x(cOc,A);cOc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function $Lc(a,b,c,d){a.clear();a.C=new NX(b,c,!1,5E3);a.C.render();d&&a.C.og("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}cOc.prototype.Ea=function(){cOc.ea.Ea.call(this);this.clear()};function dOc(a,b,c,d){jX.call(this,1,b,a,d);this.D=c}q(dOc,jX);p=dOc.prototype;p.getTitle=n("Data Validation");p.hW=function(a){return 6==a};p.lP=function(a){var b=V(a,1);switch(b){case 6:return new bOc(a,this.D,this.V,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};p.JN=function(a){jX.prototype.JN.call(this,a);this.setVisible(!a)};p.d2=function(a){return this.Ld()?(this.setVisible(!1),a):jX.prototype.d2.call(this,a)};p.b2=n(4);function eOc(a,b,c){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for '+('<span class="waffle-assistant-banding-range"></span></div>'+fOc(c||b)+"</div>");return P(a)}
function gOc(a,b,c){return P('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+fOc(c||b)+"</div>")}function fOc(a){a=""+O(Br({Kd:"waffle-assistant-formatting-edit-button",content:rr("Edit"),style:4},a));return P(a)};function hOc(a,b,c){dX.call(this,a,c);a=Wa(tw(this.H,7),AAc);this.C=new FAc(!1,a,7);this.Fa(this.C);this.J=new Cr("",this.oa());this.Fa(this.J);this.L=b;this.F=!1;this.D=-1}x(hOc,dX);var iOc={nZa:"waffle-assistant-banding-color-picker-container",Yca:"waffle-assistant-formatting-edit-button",OI:"waffle-assistant-banding-range"};p=hOc.prototype;p.xa=function(){hOc.ea.xa.call(this);eX(this).appendChild(N(eOc))};
p.Ga=function(){hOc.ea.Ga.call(this);this.getHandler().R(this.J,"action",this.Tsb).R(this.C,"wd",this.bob);this.L.C(2768)};p.wy=function(a){var b=this.Ia(iOc.nZa);this.C.render(b);GAc(this.C);b=this.Ia(iOc.OI);var c=gT(this.H),d=WA(c);re(b,uF(d));jOc(this,c);b=this.Ia(iOc.Yca);this.J.hb(b);a()};p.zA=function(){yh(this.Qa(),"Suggested alternating background colors");lk(this.C,"Choose a color scheme")};p.rz=n("assistantBandingFeedback");p.XB=n(2672);p.WB=n(2671);
p.Tsb=function(a){xB.dispatchEvent({type:"show-banding-pane-recommendation",USa:this.H,S8a:IAc(this.C)});a.stopPropagation()};p.bob=function(a){if(!this.F&&HAc(this.C)){var b=this.D;this.D=this.C.Wg();this.D==b?this.dispatchEvent(new bX("Zd",this,2797)):this.dispatchEvent(new bX("Rd",this,2673));a.stopPropagation()}};
function jOc(a,b){a.F=!0;var c=b.Ab();b=WA(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.mc(),b.kc(),b.Vc(),b.Xc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new xw).Ad(Ix.Ca(),c),c=AAc(c)):c=null;c?(c=JAc(a.C,c),IK(a.C,c?c.getElement():null)):IK(a.C,null);a.D=a.C.Wg();a.F=!1};function kOc(a,b){dX.call(this,a,b);this.C=new Cr("",this.oa());this.Fa(this.C);this.zc=tw(a,6)}x(kOc,dX);var OX={Yca:"waffle-assistant-formatting-edit-button",q0a:"waffle-assistant-conditionalformat-format-preview",w3a:"waffle-assistant-conditionalformat-rule-holder",aO:"waffle-assistant-conditionalformat-description",n2a:"one-rule",X4a:"two-rules",K4a:"three-rules",S2a:"waffle-assistant-conditionalformat-format-preview-label"};p=kOc.prototype;p.xa=function(){kOc.ea.xa.call(this);eX(this).appendChild(N(gOc))};
p.Ga=function(){kOc.ea.Ga.call(this);var a=this.Ia(OX.Yca);this.C.hb(a);aX(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.xnb)};p.wy=function(a){re(this.Ia(OX.aO),uw(this.H,3));var b=this.Ia(OX.w3a),c=new lOc(this,this.oa());this.Fa(c);c.hb(b);aX(b,"Apply conditional format rules");a()};p.zA=sa;p.rz=n("assistantConditionalFormatFeedback");p.XB=n(2630);p.WB=n(2629);
p.xnb=function(){this.dispatchEvent(new bX("Sd",this,2563));this.dispatchEvent(new bX("Vd",this,2670,void 0,void 0,WA(V(this.zc[0],1,0))));H2a()};function lOc(a,b){jk.call(this,void 0,void 0,b);this.C=a}x(lOc,jk);
lOc.prototype.Yc=function(a){lOc.ea.Yc.call(this,a);var b=this.C.zc;switch(b.length){case 0:break;case 1:var c=OX.n2a;break;case 2:case 4:c=OX.X4a;break;default:c=OX.K4a}for(var d=0;d<b.length;d++){var e=b[d],f=Xd("DIV");Ch(f,[OX.q0a,c]);var h=Xd("DIV");Bh(h,OX.S2a);f.appendChild(h);re(h,"123");if(ow(e,2)){var k=V(V(e,2),1);switch(gx(kx(k))){case 9:case 13:k=hx(kx(k))[0];var l=tw(e,1)[0];re(h,lH(k,uw(l,1),uw(l,2),uw(l,4)))}}Tuc(e,f);a.appendChild(f)}};
lOc.prototype.gh=function(){var a=this.C;a.dispatchEvent(new bX("Sd",a,2563));return!0};function mOc(a,b,c){jX.call(this,2,b,a,c)}x(mOc,jX);p=mOc.prototype;p.getTitle=n("Formatting");p.hW=function(a){return J(I(),"feecfr")&&2==a||4==a};p.lP=function(a){var b=V(a,1);switch(b){case 2:return new kOc(a,this.oa());case 4:return a=new hOc(a,this.V,this.oa()),this.getHandler().R(a,"Rd",this.kWb).R(a,"Zd",this.RIb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.kWb=function(a){$Lc(this.Ta,"Alternating colors applied",this.oa(),v(this.cob,this,a.C))};p.RIb=function(){this.Ta.clear()};
p.cob=function(a){this.dispatchEvent(new bX("de",a,2796))};p.JN=function(a){mOc.ea.JN.call(this,a);this.setVisible(!a)};p.d2=function(a){return this.Ld()?(this.setVisible(!1),a):mOc.ea.d2.call(this,a)};p.b2=n(3);function nOc(a,b,c,d,e,f,h,k,l,m,r){dX.call(this,l,r);this.Oa=b;this.Ta=c;this.Ba=d;this.Wa=m;this.V=e;this.va=h;this.F=new lr("",new YW,this.oa());this.Fa(this.F);this.$=new lr("",new YW,this.oa());this.Fa(this.$);this.C=this.J=this.D=null;this.Ma=this.Ta.O.C;this.L=Aj(new zj,66).build();this.ma=new bV(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.ma);this.jb=tw(l,4)}q(nOc,dX);p=nOc.prototype;p.KA=n(!0);
p.xa=function(){dX.prototype.xa.call(this);eX(this).appendChild(N($Ic));fX(this).appendChild(N(aJc))};p.Ga=function(){dX.prototype.Ga.call(this);var a=V(this.H,5),b=Xzc(this.va,a),c=OJ(this.Oa).$b();this.J=new $zc(b,a,this.Ma,this.Wa,c,this.Ba);a=this.Ia("waffle-assistant-insert-pivottable-button");this.F.hb(a);aX(a,"Insert Pivot Table");a=this.Ia("waffle-assistant-zoom-button");this.$.hb(a);aX(a,"Preview Pivot Table");this.getHandler().R(this.F,"action",this.jMb).R(this.$,"action",this.aQa);this.nt(this.Ld())};
p.wy=function(a){var b=this.oa();b.Re(this.Ia("waffle-assistant-answercard-interpret"),uw(this.H,3));this.C=b.xa("CANVAS","waffle-pivottable-pivot-canvas");b.wk(this.C,!0);yh(this.C,"Pivot table canvas");var c=this.Ia("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);this.getHandler().Cg(this.C,ff,this.aQa);bAc(this.J,this.C);a()};
p.nt=function(a){dX.prototype.nt.call(this,a);if(this.F&&this.Qb()){this.F.setVisible(!a);var b=this.oa().Ia("waffle-assistant-button-separator",fX(this));L(b,!a)}this.D&&IIc(this.D,this.Ld())};p.zA=function(){yh(this.Qa(),"Suggested Pivot Table-"+uw(this.H,3))};p.rz=n("assistantPivotTableFeedback");p.XB=n(2632);p.WB=n(2631);p.jMb=function(){aAc(this.J);this.dispatchEvent("close-sidebar");this.V.C(35619,this.L)};
p.aQa=function(){this.V.C(35620,this.L);this.getHandler().Qc(this.D,"od",this.$Pa).Qc(this.D,"pd",this.ZPa);C(this.D);this.D=new dAc(this.J,uw(this.H,3),this.V,this.L,35621,this.oa());this.getHandler().R(this.D,"od",this.$Pa).R(this.D,"pd",this.ZPa);this.D.render();this.qa(this.D);IIc(this.D,this.Ld())};p.$Pa=function(){this.C&&this.C.focus()};p.ZPa=function(){this.dispatchEvent("close-sidebar")};p.pL=function(){dX.prototype.pL.call(this);HIc(this.ma,qT(this.jb))};
p.sG=function(){dX.prototype.sG.call(this);dV(this.ma)};function oOc(a,b,c,d,e,f,h,k,l){jX.call(this,1,f,e,l);this.Ba=d;this.D=b;this.Ha=c;this.H=h;this.Ka=k;this.J=Aj(new zj,10).build();a=new a3b(a,!0,!0);this.O=new Wzc(a,this.D);this.F=null}q(oOc,jX);p=oOc.prototype;p.getTitle=n("Pivot Table");p.hW=function(a){return 1==a};p.lP=function(a){var b=V(a,1);switch(b){case 1:return new nOc(this.F,this.D,this.Ha,this.Ba,this.V,this.H,this.O,this.J,a,this.Ka,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};
p.FN=function(a,b){V(a[0],5)&&(this.F=b?b:null,jX.prototype.FN.call(this,a,b))};p.b2=n(5);function PX(a,b,c,d,e){M.call(this);this.O=a;this.Ma=b;this.ma=c;this.H=d;this.D=e}q(PX,M);PX.prototype.getTableRange=g("ma");PX.prototype.e$=function(a,b,c){this.ma=a;this.H=b;this.D=c};PX.prototype.Ga=function(){M.prototype.Ga.call(this);this.getHandler().R(this.O.C,"Ba",this.Oa)};PX.prototype.Oa=function(){this.Ma.Wb()};function pOc(a,b,c){bX.call(this,"ae",null,2859);this.Ba=a;this.V=b;this.F=c}q(pOc,bX);function qOc(a,b){A.call(this);this.F=a;this.H=b;this.C=new bV(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.qa(this.C);this.D=new bV(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.qa(this.D)}q(qOc,A);qOc.prototype.Ea=function(){dV(this.C);dV(this.D);A.prototype.Ea.call(this)};
function rOc(a,b,c,d,e,f){pN(b);var h=WA(d);h=new wA(h.mc(),h.kc(),Math.min(h.Vc(),h.mc()+6),Math.min(h.Xc(),h.kc()+6));var k=oN(b),l=pG(a.F).C,m=mN(l,new wv(h.mc(),h.Vc()),"r",!0,!1,!0,!0)-1,r=mN(l,new wv(h.kc(),h.Xc()),"c",!0,!1,!0,!0)-1;l.wc()&&--r;m=Math.min(200,m);r=Math.min(c.offsetWidth-2,r);qN(b,k,r,m);c=XJc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.mc();k=d.kc();switch(e){case 0:h=Math.min(d.Vc(),d.mc()+f);break;case 1:k=Math.min(d.Xc(),d.kc()+f)}d=RA(d.Ab(),h,k,d.Vc(),d.Xc());cV(b,pT(d));cV(a.D,
pT(c))};function sOc(a){var b=a.mSa,c=a.lSa,d=a.LQa;a=a.SAa;return P('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+R(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+O(b)+'</div></div><div class="waffle-tables-popup-content">'+O(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
O(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+O(a)+"</div></div></div></div>")}
function tOc(){var a=rr("Edit data range");var b=P('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+sOc({mSa:a,lSa:sr(""+b),LQa:rr("Update"),SAa:rr("Cancel")});return P(a)}function uOc(){var a=""+sOc({mSa:rr("Improve suggestions"),lSa:sr('<div class="waffle-tables-popup-header-message"></div>'),LQa:rr("No"),SAa:rr("Yes")});return P(a)}function vOc(a){a='For <span class="waffle-assistant-table-bar-range">'+(O(a.WH)+"</span>");return P(a)}
function wOc(a){a='Is <span class="waffle-assistant-table-first-header">'+(O(a.xL)+"</span> a header row, containing titles that describe the columns below?");return P(a)};function xOc(a,b,c,d,e,f,h){PX.call(this,a,F8a,d,e,f);this.C=(new Vk).build();this.qa(this.C);this.J=new lr("",new YW,this.oa());this.Fa(this.J);kj(this.C,this.J,G8a);this.F=new lr("",new YW,this.oa());this.Fa(this.F);kj(this.C,this.F,F8a);this.L=new qOc(b,c);this.qa(this.L);this.Yb=new Se(this);this.qa(this.Yb);this.$=h}q(xOc,PX);xOc.prototype.xa=function(){this.Ua=N(uOc)};
xOc.prototype.Ga=function(){PX.prototype.Ga.call(this);this.J.hb(this.Ia("waffle-tables-popup-done"));this.F.hb(this.Ia("waffle-tables-popup-cancel"));var a=XJc(this.getTableRange(),this.D,1);a=uF(WA(a));a=N(wOc,{xL:a});this.Ia("waffle-tables-popup-header-message").appendChild(a);this.Yb.subscribe(G8a,"action",this.va).subscribe(F8a,"action",this.V);a=this.Ia("waffle-assistant-table-canvas");var b=this.Ia("waffle-assistant-canvas-container");rOc(this.L,a,b,this.getTableRange(),this.D,this.H);a=this.Ia("waffle-tables-popup");
Fh(a,"waffle-tables-popup-answers-enabled",this.$);b=new yN(a,this.oa());this.qa(b);zN(b);a.focus()};xOc.prototype.V=function(){this.dispatchEvent("be")};xOc.prototype.va=function(){var a=WA(this.getTableRange());switch(this.D){case 0:a=xA(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=xA(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=uF(a);this.dispatchEvent(new pOc(a,this.H-1,this.D));this.dispatchEvent("be")};function yOc(a,b,c,d,e,f,h,k,l){PX.call(this,a,B8a,d,e,f);var m=this;this.Ra=b;this.Ka=d;this.Wa=e;this.jb=f;a=WA(d);this.F=uF(a);this.Ha=new qOc(b,c);this.qa(this.Ha);this.C=null;this.va=h;this.J=(new Vk).build();this.qa(this.J);this.$=new lr("",new YW,this.oa());this.Fa(this.$);kj(this.J,this.$,D8a);this.V=new lr("",new YW,this.oa());this.Fa(this.V);kj(this.J,this.V,B8a);b=this.O.C.C.ge();this.L=new QU(this.Ra,function(a,b,c){zOc(m,a,b,c)},!1,"e.g., A2:D5",!0,b,this.oa());this.Fa(this.L);this.Ba=
null;this.Yb=new Se(this);this.qa(this.Yb);this.Db=k;this.Ta=l}q(yOc,PX);p=yOc.prototype;p.xa=function(){this.Ua=N(tOc)};
p.Ga=function(){PX.prototype.Ga.call(this);this.$.hb(this.Ia("waffle-tables-popup-done"));this.V.hb(this.Ia("waffle-tables-popup-cancel"));this.L.render(this.Ia("waffle-assistant-tables-data-range-wrapper"));var a=this.Ia("waffle-range-selection-input");uh(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.oMb).R(a,"keyup",this.pMb).R(a,"focusout",this.wGb).R(this.L,"change",this.qMb);this.Yb.subscribe(D8a,"action",this.rMb).subscribe(B8a,"action",this.Aob);
AOc(this);a=this.Ia("waffle-tables-popup");Fh(a,"waffle-tables-popup-answers-enabled",this.Ta);var b=new yN(a,this.oa());this.qa(b);zN(b);a.focus()};p.Ea=function(){C(this.Ba);PX.prototype.Ea.call(this)};function zOc(a,b,c,d){hT(a.Db,null,b,c,d,!1,void 0,function(b){a.Ba=b})}function BOc(a){var b=a.Ia("waffle-assistant-table-canvas"),c=a.Ia("waffle-assistant-canvas-container");rOc(a.Ha,b,c,a.getTableRange(),a.D,a.H)}p.Aob=function(){this.dispatchEvent("be")};
p.rMb=function(){var a=!pbb.test(this.F);L(this.yb("waffle-assistant-tables-range-error"),a);Fh(this.Ia("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Wa!=this.H||this.jb!=this.D;var b=!BT(this.Ka,this.getTableRange());if(a||b)a&&this.va.Vb(35506),b&&this.va.Vb(35507),this.dispatchEvent(new pOc(this.F,this.H,this.D));this.dispatchEvent("be")}};
function AOc(a){var b=a.Ia("waffle-range-selection-input"),c=WA(a.Ka);a.F=uF(c);b.value=a.F;COc(a);BOc(a)}p.e$=function(a,b,c){PX.prototype.e$.call(this,a,b,c);BOc(this)};function DOc(a){var b=OJ(a.O.C),c=b.$b();b=tbb(a.F,b);null!=b&&(c=UA(b,c),a.e$(c,EOc(a,c),a.D),COc(a))}function EOc(a,b){b=FOc(b,a.D);return a.H>b?b:a.H}function FOc(a,b){a=0==b?a.Vc()-uw(a,2):a.Xc()-uw(a,4);return Math.min(a-1,3)}
function COc(a){C(a.C);a.C=new sO;a.Fa(a.C);kj(a.J,a.C,C8a);Esc(a.C,jV.getInstance());a.C.render(a.Ia("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.fvb);for(var b=FOc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new Lt("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.yd(new Bk(d))}c=FOc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new Lt("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.yd(new Bk(e))}c=a.H;a.C.jf(0==a.D?c:c+b+1);uh(a.C.Qa(),"label","Headers")}p.wGb=function(){var a=this.Ia("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,DOc(this))};p.qMb=function(){var a=this.L.La();this.F=a;var b=this.Ia("waffle-range-selection-input");b.value=a;b.select();DOc(this)};
p.oMb=function(a){var b=this.Ia("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;DOc(this);D8a.Wb();break;case 27:a.stopPropagation(),a.preventDefault(),AOc(this),B8a.Wb()}};p.pMb=function(){this.F=this.Ia("waffle-range-selection-input").value;DOc(this)};p.fvb=function(){var a=this.C.Wg(),b=FOc(this.getTableRange(),0);this.e$(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function QX(a,b,c,d,e,f,h,k,l,m,r,u){MX.call(this,a,b,c,e,d,f,u);this.Le=r;this.Ud=h;this.Oa=b;this.Wa=new M(this.oa());this.Fa(this.Wa);this.va=new cOc;this.qa(this.va);this.D=[];this.F=null;this.Cb=new Cr("",u,4);fj(this.Cb,2,!1);this.Fa(this.Cb);this.re=k;this.jh=l;this.Db=m;this.ma=null;this.Ka=0;this.Ma=null;this.Zb=new lr("",new YW,this.oa());this.Fa(this.Zb);this.Lc=new M(this.oa());this.Fa(this.Lc);this.Ed=(new Vk).build();this.qa(this.Ed);kj(this.Ed,this.Zb,E8a);this.$=this.J=null;this.Ta=
[]}x(QX,MX);var RX={gE:"waffle-assistant-scroll-pane-feature-content",ndc:"waffle-assistant-empty-list",e0a:"waffle-assistant-features",j1a:"waffle-assistant-empty-list-learn-more",Pda:"waffle-assistant-expanded-panel",xxa:"waffle-assistant-replaceable-title",C3a:"waffle-assistant-scroll-pane",D4a:"waffle-assistant-sidepane-tables-range",E4a:"waffle-sidebar-tables-bar",Vya:"waffle-assistant-tables-scroll-pane",F4a:"waffle-assistant-tables-edit-range-button",zw:"waffle-assistant-title"},GOc={defaultHelpArticleId:"6280499"};
p=QX.prototype;
p.Ga=function(){var a=this;QX.ea.Ga.call(this);this.Wa.hb(this.Ia(RX.Pda));aX(this.C.Qa(),"Close");this.Lc.hb(this.Ia(RX.D4a));WNc(this);this.Zb.hb(this.Ia(RX.F4a));if(YF(this.Oa)){var b=new JX(this.Ud,this.Ba,this.qd,this.Se,this.H,this.va,this.Oa,this.jh,this.Db,this.Le,this.oa());this.Fa(b);this.D.push(b)}b=new mOc(this.H,this.va,this.oa());this.Fa(b);this.D.push(b);J(I(),"feedvs")&&(b=new dOc(this.H,this.va,this.Ba,this.oa()),this.Fa(b),this.D.push(b));J(I(),"feepts")&&(b=new oOc(this.Ud,this.qd,
this.Oa,this.Se,this.H,this.va,this.Ba,this.Le,this.oa()),this.Fa(b),this.D.push(b));b=new kX(this.qd,this.Ba,this.kf,this.H,this.va,this.oa());this.Fa(b);this.D.push(b);var c=this.Ia(RX.e0a);z(this.D,function(b){b.render(c);a.Wa.Fa(b.C,!0)});this.Cb.hb(this.Ia(RX.j1a));this.getHandler().R(this.Cb,"action",this.X2b).R(this,"be",this.b4).R(this,"ae",this.Y2b);HOc(this)};p.Y2b=function(){var a=IOc(this);a&&(a.Ka=!0)};p.X2b=function(){K.Vn.Wb(GOc)};function YNc(a){z(a.D,function(a){BKc(a)})}
function UNc(a,b,c,d){z(a.D,function(a){a.qU(b,c,d)})}function VNc(a){return!!$a(a.D,function(a){return a.tma()})}p.ica=function(){var a=this,b=this.Ia("waffle-assistant-scroll-pane").scrollTop+li(this.Ia("waffle-assistant-sidepane-content")).height;z(this.D,function(c){a.F&&a.F!=c||(c instanceof kX&&a.getHandler().Sc(c,"Wd",a.ILb),b=c.d2(b))})};function SNc(a){if(a.F)return a.F.C.C;var b=[];z(a.D,function(a){mb(b,AKc(a))});return b}p.hca=function(a){QX.ea.hca.call(this,a);HOc(this)};
p.Mf=function(a){z(this.D,function(b){b.Mf(a)})};p.oqa=function(){var a=this.Ia(RX.xxa),b=this.Ia(RX.zw);ki(b,li(a).height)};
p.Gc=function(){var a=this,b=this.Ia(RX.gE),c=this.Ia(RX.xxa),d=this.Wa.Qa();if(this.F)this.F.C.setVisible(!1),this.F.rU(!1),this.F=null,L(d,!1),L(b,!0),gr(c,ZNc),vh(c,"label"),this.resize(),zB("Explore Opened");else if(this.F=$a(this.D,function(a){return a.Rb()}))L(b,!1),L(d,!0),this.F.C.setVisible(!0),CKc(this.F,c),yh(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",zB(b);this.oqa();b=new Mi(function(){var b=Qt;b&&b.dispatchEvent("resize");a.ica()},300);this.qa(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();QX.ea.setVisible.call(this,a);a&&!b&&JOc(this,!0);a||this.va.clear()};p.ema=function(){QX.ea.ema.call(this);this.F&&this.Gc();this.b4()};p.Tla=function(){QX.ea.Tla.call(this);JOc(this,!0)};p.Sla=function(){QX.ea.Sla.call(this);JOc(this,!1)};p.sla=function(a){QX.ea.sla.call(this,a);JOc(this,!0,a.C)};p.rla=function(a){QX.ea.rla.call(this,a);JOc(this,!1)};
function KOc(a,b){var c=IOc(a);b?(Oec(a.J),a.J=new yOc(a.Oa,a.Ba,a.re,a.ma,a.Ka,a.Ma,a.H,a.Db,null!=c&&c.Rb()),a.Fa(a.J),a.J.render(a.getElement())):a.J&&(a.removeChild(a.J,!0),C(a.J),a.J=null);c&&zNc(c,b)}function XNc(a,b){if(1!=a.Ma){var c=IOc(a);b?(a.$=new xOc(a.Oa,a.Ba,a.re,a.ma,a.Ka,a.Ma,null!=c&&c.Rb()),a.Fa(a.$),a.$.render(a.getElement())):a.$&&(a.removeChild(a.$,!0),C(a.$),a.$=null);c&&zNc(c,b)}}function HOc(a){z(a.D,function(b){b.JN(a.Ld())})}
function IOc(a){return(a=$a(a.D,function(a){return a instanceof JX}))&&a}function LOc(a){return(a=$a(a.D,function(a){return a instanceof oOc}))&&a}function JOc(a,b,c){z(a.D,function(a){a.MXa(b,c)});b&&(a.ma=null,a.Ka=0,a.Ma=null,a.b4(),WNc(a))}function WNc(a){var b=a.Ia(RX.E4a),c=a.Ia(RX.C3a);if(a.ma){var d=WA(a.ma);d=uF(d);d=N(vOc,{WH:d});a=a.Lc.Ib();ee(a);a.appendChild(d);L(b,!0);Bh(c,RX.Vya)}else L(b,!1),Dh(c,RX.Vya)}p.b4=function(){KOc(this,!1);XNc(this,!1)};function MOc(a,b,c){b=c||b;a=a||{};if(a.JMa){c=a.JMa;var d='<div class="docs-explore-promo-header">'+O(null!=c?c:"")+"</div>"}else d="";var e=a.h9a;c=P;b='<div class="docs-explore-promo-base docs-ui-unprintable '+R(a.ag)+'"><div class="docs-explore-promo-content">'+d+'<div class="docs-explore-promo-description">'+O(null!=e?e:"")+'<div class="docs-explore-promo-buttons">'+(a.GBa?O(Br({Kd:"docs-explore-promo-button docs-explore-promo-continue-button",content:sr(""+O(a.GBa)),style:4},b)):"")+(a.zCa?
O(Br({Kd:"docs-explore-promo-button docs-explore-promo-close-button",content:sr(""+O(a.zCa)),style:4},b)):"")+"</div></div></div>";a=a.gNa?P('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+O(N1b({color:a.gNa,iconSize:"32"}))+"</div></div>"):"";return c(b+a+"</div>")};function NOc(a,b){M.call(this,b);this.F=new Cr("",b);this.Fa(this.F);this.C=new Cr("",b);this.Fa(this.C);this.D=new Cr("",b);fj(this.D,2,!1);this.Fa(this.D);this.H=a;Kaa([K.$ca,K.bda,K.pva],!0)}x(NOc,M);p=NOc.prototype;p.xa=function(){this.Ua=N(MOc,this.H)};
p.Ga=function(){NOc.ea.Ga.call(this);var a=this.yb("docs-explore-promo-continue-button");a&&this.F.hb(a);(a=this.yb("docs-explore-promo-close-button"))&&this.C.hb(a);(a=this.yb("docs-explore-promo-icon"))&&this.D.hb(a);this.getHandler().R(this.F,"action",this.vDa).R(this.C,"action",this.G$a).R(this.D,"action",this.yvb)};p.show=function(a){K.pva.Wb();this.render(a)};p.vDa=function(a){K.$ca.Wb();a.stopPropagation()};p.G$a=function(a){K.bda.Wb();a.stopPropagation()};p.yvb=function(a){this.vDa(a)};function OOc(a){NOc.call(this,{ag:"waffle-assistant-entry-promo",JMa:"More insights, instantly",h9a:"Now, Sheets Explore uses the power of pivot tables to help you better understand your data",GBa:"Check it out",zCa:"Dismiss",gNa:"#0F9D58"},a)}q(OOc,NOc);function POc(a,b,c,d,e,f,h,k,l,m,r,u){var w=this;oV.call(this,b,h);this.Ka=a;this.C=b;this.O=c;this.Ha=d;this.Zb=e;this.L=f;this.Wa=k;this.H=c.C;this.xb=this.Ra=!1;this.F=null;this.ma=l;this.Db=m;this.Bd=r;this.Sb=u;this.Pc=new xw;this.Ta=this.$=this.J=null;a=new WF;W(a,18,!0);W(a,12,lB);this.Hb=new YAc(a);this.Ba=this.va=null;QOc(this);C3a.Na(!0);a=new yg;G(a,6,ROc());b=new wg;Tf(b,58,a);this.Ma=Aj(Bj(new zj,b),10).build();qn();this.Oa=-1;"true"==Dl(Fl(mB("win").location.href),"rEPP")&&RJ(this.Wa,
"ritz-DisplayExplorePivotPromoV2",!0);a=new Mi(function(){return SOc(w,!1)},100);this.qa(a);a.start()}x(POc,oV);
function QOc(a){var b=DH(a.Zb);a.Ja.R(a.Ha,"selectionChange",a.a3b).R(a.H,"Ba",a.Z2b).R(b,"Xa",a.iyb).R(a.C,"Td",a.Bnb).R(a.C,"Sd",a.Anb).R(a.C,"Rd",a.ynb).R(a.C,"Zd",a.ICb).R(a.C,"Vd",a.Rob).R(a.C,"Xd",a.$2b).R(a.C,"Yd",a.kwb).R(a.C,"ce",a.JFb).R(a.C,"$d",a.gEb).R(a.C,"Ud",a.Znb).R(a.C,"de",a.c3b).R(a.Ka.C,"recommender-confidence-update",a.nqb).R(a.C,"ae",a.b3b);a.Yb.Mb(D3a,Na,a.qwb).subscribe(F3a,"action",a.Wnb).subscribe(E3a,"action",a.oFb).subscribe(y3a,"action",a.kpa).subscribe(vC,"action",a.Ozb).subscribe(E8a,
"action",a.EFb).subscribe(UC,"action",a.b8)}p=POc.prototype;p.Ig=function(){return G3a};p.hs=function(){return H3a};p.bw=function(a){POc.ea.bw.call(this,a);E3a.Na(a);SOc(this,!1);!this.Ra&&a&&(this.Ra=!0);Ss(this.Sb,{nc:a});a||this.C.Gc()};p.oZ=function(a){var b=this;this.C.oqa();var c=new Mi(function(){POc.ea.oZ.call(b,a)},300);this.qa(c);c.start()};p.b8=function(){POc.ea.b8.call(this);TOc(this,!1)};p.Mf=function(a){this.C.Mf(a);this.Ka.Mf(a)};
p.Bnb=function(a){var b=a.C.H,c=V(V(b,13),3);b=gT(b);var d=new jx;W(d,1,c);var e=new ty;W(e,1,d);W(e,3,!0);Jsc(e,!0);this.L.C(new mR(e,b));SX(this,a.cj(),!1,yAc(gx(c)))};p.Wnb=function(){var a=this.C.isVisible();this.Ig().setVisible(!a);a||this.C.focus();TOc(this,!a)};function TOc(a,b){b?(SX(a,2253),a.Oa=Fa()):SX(a,2226,!0)}p.kpa=function(){this.C.isVisible()||this.bw(!0)};p.Ozb=function(){var a=IOc(this.C);a&&(a.Rb()?CNc(a,"",!0):(this.kpa(),BNc(a,"",!0)))};p.oFb=function(a){RNc(this.C,a)};
p.EFb=function(){KOc(this.C,!0)};p.a3b=function(){UJ(this.O)&&null==this.C.J&&SOc(this,!0)};function SOc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.jb.refresh(),TNc(d));a.Ka.update(!b,a.C.isVisible(),c)}p.r9a=function(){UOc(this)};function UOc(a){a.$&&(L(a.$.Qa(),!1),Bb(a.$,a.Ba),a.$=null,a.Ba=null,a.Ta=null)}p.ttb=function(){UOc(this);var a=LOc(this.C);a&&(this.kpa(),a.rU(!0),a.dispatchEvent("$d"))};
p.nqb=function(a){var b=this,c=(a=a.C)?a.H:null,d=a?a.C:0,e=!!a&&a.F,f=a?a.H.rect:null;f=!!f&&f.lh()>=v1a&&KA(f,"r")>=x1a&&KA(f,"c")>=y1a&&f.lh()<=w1a;VOc(this,c,!!a&&a.D&&f);c.equals(this.Ta)||UOc(this);f&&(WOc(this,c,d,e),J(I(),"feepts")&&J(I(),"feepp")&&this.Wa.C["ritz-DisplayExplorePivotPromoV2"].La()&&(this.va&&(this.va.cancel(),this.va=null),!this.C.isVisible()&&c&&(this.va=ZAc(this.Hb,[c]),this.va.then(function(a){a.C.length&&(b.Ta=c,b.$=new OOc,b.qa(b.$),b.$.show(),b.Ba=new Se(b),b.qa(b.Ba),
b.Ba.subscribe(K.$ca,"action",b.ttb).subscribe(K.bda,"action",b.r9a),RJ(b.Wa,"ritz-DisplayExplorePivotPromoV2",!1))}))))};function VOc(a,b,c){if(c!==a.xb||b&&!b.equals(a.F))a.xb=c,a.F=b,a.Oa=Fa(),C3a.Wb({b9:c,WH:b})}p.tAa=function(a){var b=this;this.C.Wc=!0;var c=sI(OJ(this.H));if(!Cac.C&&!c){var d=a||this.Ma;this.Ig().setVisible(!0);this.ma.Vb(2225,d);SX(this,2253);a=new Mi(function(){b.C.isVisible()||b.ma.Vb(2752,d)},5E3);this.qa(a);a.start()}};
function WOc(a,b,c,d){if(b&&b.rect){var e=1E3>=b.rect.lh();b=ritz_api.RitzModelApi.isFormsRegion(""+b.jd,b.rect.top,b.rect.left,b.rect.height+b.rect.top,b.rect.width+b.rect.left);d=!a.C.isVisible()&&!a.Ra&&d&&e&&!a.O.Bh();e=J(I(),"feeaof")&&b;b=J(I(),"feeaoro")&&a.O.Ld();d&&(e||b)&&(d=new yg,G(d,1,c),G(d,2,e),G(d,3,b),G(d,5,lB),G(d,6,ROc()),c=new wg,Tf(c,58,d),c=Bj(Aj(new zj,10),c).build(),a.tAa(c))}}
function ROc(){switch(z1a){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Znb=function(){this.C.Gc()};p.c3b=function(a){var b=a.C,c=gT(b.H),d=parseInt(c.Ab(),10);this.J=WA(c);this.L.C(new jbc(d));jOc(b,c);SX(this,a.cj())};p.Z2b=function(){qG(this.H)?(this.C.Na(!0),SOc(this,!1)):(this.Ig().setVisible(!1),this.C.Na(!1))};p.qwb=function(){this.C.hca(!D3a.isEnabled())};p.iyb=function(a){SOc(this,!1,Jdb(a))};
p.Anb=function(a){var b=OJ(this.H),c=""+b.$b(),d=[],e=Quc(b);if(e){b=new pz;var f=uw(e,2);W(b,3,f);f=uw(e,2);W(b,2,f);e=uw(e,1);W(b,1,e);d.push(b)}b=a.C.zc;for(e=0;e<b.length;e++)f=new pz,W(f,2,b[e]),d.push(f);this.L.C(new VAc(d,c));SX(this,a.cj())};
p.ynb=function(a){var b=a.C,c=IAc(b.C),d=gT(b.H),e=c.Hu?c.xx:null,f=c.C?c.Ww:null,h=parseInt(d.Ab(),10),k=XOc(d);this.J=WA(d);k?this.L.C(new qV(k,h,this.J,e,c.Tr,c.Ws,f)):this.L.C(new nV(h,this.J,e,c.Tr,c.Ws,f));d=new Rtc;G(d,1,1);c=new eT;b=V(b.H,2);G(c,2,b);Tf(c,5,d);b=ZJc(this.F);Tf(b,46,c);b=Bj(Aj(new zj,10),b).build();this.ma.C(a.cj(),b)};p.ICb=function(a){a=a.C;var b=gT(a.H),c=parseInt(b.Ab(),10),d=XOc(b);this.J=WA(b);this.L.C(new UAc(d,c));jOc(a,b)};
p.b3b=function(a){var b=OJ(this.O.C),c=b.$b();b=UA(tbb(a.Ba,b),c);c=XJc(b,a.F,a.V);var d=this.Ka,e=a.F;Qsc(d.C);d.C.Ma=b;d.C.Ka=c;d.C.Oa=e;Htc(d.C,!0,!0,!1);SX(this,a.cj())};function XOc(a){var b=a.Ab();a=WA(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.mc(),a.kc(),a.Vc(),a.Xc(),7,!1);return 0<b.length?b[0]:null}p.Rob=function(a){jI(OJ(this.H),a.Ma);SX(this,a.cj())};
p.JFb=function(a){var b=a.C;a=a.cj();if(b instanceof xX||b instanceof zX||b instanceof nOc)SX(this,a);else{var c=SNc(this.C),d=new eT,e=V(b.H,2);c=c.indexOf(b);G(d,1,c);G(d,2,e);e=new wg;Tf(e,46,d);if(b instanceof gX){(d=b.J)?(b=YOc(this,b,d),b=gzc(b,d,d.eh)):b=null;if(!b)return;Tf(e,39,b)}else if(b instanceof qKc){var f=b.H;c=new KIc;if(b instanceof qKc)b=1;else throw Error("Unknown text analysis card type.");f=tw(V(f,8),20).slice(0,10);G(c,2,f||[]);G(c,1,b);Tf(d,3,c)}e=Bj(Aj(new zj,10),e).build();
this.ma.C(a,e)}};p.gEb=function(){this.C.Gc()};p.$2b=function(a){var b=a.Xw();if(b){var c=a.Ba,d=tw(c,1).map(function(a){return WA(a)});d=Ruc(this.O,d,a.H||void 0,a.O||void 0);vtc(d,c);xtc(d,b);this.Ha.dispatchEvent(new PL("objectRequest"));this.L.C(new FM(this.O,d));var e=ZOc(this,a.Ha);BIc(e,d.getId()||0);azc(this.ma,a.cj(),e,10,b,c,void 0,a.F)}};
p.kwb=function(a){var b=a.V;if(b){var c=OJ(this.H),d=a.H;d||(d=MA(pG(this.Ha).D.C));var e=16,f=16,h=a.O;h&&(e=h.x,f=h.y);h=Btc(this.O.J);d={oid:null,ar:nI(c,d.y),ac:oI(c,d.x),x:e,y:f,h:ndb.height,w:ndb.width,p:{context:tuc(h)}};(c=b.eh)?(e=new ul(c),d=new zJ(vI(this.H)||0,d,!1,!1),f=Dl(e,"headers"),f=null!=f&&ma(f)&&Kb(f)?parseInt(f,10):-1,d.ma=f,d.H=0,f="1"==Dl(e,"transpose"),d.O=f,d.F=f?"ROWS":"COLS",f=Dl(e,"range"),f=kuc(luc(f,","),this.H),d.sD(f),(e=Dl(e,"dt"))&&ipb(d,this.Pc.Ad(cA.Ca(),JSON.parse(decodeURIComponent(e))))):
(e=new jA,W(e,2,"0.6"),Ksc(e,a.Zd().toJSON()),d=new zJ(vI(this.H)||0,d,!1,!1,e));BJ(d);wtc(d,b);this.Ha.dispatchEvent(new PL("objectRequest"));this.L.C(new FM(this.O,d));e=$Oc(this,b,a.Ba,a.Zd());d=d.getId()||0;e.D=d;fzc(this.ma,a.cj(),e,10,b,c,void 0,a.F)}};function YOc(a,b,c){var d=SNc(a.C).filter(function(a){return a instanceof gX});return $Oc(a,c,d.indexOf(b),b.J&&b.J.Zd())}
function ZOc(a,b){var c=new NU;a=SNc(a.C).filter(function(a){return a instanceof gX}).map(function(a){return a.getChartType()});c.L=a;c.H=b;return c}function $Oc(a,b,c,d){var e=new NU;a=SNc(a.C).filter(function(a){return a instanceof gX}).map(function(a){return a.getChartType()});e.L=a;e.H=c;Nyc(e,b.getChartType());e.C=d?d.clone():null;return e}
function SX(a,b,c,d){if(a.F){var e=Rf(yj(a.Ma),yg,58).getTableRange();if(c||!e||e.Ab()!=a.F.jd||e.kc()!=a.F.rect.kc()||e.mc()!=a.F.rect.mc()||e.Xc()!=a.F.rect.Xc()||e.Vc()!=a.F.rect.Vc()){e=new yg;G(e,6,ROc());var f=YJc(a.F);Tf(e,7,f);c&&(c=Fa()-a.Oa,G(e,8,1E3*c),null!=a.C.zc&&(c=Fa()-a.C.zc,G(e,10,1E3*c)));d&&Csc(e,d);d=J(I(),"feacos");G(e,9,d);d=new wg;Tf(d,58,e);a.Ma=Aj(Bj(new zj,d),10).build()}}a.ma.Vb(b,a.Ma)};function aPc(){A.call(this)}x(aPc,oB);aPc.prototype.D=function(){return ONc};aPc.prototype.H=function(){return QX};aPc.prototype.F=function(){return POc};aPc.prototype.C=function(){return vJc};uB("assistant",aPc);
