yw.prototype.Hg=qQ(39,function(){return V(this,4)});Iy.prototype.Hg=qQ(38,function(){return V(this,2)});hJ.prototype.Hg=qQ(37,g("F"));Tfa.prototype.Es=qQ(6,function(){return null!=F(this,5)});Wm.prototype.Es=qQ(5,function(){return null!=F(this,1)});Aw.prototype.Es=qQ(4,function(){return ow(this,2)});function O2c(a){Cb(a,"google::")||(a="google::"+a);a=Nb(a);return Al(yl(wl(vl(new ul,"https"),"plx.corp.google.com"),"/script/"),"a=qo|i="+a).toString()};function P2c(){var a=P,b='<div class="'+R("waffle-dataconnector-modal-header")+'"><div class="'+R("waffle-dataconnector-modal-title")+'"></div><div class="'+R("waffle-dataconnector-modal-close-button")+'" tabindex="0" role="button">';var c=P('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="none" fill-rule="evenodd"><path d="M0,0 L18,0 L18,18 L0,18 L0,0 Z M0,0 L18,0 L18,18 L0,18 L0,0 Z"/><polygon fill="#000" points="14.53 4.53 13.47 3.47 9 7.94 4.53 3.47 3.47 4.53 7.94 9 3.47 13.47 4.53 14.53 9 10.06 13.47 14.53 14.53 13.47 10.06 9"/></g></svg>');
return a(b+c+'</div></div><div class="'+R("waffle-dataconnector-modal-body")+'"></div><div class="'+R("waffle-dataconnector-modal-footer")+'"></div>')};function qZ(a,b){a=void 0===a?"":a;Aq.call(this,!1,b);this.xb=a;this.C=new lr(void 0,Q2c.getInstance());this.Fa(this.C);this.Ta=null}q(qZ,Aq);p=qZ.prototype;p.xa=function(){Aq.prototype.xa.call(this);Bh(this.getElement(),"waffle-dataconnector-modal");this.xb&&Bh(this.getElement(),this.xb);gr(this.getElement(),P2c);var a=this.Yt();Bh(a,"waffle-dataconnector-modal-bg");L(a,!0);this.C.hb(this.Ia("waffle-dataconnector-modal-close-button"));this.Ta&&R2c(this)};
p.Ga=function(){Aq.prototype.Ga.call(this);this.getHandler().R(this.C,"action",this.a8);this.getHandler().R(this.Qa(),"keydown",this.mNb)};p.Ib=function(){return this.yb("waffle-dataconnector-modal-body")};function S2c(a){return a.yb("waffle-dataconnector-modal-footer")}function T2c(a,b){a.Ta=b;a.Qb()&&R2c(a)}p.a8=function(){l4a.Wb()};p.e8=function(){l4a.Wb()};p.mNb=function(a){27==a.keyCode?this.e8():9==a.keyCode&&a.shiftKey&&a.target==this.getElement()&&DCa(this)};
function R2c(a){Ci.getInstance().setContent(a.Ia("waffle-dataconnector-modal-title"),a.Ta)}function Q2c(){}q(Q2c,jr);Q2c.prototype.jp=n("waffle-dataconnector-modal-close-button");ta(Q2c);function rZ(a,b){qZ.call(this,a,b);this.H=pf()}q(rZ,qZ);p=rZ.prototype;p.getResult=function(){return this.H.C};p.resolve=function(a){this.H.resolve(a)};p.reject=function(a){this.H.reject(a)};p.Ea=function(){qZ.prototype.Ea.call(this);this.H.reject()};p.e8=function(){this.reject()};p.a8=function(){this.reject()};function U2c(){var a='<div class="'+R("waffle-dataconnector-bigquery-consent-screen-content")+'"><p>';a=a+"Sheets requires authorization to connect to your BigQuery projects."+('</p><div class="'+R("waffle-dataconnector-bigquery-consent-screen-authorize-button-wrapper")+'"></div></div>');return P(a)}function V2c(){var a='<div class="'+R("waffle-dataconnector-footer-sharing-message")+'">';return P(a+"Your authentication credentials are always private and never shared with another user.</div>")};function W2c(a){rZ.call(this,"waffle-dataconnector-bigquery-consent-screen",a);T2c(this,"Authorize");this.D=new MV("Authorize");this.Fa(this.D);this.D.Id("waffle-dataconnector-bigquery-consent-screen-authorize-button")}q(W2c,rZ);W2c.prototype.xa=function(){rZ.prototype.xa.call(this);gr(this.Ib(),U2c);gr(S2c(this),V2c);this.D.render(this.Ia("waffle-dataconnector-bigquery-consent-screen-authorize-button-wrapper"))};
W2c.prototype.Ga=function(){var a=this;rZ.prototype.Ga.call(this);this.getHandler().R(this.D,"action",function(){return a.resolve(!0)})};W2c.prototype.e8=function(){this.resolve(!1)};W2c.prototype.a8=function(){this.resolve(!1)};function sZ(){T.call(this)}x(sZ,T);var X2c=null;sZ.prototype.wx=function(){return ow(this,1)};function tZ(){T.call(this)}x(tZ,T);var Y2c=null;tZ.prototype.wx=function(){return ow(this,1)};tZ.prototype.TB=function(){return V(this,2)};tZ.prototype.vZ=function(){return ow(this,2)};function uZ(){T.call(this)}x(uZ,T);var Z2c=null;uZ.prototype.getName=function(){return V(this,1)};uZ.prototype.rf=function(a){W(this,1,a)};function vZ(){T.call(this)}x(vZ,T);var $2c=null;
sZ.prototype.Ca=function(){var a=X2c;a||(X2c=a=vw(sZ,{0:{name:"PlxQuery",qb:"ritzproto.PlxQuery"},1:{name:"query",Aa:9,type:String},2:{name:"engine",Aa:9,type:String},3:{name:"script_id",Aa:9,type:String}}));return a};sZ.Ca=sZ.prototype.Ca;tZ.prototype.Ca=function(){var a=Y2c;a||(Y2c=a=vw(tZ,{0:{name:"BigQueryQuery",qb:"ritzproto.BigQueryQuery"},1:{name:"query",Aa:9,type:String},2:{name:"project_id",Aa:9,type:String}}));return a};tZ.Ca=tZ.prototype.Ca;
uZ.prototype.Ca=function(){var a=Z2c;a||(Z2c=a=vw(uZ,{0:{name:"QueryParameter",qb:"ritzproto.QueryParameter"},1:{name:"name",Aa:9,type:String},2:{name:"constant_value",Aa:9,type:String},3:{name:"workbookrange_id",Aa:9,type:String}}));return a};uZ.Ca=uZ.prototype.Ca;
vZ.prototype.Ca=function(){var a=$2c;a||($2c=a=vw(vZ,{0:{name:"QueryProto",qb:"ritzproto.QueryProto"},1:{name:"sql_query",Aa:9,type:String},2:{name:"plx_query",Aa:11,type:sZ},4:{name:"bigquery_query",Aa:11,type:tZ},3:{name:"parameters",yc:!0,Aa:11,type:uZ}}));return a};vZ.Ca=vZ.prototype.Ca;var a3c={KDc:0,Qtc:1,$wc:2,P9b:3,kBc:4};function wZ(){T.call(this)}x(wZ,T);var b3c=null;wZ.prototype.getName=function(){return V(this,1)};wZ.prototype.rf=function(a){W(this,1,a)};function xZ(){T.call(this)}x(xZ,T);var c3c=null;p=xZ.prototype;p.getId=function(){return V(this,1)};p.En=function(){return uw(this,1)};p.Bf=function(a){W(this,1,a)};p.getType=function(){return V(this,2)};p.setType=function(a){W(this,2,a)};function yZ(){T.call(this)}x(yZ,T);var d3c=null;function zZ(){T.call(this)}x(zZ,T);
var e3c=null;zZ.prototype.Es=function(){return ow(this,3)};function AZ(){T.call(this)}x(AZ,T);var f3c=null;AZ.prototype.wx=function(){return ow(this,2)};AZ.prototype.getToken=function(){return V(this,3)};function BZ(){T.call(this)}x(BZ,T);var g3c=null;BZ.prototype.Hg=function(){return V(this,1)};BZ.prototype.Ab=function(){return V(this,3)};BZ.prototype.jg=function(){return ow(this,3)};function CZ(){T.call(this)}x(CZ,T);var h3c=null;CZ.prototype.wx=function(){return ow(this,2)};
CZ.prototype.getToken=function(){return V(this,4)};function DZ(){T.call(this)}x(DZ,T);var i3c=null;DZ.prototype.Hg=function(){return V(this,1)};function EZ(){T.call(this)}x(EZ,T);var j3c=null;EZ.prototype.aJ=function(a){qw(this,2,a)};function k3c(){T.call(this)}x(k3c,T);var l3c=null;function FZ(){T.call(this)}x(FZ,T);var m3c=null;FZ.prototype.Ab=function(){return V(this,1)};FZ.prototype.jg=function(){return ow(this,1)};FZ.prototype.getToken=function(){return V(this,2)};
function GZ(){T.call(this)}x(GZ,T);var n3c=null;GZ.prototype.Hg=function(){return V(this,1)};function HZ(){T.call(this)}x(HZ,T);var o3c=null;HZ.prototype.TB=function(){return V(this,2)};HZ.prototype.vZ=function(){return ow(this,2)};function IZ(){T.call(this)}x(IZ,T);var p3c=null;IZ.prototype.Es=function(){return ow(this,2)};function JZ(){T.call(this)}x(JZ,T);var q3c=null;JZ.prototype.getName=function(){return V(this,1)};JZ.prototype.rf=function(a){W(this,1,a)};
JZ.prototype.TB=function(){return V(this,3)};JZ.prototype.vZ=function(){return ow(this,3)};function KZ(){T.call(this)}x(KZ,T);var r3c=null;KZ.prototype.wx=function(){return ow(this,2)};KZ.prototype.getToken=function(){return V(this,3)};function LZ(){T.call(this)}x(LZ,T);var s3c=null;LZ.prototype.Hg=function(){return V(this,1)};function t3c(){T.call(this)}x(t3c,T);var u3c=null;function MZ(){T.call(this)}x(MZ,T);var v3c=null;p=MZ.prototype;p.getId=function(){return V(this,1)};
p.En=function(){return uw(this,1)};p.Bf=function(a){W(this,1,a)};p.getName=function(){return V(this,2)};p.rf=function(a){W(this,2,a)};function w3c(){T.call(this)}x(w3c,T);var x3c=null;function NZ(){T.call(this)}x(NZ,T);var y3c=null;NZ.prototype.Es=function(){return ow(this,2)};function z3c(){T.call(this)}x(z3c,T);var A3c=null;function OZ(){T.call(this)}x(OZ,T);var B3c=null;OZ.prototype.Es=function(){return ow(this,2)};function PZ(){T.call(this)}x(PZ,T);var C3c=null;p=PZ.prototype;
p.getId=function(){return V(this,1)};p.En=function(){return uw(this,1)};p.Bf=function(a){W(this,1,a)};p.getName=function(){return V(this,2)};p.rf=function(a){W(this,2,a)};function D3c(){T.call(this)}x(D3c,T);var E3c=null;function QZ(){T.call(this)}x(QZ,T);var F3c=null;QZ.prototype.wx=function(){return ow(this,2)};
wZ.prototype.Ca=function(){var a=b3c;a||(b3c=a=vw(wZ,{0:{name:"CreateConnectionRequest",qb:"ritzproto.CreateConnectionRequest"},1:{name:"name",Aa:9,type:String},2:{name:"connection_type",Aa:14,defaultValue:0,type:ITa},3:{name:"jdbc_connection_info",Aa:11,type:yZ}}));return a};wZ.Ca=wZ.prototype.Ca;
xZ.prototype.Ca=function(){var a=c3c;a||(c3c=a=vw(xZ,{0:{name:"ImportConnectionRequest",qb:"ritzproto.ImportConnectionRequest"},1:{name:"id",Aa:9,type:String},2:{name:"type",Aa:14,defaultValue:0,type:ITa}}));return a};xZ.Ca=xZ.prototype.Ca;
yZ.prototype.Ca=function(){var a=d3c;a||(d3c=a=vw(yZ,{0:{name:"JdbcConnectionInfo",qb:"ritzproto.JdbcConnectionInfo"},1:{name:"database_type",Aa:14,defaultValue:0,type:a3c},2:{name:"hostname",Aa:9,type:String},3:{name:"db_name",Aa:9,type:String},4:{name:"username",Aa:9,type:String},5:{name:"password",Aa:9,type:String},6:{name:"use_ssl",Aa:8,type:Boolean},7:{name:"client_key",Aa:9,type:String},8:{name:"client_cert",Aa:9,type:String},9:{name:"server_ca",Aa:9,type:String},10:{name:"jdbc_url",Aa:9,type:String}}));
return a};yZ.Ca=yZ.prototype.Ca;zZ.prototype.Ca=function(){var a=e3c;a||(e3c=a=vw(zZ,{0:{name:"CreateConnectionResponse",qb:"ritzproto.CreateConnectionResponse"},1:{name:"success",Aa:8,type:Boolean},2:{name:"connection_id",Aa:9,type:String},3:{name:"error_code",Aa:14,defaultValue:0,type:JTa},4:{name:"error_text",Aa:9,type:String}}));return a};zZ.Ca=zZ.prototype.Ca;
AZ.prototype.Ca=function(){var a=f3c;a||(f3c=a=vw(AZ,{0:{name:"CreateQueryRequest",qb:"ritzproto.CreateQueryRequest"},1:{name:"connection_id",Aa:9,type:String},2:{name:"query",Aa:11,type:vZ},3:{name:"token",Aa:9,type:String}}));return a};AZ.Ca=AZ.prototype.Ca;BZ.prototype.Ca=function(){var a=g3c;a||(g3c=a=vw(BZ,{0:{name:"CreateQueryResponse",qb:"ritzproto.CreateQueryResponse"},1:{name:"execution_status",Aa:11,type:Aw},2:{name:"query_id",Aa:9,type:String},3:{name:"sheet_id",Aa:9,type:String}}));return a};
BZ.Ca=BZ.prototype.Ca;CZ.prototype.Ca=function(){var a=h3c;a||(h3c=a=vw(CZ,{0:{name:"PreviewQueryRequest",qb:"ritzproto.PreviewQueryRequest"},1:{name:"connection_id",Aa:9,type:String},2:{name:"query",Aa:11,type:vZ},3:{name:"max_rows",Aa:5,type:Number},4:{name:"token",Aa:9,type:String}}));return a};CZ.Ca=CZ.prototype.Ca;
DZ.prototype.Ca=function(){var a=i3c;a||(i3c=a=vw(DZ,{0:{name:"PreviewQueryResponse",qb:"ritzproto.PreviewQueryResponse"},1:{name:"execution_status",Aa:11,type:Aw},2:{name:"query_result",Aa:11,type:EZ},3:{name:"total_rows",Aa:5,type:Number},4:{name:"has_more",Aa:8,type:Boolean}}));return a};DZ.Ca=DZ.prototype.Ca;
EZ.prototype.Ca=function(){var a=j3c;a||(j3c=a=vw(EZ,{0:{name:"QueryResult",qb:"ritzproto.QueryResult"},1:{name:"column_names",yc:!0,Aa:9,type:String},2:{name:"rows",yc:!0,Aa:11,type:k3c}}));return a};EZ.Ca=EZ.prototype.Ca;k3c.prototype.Ca=function(){var a=l3c;a||(l3c=a=vw(k3c,{0:{name:"QueryResultRow",qb:"ritzproto.QueryResultRow"},1:{name:"formatted_values",yc:!0,Aa:11,type:Mw}}));return a};k3c.Ca=k3c.prototype.Ca;
FZ.prototype.Ca=function(){var a=m3c;a||(m3c=a=vw(FZ,{0:{name:"RefreshSheetRequest",qb:"ritzproto.RefreshSheetRequest"},1:{name:"sheet_id",Aa:9,type:String},2:{name:"token",Aa:9,type:String}}));return a};FZ.Ca=FZ.prototype.Ca;GZ.prototype.Ca=function(){var a=n3c;a||(n3c=a=vw(GZ,{0:{name:"RefreshSheetResponse",qb:"ritzproto.RefreshSheetResponse"},1:{name:"execution_status",Aa:11,type:Aw}}));return a};GZ.Ca=GZ.prototype.Ca;
HZ.prototype.Ca=function(){var a=o3c;a||(o3c=a=vw(HZ,{0:{name:"GetTablesRequest",qb:"ritzproto.GetTablesRequest"},1:{name:"connection_id",Aa:9,type:String},2:{name:"project_id",Aa:9,type:String},3:{name:"schema_name",Aa:9,type:String}}));return a};HZ.Ca=HZ.prototype.Ca;
IZ.prototype.Ca=function(){var a=p3c;a||(p3c=a=vw(IZ,{0:{name:"GetTablesResponse",qb:"ritzproto.GetTablesResponse"},1:{name:"success",Aa:8,type:Boolean},2:{name:"error_code",Aa:14,defaultValue:0,type:JTa},3:{name:"error_text",Aa:9,type:String},4:{name:"tables",yc:!0,Aa:11,type:JZ}}));return a};IZ.Ca=IZ.prototype.Ca;
JZ.prototype.Ca=function(){var a=q3c;a||(q3c=a=vw(JZ,{0:{name:"Table",qb:"ritzproto.Table"},1:{name:"name",Aa:9,type:String},2:{name:"schema",Aa:9,type:String},3:{name:"project_id",Aa:9,type:String}}));return a};JZ.Ca=JZ.prototype.Ca;KZ.prototype.Ca=function(){var a=r3c;a||(r3c=a=vw(KZ,{0:{name:"EditQueryRequest",qb:"ritzproto.EditQueryRequest"},1:{name:"query_id",Aa:9,type:String},2:{name:"query",Aa:11,type:vZ},3:{name:"token",Aa:9,type:String}}));return a};KZ.Ca=KZ.prototype.Ca;
LZ.prototype.Ca=function(){var a=s3c;a||(s3c=a=vw(LZ,{0:{name:"EditQueryResponse",qb:"ritzproto.EditQueryResponse"},1:{name:"execution_status",Aa:11,type:Aw}}));return a};LZ.Ca=LZ.prototype.Ca;t3c.prototype.Ca=function(){var a=u3c;a||(u3c=a=vw(t3c,{0:{name:"ListConnectionsResponse",qb:"ritzproto.ListConnectionsResponse"},1:{name:"connections",yc:!0,Aa:11,type:MZ}}));return a};t3c.Ca=t3c.prototype.Ca;
MZ.prototype.Ca=function(){var a=v3c;a||(v3c=a=vw(MZ,{0:{name:"Connection",qb:"ritzproto.Connection"},1:{name:"id",Aa:9,type:String},2:{name:"name",Aa:9,type:String},3:{name:"connection_type",Aa:14,defaultValue:0,type:ITa},4:{name:"jdbc_connection_info",Aa:11,type:yZ}}));return a};MZ.Ca=MZ.prototype.Ca;w3c.prototype.Ca=function(){var a=x3c;a||(x3c=a=vw(w3c,{0:{name:"GetColumnsRequest",qb:"ritzproto.GetColumnsRequest"},1:{name:"connection_id",Aa:9,type:String},2:{name:"table",Aa:11,type:JZ}}));return a};
w3c.Ca=w3c.prototype.Ca;NZ.prototype.Ca=function(){var a=y3c;a||(y3c=a=vw(NZ,{0:{name:"GetColumnsResponse",qb:"ritzproto.GetColumnsResponse"},1:{name:"success",Aa:8,type:Boolean},2:{name:"error_code",Aa:14,defaultValue:0,type:JTa},3:{name:"error_text",Aa:9,type:String},4:{name:"column_names",yc:!0,Aa:9,type:String}}));return a};NZ.Ca=NZ.prototype.Ca;
z3c.prototype.Ca=function(){var a=A3c;a||(A3c=a=vw(z3c,{0:{name:"GetBigQueryProjectsRequest",qb:"ritzproto.GetBigQueryProjectsRequest"},1:{name:"connection_id",Aa:9,type:String}}));return a};z3c.Ca=z3c.prototype.Ca;
OZ.prototype.Ca=function(){var a=B3c;a||(B3c=a=vw(OZ,{0:{name:"GetBigQueryProjectsResponse",qb:"ritzproto.GetBigQueryProjectsResponse"},1:{name:"success",Aa:8,type:Boolean},2:{name:"error_code",Aa:14,defaultValue:0,type:JTa},3:{name:"error_text",Aa:9,type:String},4:{name:"projects",yc:!0,Aa:11,type:PZ}}));return a};OZ.Ca=OZ.prototype.Ca;
PZ.prototype.Ca=function(){var a=C3c;a||(C3c=a=vw(PZ,{0:{name:"BigQueryProject",qb:"ritzproto.BigQueryProject"},1:{name:"id",Aa:9,type:String},2:{name:"name",Aa:9,type:String}}));return a};PZ.Ca=PZ.prototype.Ca;D3c.prototype.Ca=function(){var a=E3c;a||(E3c=a=vw(D3c,{0:{name:"GetQueryRequest",qb:"ritzproto.GetQueryRequest"},1:{name:"query_id",Aa:9,type:String}}));return a};D3c.Ca=D3c.prototype.Ca;
QZ.prototype.Ca=function(){var a=F3c;a||(F3c=a=vw(QZ,{0:{name:"GetQueryResponse",qb:"ritzproto.GetQueryResponse"},1:{name:"found",Aa:8,type:Boolean},2:{name:"query",Aa:11,type:vZ}}));return a};QZ.Ca=QZ.prototype.Ca;function G3c(a,b){b=void 0===b?"":b;this.C=[];for(var c=0;c<a.length;c++)this.C.push(a[c].clone());this.D=b};function H3c(){return P('<div class="'+R("waffle-dataconnector-bigqueryquerysettingsdialog-project-section")+'"><div class="'+R("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-wrapper")+'"></div></div>')}
function I3c(){var a='<div class="'+R("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button-wrapper")+'"></div><div class="'+R("waffle-dataconnector-footer-sharing-message")+'">';return P(a+"The data you query is visible to everyone with view access, but your query is only visible to people with edit access.</div>")};function J3c(a,b){rZ.call(this,"waffle-dataconnector-bigqueryquerysettingsdialog",b);T2c(this,"BigQuery query settings");this.D=new wV;this.Fa(this.D);this.D.Id("waffle-dataconnector-bigqueryquerysettingsdialog-project-select");this.D.setContent("Billing project");b=a.C;for(var c=0;c<b.length;c++){var d=b[c];this.D.yd(new Bk(d.getName(),d.getId()))}this.F=new MV("Create Query");this.Fa(this.F);this.F.Id("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button");this.L=a.C}q(J3c,rZ);
J3c.prototype.xa=function(){rZ.prototype.xa.call(this);gr(this.Ib(),H3c);gr(S2c(this),I3c);this.D.render(this.Ia("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-wrapper"));this.F.render(this.Ia("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button-wrapper"))};J3c.prototype.Ga=function(){rZ.prototype.Ga.call(this);this.getHandler().R(this.F,"action",this.O).R(this.D,"change",this.J);this.J()};J3c.prototype.J=function(){this.F.Na(null!=this.D.We())};J3c.prototype.O=function(){this.resolve(K3c(this))};
function K3c(a){var b=a.D.We().La();return new G3c(a.L,b)};function RZ(a,b){Bq.call(this,"waffle-dataconnector-prompt",a,b);this.L=pf();Pq(this,null);Oq(this,!0);this.C=new NV("Continue");this.Fa(this.C);this.J=new qDc("Cancel");this.Fa(this.J);this.O=[]}q(RZ,Bq);p=RZ.prototype;p.Id=function(a){this.O.push(a);var b=this.getElement();b&&Bh(b,a)};p.getResult=function(){return this.L.C};p.resolve=function(a){this.L.resolve(a)};p.reject=function(){this.L.reject()};
p.xa=function(){Bq.prototype.xa.call(this);var a=Gq(this);this.J.render(a);this.C.render(a);L(a,!0)};p.Ga=function(){var a=this;Bq.prototype.Ga.call(this);for(var b=ha(this.O),c=b.next();!c.done;c=b.next())Bh(this.Qa(),c.value);this.getHandler().R(this.J,"action",function(){return a.reject()})};p.setVisible=function(a){Bq.prototype.setVisible.call(this,a);a||this.reject()};p.Ea=function(){Bq.prototype.Ea.call(this);this.reject()};function L3c(a,b){RZ.call(this,a,b)}q(L3c,RZ);L3c.prototype.Ga=function(){var a=this;RZ.prototype.Ga.call(this);this.getHandler().R(this.C,"action",function(){return a.resolve(0)})};function M3c(a){sR.call(this,a);this.D=!1}q(M3c,sR);M3c.prototype.xa=function(){sR.prototype.xa.call(this);Bh(this.getElement(),"waffle-progress-bar");Fh(this.getElement(),"waffle-indeterminate-progress-bar",this.D)};function N3c(a,b){a.D!=b&&(a.D=b,a.getElement()&&Fh(a.getElement(),"waffle-indeterminate-progress-bar",b))}M3c.prototype.Pa=function(a){N3c(this,!1);sR.prototype.Pa.call(this,a)};
function O3c(a,b){N3c(a,!1);var c={width:a.La()+"%"},d={width:b+"%"};c=new Xq(a.Ia("progress-bar-thumb"),1,c,d,{Ag:"width",duration:1,timing:"ease-in",Wl:0});c.Sc("end",function(){sR.prototype.Pa.call(a,b)});c.play()};function P3c(){return P('<div class="'+R("waffle-dataconnector-dialog-progress-message")+'"><div class="'+R("waffle-dataconnector-dialog-progress-label")+'"></div><div class="'+R("waffle-dataconnector-dialog-progress-bar")+'"></div></div>')};function SZ(a,b){Bq.call(this,"waffle-dataconnector-dialog",a,b);Pq(this,null);this.Fz(!1);Oq(this,!0);this.Ra=[];this.jb=new NV("Ok");this.Fa(this.jb);this.Ta=new qDc("Cancel");this.Fa(this.Ta);this.Wa=new ej;this.Cb=Aj(new zj,1).build();this.Hb=this.oa().xa("DIV","waffle-dataconnector-dialog-error-message");this.Sb=this.oa().xa("DIV","waffle-dataconnector-dialog-info-message");this.Zb=N(P3c);this.O=new M3c;N3c(this.O,!0);this.Fa(this.O)}q(SZ,Bq);function Q3c(a,b,c){kj(a.Wa,a.jb,b,mj,c,a.Cb)}
function R3c(a){kj(a.Wa,a.Ta,l4a,mj,void 0,a.Cb)}function S3c(a){var b=["waffle-dataconnector-queryeditor"];a.Qb()&&(Eh(a.Qa(),a.Ra),Ch(a.Qa(),b));a.Ra=b}
SZ.prototype.xa=function(){Bq.prototype.xa.call(this);Ch(this.Qa(),this.Ra);var a=Gq(this),b=this.oa().xa("DIV","waffle-dataconnector-dialog-button-wrapper");a.appendChild(b);this.Ta.render(b);this.jb.render(b);L(a,!0);b=this.oa().xa("DIV","waffle-dataconnector-dialog-message-container",this.Hb,this.Sb,this.Zb);a.appendChild(b);this.O.render(this.Ia("waffle-dataconnector-dialog-progress-bar"));gr(HCa(this),sDc)};
SZ.prototype.Ga=function(){Bq.prototype.Ga.call(this);TZ(this);uh(this.Hb,"live","polite");uh(this.Sb,"live","polite");uh(this.Zb,"live","polite")};SZ.prototype.Fz=function(a){Bq.prototype.Fz.call(this,a);Iq(this,this.$J?0:.6)};function T3c(a,b){a=a.Ia("waffle-dataconnector-dialog-error-message");sd(a,b||md(""));L(a,!!b)}function U3c(a,b){a=a.Ia("waffle-dataconnector-dialog-info-message");sd(a,b||md(""));L(a,!!b)}
function V3c(a,b,c){re(a.Ia("waffle-dataconnector-dialog-progress-label"),b);null!=c&&O3c(a.O,c);L(a.Ia("waffle-dataconnector-dialog-progress-message"),!0)}function TZ(a){T3c(a,null);U3c(a,null);a.O.Pa(0);N3c(a.O,!0);L(a.Ia("waffle-dataconnector-dialog-progress-message"),!1)};function W3c(a){var b='<div class="'+R("waffle-dataconnector-connectionconfirmationscreen-content")+'"><div class="'+R("waffle-dataconnector-connectionconfirmationscreen-access-security")+'" tabindex="0"><h3>';b+="Access &amp; security.";var c="";c=a.VNa?c+"<p>Plx is an internal-only connection that's visible only to Googlers.</p><p>People outside of google.com will see Plx as an unnamed connection.":c+"<p>Database passwords and user IDs are not shared amongst collaborators.";c=P(c+"</p>");b+="</h3>"+
c+'</div><div class="'+R("waffle-dataconnector-connectionconfirmationscreen-data-visibility")+'" tabindex="0"><h3>';b+="Who can see data &amp; queries";c="<p>Users who can view the spreadsheet will be able to see the data.</p>";c=a.VNa?c+"<p>Google users who can edit the spreadsheet will be able to view and modify the query.</p><p>Users outside of google.com who can view the spreadsheet will be able to view the data, but will not be able to view or refresh the query.":c+"<p>Users who can edit the spreadsheet can view and modify the query only after they've signed into the database.";
a=P(c+"</p>");return P(b+("</h3>"+a+"</div></div>"))};function X3c(a,b,c,d){SZ.call(this,c,d);Cq(this,"Connected");this.F=a;this.C=b;R3c(this);Q3c(this,n4a)}q(X3c,SZ);X3c.prototype.xa=function(){SZ.prototype.xa.call(this);gr(this.Ib(),W3c,{VNa:2==this.C})};function Y3c(a,b,c,d){this.Hc=a;this.D=b;this.Ic=c;this.C=d}Y3c.prototype.getName=g("D");Y3c.prototype.getId=g("Hc");Y3c.prototype.getType=g("Ic");function Z3c(){this.Ic=this.Hc=this.D=null;this.C=!1}Z3c.prototype.rf=function(a){this.D=a;return this};Z3c.prototype.Bf=function(a){this.Hc=a;return this};Z3c.prototype.setType=function(a){this.Ic=a;return this};function $3c(a){a.C=!0;return a}Z3c.prototype.build=function(){return new Y3c(this.Hc,this.D,this.Ic,this.C)};function a4c(a){return P('<div class="'+R("waffle-dataconnector-connectioncard")+'" role="button" tab-index="0"><div class="'+R("waffle-dataconnector-connectioncard-icon")+'"></div><div class="'+R("waffle-dataconnector-connectioncard-body")+'"><div class="'+R("waffle-dataconnector-connectioncard-header")+'">'+O(a.gP)+"</div></div></div>")};function b4c(){}q(b4c,jr);b4c.prototype.xa=function(a){a=a.Sa();var b=N(a4c,{gP:a.getName()});Fh(b,"waffle-dataconnector-connectioncard-authenticated",a.C);return b};b4c.prototype.hc=n("waffle-dataconnector-connectioncard");ta(b4c);function c4c(a,b){lr.call(this,void 0,b4c.getInstance(),b);this.Uc(a);this.Ze(8,!0)}q(c4c,lr);c4c.prototype.Uc=function(a){lr.prototype.Uc.call(this,a)};function d4c(){return P('<div class="'+R("waffle-dataconnector-connectionmanager-content")+'"><div class="'+R("waffle-dataconnector-connectionmanager-connections")+'"><div class="'+R("waffle-dataconnector-connectionmanager-authorized")+'"></div></div></div>')};function e4c(a,b){SZ.call(this,a,b);Cq(this,"Managed connections");this.C=new Rr;this.qa(this.C);this.F=new M(this.oa());this.Fa(this.F);this.J=new YU;this.Fa(this.J);Q3c(this,fC);R3c(this)}q(e4c,SZ);e4c.prototype.xa=function(){SZ.prototype.xa.call(this);gr(this.Ib(),d4c)};
e4c.prototype.Ga=function(){SZ.prototype.Ga.call(this);this.J.render(this.Ia("waffle-dataconnector-connectionmanager-content"));this.F.hb(this.Ia("waffle-dataconnector-connectionmanager-connections"));this.getHandler().R(this.F,"action",this.L).R(this.C,"select",this.ma);f4c(this,!0)};function f4c(a,b){Fh(a.Qa(),"waffle-dataconnector-connectionmanager-loading",b);ZU(a.J,b)}
function g4c(a,b){var c=a.Ia("waffle-dataconnector-connectionmanager-authorized");b=ha(b);for(var d=b.next();!d.done;d=b.next())d=new c4c(d.value),a.F.Fa(d),d.render(c)}e4c.prototype.L=function(a){a.stopPropagation();Sr(this.C,a.target)};e4c.prototype.ma=function(){var a=(a=(a=this.C.We())&&a)&&a.Sa();fC.Pa(a)};function h4c(a){var b='<div class="'+R("waffle-dataconnector-bar")+'"><div class="'+R("waffle-dataconnector-bar-header")+'" tabindex="0" aria-label="',c="Data connection: "+R(a.gP);b+=vr(c);b+='">'+O(a.gP)+'</div><div class="'+R("waffle-dataconnector-bar-editquery-button-wrapper")+'"></div><div class="'+R("waffle-dataconnector-bar-timestamp")+'" tabindex="0"></div><div class="'+R("waffle-dataconnector-bar-refresh-button-wrapper")+'"></div><div class="'+R("waffle-dataconnector-bar-progress")+'"><div class="'+
R("waffle-dataconnector-bar-spinner")+'"></div><span class="'+R("waffle-dataconnector-bar-progress-message")+'"></span></div></div>';return P(b)};function i4c(a,b,c){PV.call(this,c);this.V=a;this.H=new ej;this.qa(this.H);this.C=new OV;this.Fa(this.C);this.C.Id("waffle-dataconnector-bar-editquery-button");kj(this.H,this.C,cC,mj);this.D=new OV;this.Fa(this.D);this.D.Id("waffle-dataconnector-bar-refresh-button");kj(this.H,this.D,eC,mj);this.O=b;this.va=new j4c}q(i4c,PV);i4c.prototype.fta=function(){return N(h4c,{gP:Sb(this.V,64)})};
i4c.prototype.Ga=function(){PV.prototype.Ga.call(this);this.C.render(this.Ia("waffle-dataconnector-bar-editquery-button-wrapper"));this.D.render(this.Ia("waffle-dataconnector-bar-refresh-button-wrapper"));k4c(this,this.O);UZ(this,!1)};i4c.prototype.fja=n("waffle-dataconnector-bar-wrapper");i4c.prototype.focus=function(){this.Qa().focus()};
function VZ(a,b){UZ(a,!0);null!=b?(b="Executing query - "+(b+"%"),re(a.Ia("waffle-dataconnector-bar-progress-message"),b)):re(a.Ia("waffle-dataconnector-bar-progress-message"),"Executing query")}function k4c(a,b){0>=b||(a.O=b,b="Last refreshed "+a.va.format(b),a=a.Ia("waffle-dataconnector-bar-timestamp"),re(a,b))}
function UZ(a,b){Fh(a.Qa(),"waffle-dataconnector-bar-executing",b);cC.isEnabled()&&cC.setVisible(!b);eC.isEnabled()&&eC.setVisible(!b);L(a.Ia("waffle-dataconnector-bar-timestamp"),!b);L(a.Ia("waffle-dataconnector-bar-progress"),b)}function j4c(){this.C=new Ct(1);this.D=new Ct(Ft.MONTH_DAY_MEDIUM);this.F=new Ct(7)}
j4c.prototype.format=function(a){a=new Date(a);var b=new Date;b=0<b.getFullYear()-a.getFullYear()?this.C.format(a):a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()?"Today":this.D.format(a);a=this.F.format(a);return b+(", "+a)};function l4c(a,b,c,d){A.call(this);this.$=a;this.ma=b;this.va=c;this.O=this.J=this.L=null;this.F=d||null;this.C=3;this.V=new m4c;this.H=this.D=null}q(l4c,A);p=l4c.prototype;p.getId=function(){return Ca(this)};p.Ea=function(){this.stop();A.prototype.Ea.call(this)};p.start=function(){this.C=2;this.H=this.D=null;this.lFa(this.$)};p.stop=function(){2==this.C&&(this.C=3,this.V.stop())};function n4c(a,b){a.L=b;return a}function o4c(a,b){a.J=b;return a}function p4c(a,b){a.O=b;return a}
p.lFa=function(a){var b=this;this.ma.call(this.F,a).then(function(a){if(2==b.C){b.D=a;b.H=null;var c=b.va.call(b.F,a);if(c){b.O&&b.O.call(b.F,a);a:{a=b.V;c=v(b.lFa,b,c);if(10>a.F){a.F++;var e=1E3}else if(60>a.D)a.D++,e=5E3;else{a=!1;break a}e+=Math.round(.2*e*(Math.random()-.5)*2);a.C=Ji(c,e);a=!0}a||q4c(b,Error("Polling timed out"))}else b.stop(),b.C=4,b.D=a,b.H=null,b.L&&b.L.call(b.F,a)}},function(a){2==b.C&&q4c(b,a)})};function q4c(a,b){a.stop();a.C=1;a.D=null;a.H=b;a.J&&a.J.call(a.F,b)}
p.getStatus=g("C");p.uK=g("H");function m4c(){this.D=this.F=0;this.C=null}m4c.prototype.stop=function(){this.D=this.F=0;Ki(this.C);this.C=null};function r4c(){A.call(this);this.C=null;this.D={}}q(r4c,A);r4c.prototype.Ea=function(){this.C&&C(this.C);this.C=null;hc(this.D,function(a){return C(a)});A.prototype.Ea.call(this)};function s4c(a,b){a.C&&C(a.C);a.C=b}function t4c(a,b,c){C(a.D[b]);a.D[b]=c}function u4c(a,b){return(a=rc(a.D,function(a){return a.getId()==b.getId()}))?Number(a):null};function v4c(a,b,c,d,e){QV.call(this,"waffle-connectionbar-id",e);var f=this;xDc(this,function(){f.C.setVisible(!0,!0);UQ()});this.H=a;this.D=b;this.J=c;this.F=d}q(v4c,QV);p=v4c.prototype;p.Ab=g("D");p.Lu=function(){QV.prototype.Lu.call(this);this.getHandler().R(this.F,"Ua",this.AEb);this.KB()};
p.show=function(){QV.prototype.show.call(this);var a=this.J.D[this.D]||null;if(a)switch(a.getStatus()){case 1:UZ(this.C,!1);break;case 2:(a=a.D)?a instanceof BZ?this.D==a.Ab()&&VZ(this.C,V(a.Hg(),5)):a instanceof LZ?this.D==this.D&&VZ(this.C,V(a.Hg(),5)):a instanceof GZ&&this.D==this.D&&VZ(this.C,V(a.Hg(),5)):VZ(this.C);break;case 4:UZ(this.C,!1)}};p.qQ=function(){return new i4c(this.H,w4c(this))};p.AEb=function(a){this.isDisposed()||a.ah!=vI(this.F.C)||k4c(this.C,w4c(this))};
function w4c(a){a=a.F.C.C.Ab().toString();return ritz_api.DbxApi.getLastExecutionTimeForSheet(a)};function x4c(){this.C=null;this.Pc=new xw}x4c.prototype.Mf=ca("C");function y4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/createConnection"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(zZ.Ca(),c.sf());c.Es()?e(c):b(c)}),function(){var a=new zZ;W(a,1,!1);W(a,3,1);e(a)}).we()})}
function z4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/createQuery"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(BZ.Ca(),c.sf());3==c.Hg().getState()?e(c):b(c)}),function(){var a=new BZ,b=new Aw;W(a,1,b);b.Lb(3);W(b,2,1);e(a)}).we()})}
function A4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/importConnection"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(){b()}),function(){e()}).we()})}
function B4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/previewQuery"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(DZ.Ca(),c.sf());3==c.Hg().getState()?e(c):b(c)}),function(){var a=new DZ,b=new Aw;W(a,1,b);b.Lb(3);W(b,2,1);e(a)}).we()})}
function C4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/refreshSheet"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(GZ.Ca(),c.sf());3==c.Hg().getState()?e(c):b(c)}),function(){var a=new GZ,b=new Aw;W(a,1,b);b.Lb(3);W(b,2,1);e(a)}).we()})}
function D4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/editQuery"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(LZ.Ca(),c.sf());3==c.Hg().getState()?e(c):b(c)}),function(){var a=new LZ,b=new Aw;W(a,1,b);b.Lb(3);W(b,2,1);e(a)}).we()})}
function E4c(a){return new kf(function(b,c){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/listConnections"),"GET")),1).setTimeout(3E4).Cf(["currentWorkbookOnly",!0]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(t3c.Ca(),c.sf());b(c)}),c).we()})}
function F4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/getTables"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(IZ.Ca(),c.sf());c.Es()?e(c):b(c)}),function(){var a=new IZ;W(a,1,!1);W(a,2,1);e(a)}).we()})}
function G4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/getColumns"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(NZ.Ca(),c.sf());c.Es()?e(c):b(c)}),function(){var a=new NZ;W(a,1,!1);W(a,2,1);e(a)}).we()})}
function H4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/getQuery"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(QZ.Ca(),c.sf());b(c)}),e).we()})}
function I4c(a,b){a.Pc.Yi=!0;var c=Vl(a.Pc.serialize(b));return new kf(function(b,e){Wu(Os(Um(Qv(Ps(a.C.Te("/dbx/getBigQueryProjects"),"POST")),1).setTimeout(3E4).setContent(["data",c]),function(c){a.Pc.Yi=!1;c=a.Pc.Ad(OZ.Ca(),c.sf());c.Es()?e(c):b(c)}),function(){var a=new OZ;W(a,1,!1);W(a,2,1);e(a)}).we()})};function J4c(a,b,c){b=c||b;return P('<div class="'+R("waffle-dataconnector-draggablebar")+'">'+K4c(null,b)+"</div>")}function K4c(){return P('<div class="'+R("waffle-dataconnector-draggablebar-handle")+'"><div class="'+R("waffle-dataconnector-draggablebar-handle-icon")+'"></div></div>')};function L4c(a,b){M.call(this,b);this.D=a;this.Nc=null;this.C=0}q(L4c,M);p=L4c.prototype;p.xa=function(){this.Ua=N(J4c)};p.Yc=function(a){this.Ua=a;Bh(this.Qa(),"waffle-dataconnector-draggablebar");gr(a,K4c)};
p.Ga=function(){this.Nc=new wq(this.Qa(),this.Ia("waffle-dataconnector-draggablebar-handle"));this.qa(this.Nc);this.Nc.C=!0;this.getHandler().R(this.Nc,"start",this.lNb).R(this.Nc,"drag",this.FOb).R(this.Nc,"end",this.kNb);"vertical"==this.D?(hi(this.Qa(),8),Bh(this.Qa(),"waffle-dataconnector-draggablebar-vertical")):(ki(this.Qa(),8),Bh(this.Qa(),"waffle-dataconnector-draggablebar-horizontal"))};p.bd=n(8);p.Na=function(a){this.Nc.Na(a)};p.lNb=function(){xq(this.Nc,M4c(this));this.dispatchEvent("we")};
p.FOb=function(a){this.C="vertical"==this.D?a.left:a.top;this.dispatchEvent("ue")};p.kNb=function(){this.dispatchEvent("ve")};function M4c(a){var b=a.Qa().parentElement.getBoundingClientRect(),c=b.height;b=b.width;"horizontal"==a.D?(b=0,c-=a.bd()):(c=0,b-=a.bd());return new Mh(0,0,b,c)};function N4c(a,b,c){switch(a){case 1:a:switch(b){case 2:c=WZ("Can't connect. Review login information and database name then try again.",c);break a;case 5:c=WZ("Review database or table and try again",c);break a;default:c=O4c(b,c)}return c;case 2:a:switch(b){case 9:c=new Bp;a=c.le("span",{"class":"waffle-dataconnector-error-message"})+("Go to Plx to specify an engine other than 'Auto' and try again. "+(c.le("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",
target:"_blank"})+("Learn more"+(c.ue("a")+c.ue("span")))));c=c.format(a);break a;case 2:c?(a=new Bp,b=a.le("span",{"class":"waffle-dataconnector-error-message"}),b+=a.le("span",{"class":"waffle-dataconnector-error-message-detail"}),b=b+c+a.ue("span"),b+=a.ue("span"),c=a.format(b)):c=P4c(null);break a;default:c=O4c(b,c)}return c}}
function Q4c(a){var b=new Bp;a=(new Lt("To execute this query, {startLink}sign in to your Google account{endLink}")).format({startLink:b.le("a",{href:"#",id:a}),endLink:b.ue("a")});return b.format(a)}
function O4c(a,b){switch(a){case 4:return WZ("Review query and try again",b);case 3:return WZ("Can't connect. Host not available.",b);case 6:return J(I(),"docs-idu")?(a=new Bp,b=a.le("span",{"class":"waffle-dataconnector-error-message"})+("Query timed out. "+(a.le("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",target:"_blank"})+("Learn more"+(a.ue("a")+a.ue("span"))))),a=a.format(b)):a=WZ("Query timed out",b),a;case 8:return J(I(),"docs-idu")?(a=new Bp,
b=a.le("span",{"class":"waffle-dataconnector-error-message"})+("Results exceed "+(R4c+(" rows. Update query and run again. "+(a.le("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",target:"_blank"})+("Learn more"+(a.ue("a")+a.ue("span"))))))),a=a.format(b)):a=WZ(S4c,b),a;default:return P4c(b)}}function P4c(a){return WZ("Something's wrong. Please try again later.",a)}var R4c=(new It(1)).format(1E4),S4c="Results exceed "+(R4c+" rows. Update query and run again.");
function WZ(a,b){var c=new Bp,d=c.le("span",{"class":"waffle-dataconnector-error-message"});d+=c.le("span",{"class":"waffle-dataconnector-error-message-main"});d=d+a+c.ue("span");b&&(d=d+": "+c.le("span",{"class":"waffle-dataconnector-error-message-detail"}),d=d+b+c.ue("span"));d+=c.ue("span");return c.format(d)};function T4c(a){M.call(this,a);this.F=this.oa().xa("DIV","waffle-dataconnector-dialog-error-message");this.H=this.oa().xa("DIV","waffle-dataconnector-dialog-info-message");this.J=N(P3c);this.C=new M3c;N3c(this.C,!0);this.Fa(this.C);this.D=!0}q(T4c,M);T4c.prototype.xa=function(){this.Ua=this.oa().xa("DIV","waffle-dataconnector-dialog-message-container",this.F,this.H,this.J);this.C.render(this.Ia("waffle-dataconnector-dialog-progress-bar"))};
T4c.prototype.Ga=function(){M.prototype.Ga.call(this);XZ(this);uh(this.F,"live","polite");uh(this.H,"live","polite");uh(this.J,"live","polite")};function U4c(a,b){var c=a.Ia("waffle-dataconnector-dialog-error-message");XZ(a);sd(c,b||md(""));L(c,!!b)}function XZ(a){var b=a.Ia("waffle-dataconnector-dialog-error-message");sd(b,md(""));L(b,!1);b=a.Ia("waffle-dataconnector-dialog-info-message");sd(b,md(""));L(b,!1);a.C.Pa(0);N3c(a.C,!0);L(a.Ia("waffle-dataconnector-dialog-progress-message"),!1)}
T4c.prototype.isVisible=g("D");T4c.prototype.setVisible=function(a){this.D=a;this.Qb()&&L(this.Qa(),this.D)};function V4c(a){RV.apply(this,arguments)}q(V4c,RV);V4c.prototype.La=function(){return this.C.La()};V4c.prototype.W0=function(a){this.C.Pa(a);return!0};function W4c(){var a='<div class="'+R("waffle-dataconnector-query-parameter-prompt-input-container")+'"></div><div class="'+R("waffle-dataconnector-query-parameter-prompt-toggle-row")+'"><div class="'+R("waffle-dataconnector-query-parameter-prompt-toggle-label")+'">';return P(a+"Reference cell</div></div>")};function X4c(a){qZ.call(this,"waffle-dataconnector-query-parameter-prompt",a);T2c(this,"Query Parameter");this.L=null;this.J=new NV;this.Fa(this.J);this.J.Id("waffle-dataconnector-query-parameter-prompt-primary-button");this.H=new V4c("text","Name","float","",void 0);this.Fa(this.H);this.H.Id("waffle-dataconnector-query-parameter-prompt-name-field");this.H.Ba=!0;this.H.ma=this.VWa;this.D=new V4c("text","Value","float","",void 0);this.Fa(this.D);this.D.Id("waffle-dataconnector-query-parameter-prompt-value-field");
this.D.Ba=!0;this.D.ma=this.WWa;this.F=new kR;this.Fa(this.F);this.F.Id("waffle-dataconnector-query-parameter-prompt-cell-reference-toggle")}q(X4c,qZ);p=X4c.prototype;p.rf=function(a){this.H.Pa(a)};p.Pa=function(a){this.D.Pa(a)};p.getName=function(){return this.H.La()};p.La=function(){return this.D.La()};p.clear=function(){this.H.Pa("");this.D.Pa("");SV(this.H,!1);SV(this.D,!1);this.F.rc(!1)};
p.xa=function(){qZ.prototype.xa.call(this);gr(this.Ib(),W4c);this.H.render(this.Ia("waffle-dataconnector-query-parameter-prompt-input-container"));this.D.render(this.Ia("waffle-dataconnector-query-parameter-prompt-input-container"));var a=this.Ia("waffle-dataconnector-query-parameter-prompt-toggle-label");xi(this.F,a);otc(this.F,a);this.J.render(S2c(this))};
p.Ga=function(){qZ.prototype.Ga.call(this);L(this.Yt(),!1);this.getHandler().R(this.J,"action",this.zBb).R(this.F,"change",this.MYb);otc(this.F,this.Ia("waffle-dataconnector-query-parameter-prompt-toggle-label"))};p.gj=function(a){this.L=new Gj(a,0)};p.vd=function(){this.L?this.L.vd(this.getElement(),0):qZ.prototype.vd.call(this)};p.zBb=function(a){a.stopPropagation();(a=this.VWa(this.H.La()))&&SV(this.H,!0,a);var b=this.WWa(this.D.La());b&&SV(this.D,!0,b);a||b||this.dispatchEvent("xe")};
p.MYb=function(){var a=this.F.isChecked()?"Cell reference":"Value";this.D.setContent(a)};p.VWa=function(a){return Jb(a)?"Parameter name is required":null};p.WWa=function(a){return Jb(a)?"Parameter value is required":null};p.e8=function(){this.dispatchEvent("ye")};p.a8=function(){this.dispatchEvent("ye")};function YZ(a,b){M.call(this,b);this.J=new sV(a,this.oa());this.Fa(this.J)}q(YZ,M);p=YZ.prototype;p.Xd=function(a){this.J.getHeader().rc(a)};p.setContent=function(a){this.J.setContent(a)};p.Ib=function(){return this.J.Ib()};p.xa=function(){this.Ua=this.oa().xa("DIV","waffle-dataconnector-queryeditor-collapsible-sidebar-widget");this.J.render(this.Qa())};p.Ga=function(){M.prototype.Ga.call(this);this.getHandler().R(this,["aftershow","afterhide"],function(a){return a.stopPropagation()})};function Y4c(){return P('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="none" fill-rule="evenodd"><path d="M0,0 L18,0 L18,18 L0,18 L0,0 Z M0,0 L18,0 L18,18 L0,18 L0,0 Z"/><polygon fill="#000" points="14.53 4.53 13.47 3.47 9 7.94 4.53 3.47 3.47 4.53 7.94 9 3.47 13.47 4.53 14.53 9 10.06 13.47 14.53 14.53 13.47 10.06 9"/></g></svg>')};function Z4c(){}q(Z4c,jr);Z4c.prototype.xa=function(a){a=a.oa().xa("DIV","waffle-dataconnector-close-badge");gr(a,Y4c);return a};Z4c.prototype.hc=n("waffle-dataconnector-close-badge");ta(Z4c);function $4c(){lr.call(this,void 0,Z4c.getInstance())}q($4c,lr);function a5c(){return P('<div class="'+R("waffle-dataconnector-queryeditor-removable-chip")+'"><div class="'+R("waffle-dataconnector-queryeditor-removable-chip-remove-button-wrapper")+'"></div></div>')};function ZZ(a,b){M.call(this,b);this.C=new lr(a,b5c.getInstance(),this.oa());this.Fa(this.C);this.D=new $4c;this.Fa(this.D)}q(ZZ,M);p=ZZ.prototype;p.xa=function(){this.Ua=N(a5c);this.C.render(this.getElement());this.D.render(this.Ia("waffle-dataconnector-queryeditor-removable-chip-remove-button-wrapper"));this.D.Id("waffle-dataconnector-queryeditor-removable-chip-remove-button")};
p.Ga=function(){var a=this;M.prototype.Ga.call(this);this.getHandler().R(this.C,"action",function(b){b.stopPropagation();a.dispatchEvent("ze")}).R(this.D,"action",function(b){b.stopPropagation();a.dispatchEvent("Ae")})};p.setContent=function(a){this.C.setContent(a)};p.Ib=function(){return this.C.Ib()};p.setVisible=function(a){var b=this.getElement();b&&L(b,a)};function b5c(){}q(b5c,jr);b5c.prototype.hc=n("waffle-dataconnector-queryeditor-removable-chip-button");ta(b5c);function c5c(){}function d5c(a){c5c.getInstance();var b=ritz_api.RitzModelApi.getNamedRangeIdForWorkbookRange(a);return b&&(b=ritz_api.RitzModelApi.getNamedRangeById(b))?(new xw).Ad((new kA).Ca(),b).getName():a}ta(c5c);function e5c(a,b){this.C=a;this.tQa=b}e5c.prototype.Xk=g("C");function f5c(){return P('<div class="'+R("waffle-dataconnector-queryeditor-queryparameterwidget")+'"><div class="'+R("waffle-dataconnector-queryeditor-queryparameterwidget-add-parameter-button-wrapper")+'"></div><div class="'+R("waffle-dataconnector-queryeditor-queryparameterwidget-chip-container")+'"></div></div>')}
function g5c(a){return P('<span class="'+R("waffle-dataconnector-queryparameterchip-content")+'"><span class="'+R("waffle-dataconnector-queryparameterchip-name")+'">'+O(a.name)+':</span>&nbsp;<span class="'+R("waffle-dataconnector-queryparameterchip-value")+'">'+O(a.value)+"</span></span>")};function h5c(a){YZ.call(this,"Parameters",a);this.D=new M;this.Fa(this.D);this.C=new i5c;this.F=new NV("Add Parameter");this.Fa(this.F);this.F.Id("waffle-dataconnector-queryeditor-queryparameterwidget-add-parameter-button")}q(h5c,YZ);p=h5c.prototype;
p.xa=function(){YZ.prototype.xa.call(this);this.setContent(N(f5c));this.D.hb(this.Ia("waffle-dataconnector-queryeditor-queryparameterwidget-chip-container"));this.F.render(this.Ia("waffle-dataconnector-queryeditor-queryparameterwidget-add-parameter-button-wrapper"));for(var a=ha(this.C.Dd()),b=a.next();!b.done;b=a.next())b.value.render(this.D.getElement())};p.Ga=function(){YZ.prototype.Ga.call(this);this.getHandler().R(this.D,"ze",this.ypb).R(this.D,"Ae",this.KCb).R(this.F,"action",this.Hmb)};
function j5c(a){return a.C.Dd().map(function(a){return a.Sa()})}function k5c(a,b){l5c(b);var c=b.getName();if(a.C.get(c))throw new m5c("Parameter with name '"+c+"' is\nalready defined.");b=new n5c(b,a.oa());a.C.set(c,b);a.D.Fa(b,a.Qb())}p.ypb=function(a){a.stopPropagation();this.dispatchEvent(new o5c("De",this,a.target.Sa()))};p.KCb=function(a){a.stopPropagation();this.dispatchEvent(new o5c("Ce",this,a.target.Sa()))};p.Hmb=function(a){a.stopPropagation();this.dispatchEvent(new o5c("Be",this))};
function i5c(){this.wb={}}p=i5c.prototype;p.get=function(a){return this.wb["P_"+a.toUpperCase()]||null};p.has=function(a){return!!this.wb["P_"+a.toUpperCase()]};p.set=function(a,b){this.wb["P_"+a.toUpperCase()]=b};p.Dd=function(){return Object.values(this.wb)};p.clear=function(){for(var a=Object.keys(this.wb),b=0;b<a.length;b++)delete this.wb[a[b]]};function n5c(a,b){ZZ.call(this,p5c(a),b);ZZ.prototype.Uc.call(this,a.clone())}q(n5c,ZZ);
n5c.prototype.Uc=function(a){ZZ.prototype.Uc.call(this,a.clone());this.setContent(p5c(a))};n5c.prototype.Sa=function(){return ZZ.prototype.Sa.call(this).clone()};function l5c(a){var b=a.getName();if(!b)throw new q5c("Parameters must have a name");var c=V(a,2);a=V(a,3);if(!c&&!a)throw new q5c("Parameter with name '"+b+"'has neither a\nconstant value or workbookrange id set.");if(c&&a)throw new q5c("Parameter with name '"+b+"' has both a\nconstant value and workbookrange id set.");}
function p5c(a){var b=a.getName().toUpperCase(),c=V(a,3);a=c?d5c(c):V(a,2);return N(g5c,{name:b,value:a})}function q5c(a){var b=Error.apply(this,arguments);this.message=b.message;"stack"in b&&(this.stack=b.stack)}q(q5c,Error);function m5c(a){var b=Error.apply(this,arguments);this.message=b.message;"stack"in b&&(this.stack=b.stack)}q(m5c,Error);function r5c(a){var b=Error.apply(this,arguments);this.message=b.message;"stack"in b&&(this.stack=b.stack)}q(r5c,Error);
function o5c(a,b,c){D.call(this,a,b);this.C=c}q(o5c,D);function s5c(a,b){E.call(this);this.H=new Ih(this);this.qa(this.H);this.F=new Ih(this);this.qa(this.F);this.D=a;this.C=b}q(s5c,E);p=s5c.prototype;p.Kf=function(){this.C.gj(this.D.Qa());this.C.vd();this.H.R(this.D,"Be",this.rIb).R(this.D,"Ce",this.sIb).R(this.D,"De",this.tIb)};p.rIb=function(){this.C.setVisible(!0);this.C.J.setContent("Add");this.F.R(this.C,"xe",this.BLb).R(this.C,"ye",this.a4)};
p.tIb=function(a){a=a.C;this.C.setVisible(!0);this.C.rf(a.getName());var b=V(a,2),c=V(a,3);b?(this.C.Pa(b),this.C.F.rc(!1)):c&&(this.C.Pa(d5c(c)),this.C.F.rc(!0));this.C.J.setContent("Update");t5c(this,a)};p.BLb=function(){var a=this.C.getName(),b=this.C.La();if(!this.D.C.has(a)){var c=this.C.F.isChecked();if(a=u5c(this,a,b,c))k5c(this.D,a),this.a4(),this.dispatchEvent("Ge")}};
function t5c(a,b){var c=b.getName();a.F.R(a.C,"xe",function(){var b=a.C.getName(),e=a.C.La();if(b==c||!a.D.C.has(b)){var f=a.C.F.isChecked();if(b=u5c(a,b,e,f)){e=a.D;l5c(b);f=b.getName();if(!e.C.get(c))throw new r5c;if(f.toUpperCase()!=c.toUpperCase()&&e.C.get(f))throw new m5c;var h=e.C.get(c);h.Uc(b);f!=c&&(delete e.C.wb["P_"+c.toUpperCase()],e.C.set(f,h));a.a4();a.dispatchEvent("Ge")}}}).R(a.C,"ye",a.a4)}
p.sIb=function(a){a=a.C.getName();this.D.C.has(a);var b=this.D,c=b.C.get(a);if(!c)throw new r5c;b.D.removeChild(c,b.Qb());delete b.C.wb["P_"+a.toUpperCase()];C(c);this.dispatchEvent("Ge")};p.a4=function(){this.C.setVisible(!1);this.C.clear();this.F.Jc()};
function u5c(a,b,c,d){if(d){c5c.getInstance();d=ritz_api.DbxApi.parseQueryParameterRange(c);c=ritz_api.DbxApi.getErrorForParameterRangeParseResult(d);var e=ritz_api.DbxApi.getGridRangeForParameterRangeParseResult(d);null!=e&&EQ(e);d=ritz_api.DbxApi.getNamedRangeWorkbookRangeIdForParameterRangeParseResult(d);c=new e5c(c,d);c.Xk()?(b=a.C,a=c.Xk(),null==a?SV(b.D,!1):SV(b.D,!0,a),b=null):c.tQa?(a=c.tQa,c=new uZ,c.rf(b),W(c,3,a),b=c):b=void 0}else a=new uZ,a.rf(b),W(a,2,c),b=a;return b};function v5c(){return P('<div class="'+R("waffle-dataconnector-querypreviewrenderer")+'"><div class="'+R("waffle-dataconnector-querypreviewrenderer-canvas-wrapper")+'"></div><div class="'+R("waffle-dataconnector-querypreviewrenderer-canvas-overlay")+'"><div class="'+R("waffle-dataconnector-querypreviewrenderer-overlay-text")+'"></div></div></div>')};function $Z(a,b){M.call(this,b);this.J=a;this.C=this.oa().xa("CANVAS");pN(this.C);this.F=oN(this.C);this.L=ritz_api.DbxApi.createGridViewModel(101,24);this.D=ritz_api.DbxApi.createGridView(this.L,this.F,this.J.D,this.J.C);qN(this.C,this.F,800,243);w5c(this);this.Pc=new xw;this.H=!0}q($Z,M);$Z.prototype.xa=function(){this.Ua=N(v5c);var a=this.Ia("waffle-dataconnector-querypreviewrenderer-canvas-wrapper");a.appendChild(this.C);Bh(a,"native-scrollbar");Bh(a,"native-scrollbar-ltr")};
$Z.prototype.Ga=function(){M.prototype.Ga.call(this);L(this.Qa(),this.H)};$Z.prototype.Ea=function(){M.prototype.Ea.call(this)};$Z.prototype.setVisible=function(a){this.H=a;this.Qb()&&L(this.Qa(),this.H)};function w5c(a){a.F.fillStyle="#f3f3f3";a.F.fillRect(0,0,a.C.width,a.C.height)};function x5c(){var a='<div class="'+R("waffle-dataconnector-sqleditor")+'"><div class="'+R("waffle-dataconnector-sqleditor-textareawrapper")+'"><div class="'+R("waffle-dataconnector-sqleditor-overlay")+'"><div class="'+R("waffle-dataconnector-sqleditor-overlay-message")+'"></div></div><textarea class="'+R("waffle-dataconnector-sqleditor-textarea")+'" spellcheck="false" aria-label="';a+=vr("Enter your query");a+='"></textarea><div class="'+R("waffle-dataconnector-sqleditor-linegutter")+'"></div></div></div>';
return P(a)};function a_(a,b){a=void 0===a?"":a;M.call(this,b);this.Td=!0;this.D=!1;this.J=a;this.F=this.C=null;this.H=new YU;this.Fa(this.H)}q(a_,M);a_.prototype.xa=function(){this.Ua=N(x5c)};
a_.prototype.Ga=function(){var a=this;M.prototype.Ga.call(this);this.C=this.Ia("waffle-dataconnector-sqleditor-textarea");this.C.value=this.J;this.F=new Bs(this.C);this.qa(this.F);this.F.Qd(this);this.getHandler().R(this.C,"focus",function(){return y5c(a,!0)}).R(this.C,"blur",function(){return y5c(a,!1)});this.H.render(this.Ia("waffle-dataconnector-sqleditor-textareawrapper"));z5c(this);A5c(this,!1)};
function z5c(a){a.C.disabled=!a.Td||a.D;Fh(a.Qa(),"waffle-dataconnector-sqleditor-disabled",!a.Td||a.D);ZU(a.H,a.D)}a_.prototype.Na=function(a){this.D||a==this.Td||(this.Td=a,this.Qb()&&z5c(this))};a_.prototype.isEnabled=g("Td");function B5c(a){a.D=!0;a.Qb()&&z5c(a)}function C5c(a,b){sd(a.Ia("waffle-dataconnector-sqleditor-overlay-message"),b);A5c(a,!0)}function A5c(a,b){L(a.Ia("waffle-dataconnector-sqleditor-overlay"),b)}function y5c(a,b){Fh(a.Qa(),"waffle-dataconnector-sqleditor-focused",b)}
function D5c(a,b){a.isDisposed()||(a.D=!1,a.Qb()?(a.C.value=b,z5c(a)):a.J=b)};function E5c(){A.call(this);this.C=mB("win")}q(E5c,A);function F5c(a,b){a.C.dataConnectorOnCompleteAuth=b;b=(new ul(a.C.location.href)).resolve(new ul("dbx/ssoLogin")).toString();var c=Ud();(a=Dp(b,{target:"google_popup",width:500,height:500,top:Math.floor((c.height-500)/2),left:Math.floor((c.width-500)/2),toolbar:!1,menubar:!1,location:!1,statusbar:!1},a.C))&&a.focus()}E5c.prototype.Ea=function(){delete this.C.dataConnectorOnCompleteAuth;A.prototype.Ea.call(this)};var G5c=new It(1);function H5c(a,b){var c=V(a,3);return b?V(a,4)?"Query returns: more than "+(G5c.format(c)+(" rows of data. Please revise your query to return no more than "+(G5c.format(1E4)+" rows."))):"Query returns: "+(G5c.format(c)+(" rows of data. Please revise your query to return no more than "+(G5c.format(1E4)+" rows."))):(new Lt("{TOTAL_ROWS, plural, =0 {Query returns no results.}=1 {Query returns: 1 row of data.}other {Query returns: # rows of data.}}")).format({TOTAL_ROWS:c})};function I5c(){return P('<div class="'+R("waffle-dataconnector-newqueryeditor-content")+'"><div class="'+R("waffle-dataconnector-newqueryeditor-main")+'"><div class="'+R("waffle-dataconnector-newqueryeditor-editor-pane")+'"></div><div class="'+R("waffle-dataconnector-newqueryeditor-preview-resize-bar")+'"></div><div class="'+R("waffle-dataconnector-newqueryeditor-preview-pane")+'"><div class="'+R("waffle-dataconnector-newqueryeditor-preview-canvas-wrapper")+'"></div><div class="'+R("waffle-dataconnector-newqueryeditor-preview-overlay")+
'"><div class="'+R("waffle-dataconnector-newqueryeditor-preview-overlay-text")+'"></div></div></div></div><div class="'+R("waffle-dataconnector-newqueryeditor-sidebar")+'"></div></div>')}
function J5c(){return P('<div class="'+R("waffle-dataconnector-newqueryeditor-footer")+'"><div class="'+R("waffle-dataconnector-newqueryeditor-message-wrapper")+'"></div><div class="'+R("waffle-dataconnector-newqueryeditor-insert-button-wrapper")+'"></div><div class="'+R("waffle-dataconnector-newqueryeditor-preview-button-wrapper")+'"></div></div>')};function b_(a,b,c,d,e,f){qZ.call(this,"waffle-dataconnector-newqueryeditor",f);this.Hb=a;this.Sb=b;this.Zb=c;this.ma=new NV("Preview query");this.ma.Id("waffle-dataconnector-newqueryeditor-preview-query-button");this.Fa(this.ma);this.O=new MV("Insert raw data");this.O.Id("waffle-dataconnector-newqueryeditor-execute-query-button");this.Fa(this.O);this.F=new a_(void 0,this.oa());this.Fa(this.F);this.va=new h5c(this.oa());this.Fa(this.va);this.jb=new X4c(this.oa());this.qa(this.jb);this.ub=new s5c(this.va,
this.jb);this.qa(this.ub);this.Ra=d;this.Fa(this.Ra);this.D=new T4c(this.oa());this.Fa(this.D);this.J=new L4c("horizontal",this.oa());this.qa(this.J);this.Wa=this.L=!1;this.Oa=null;this.Bb=e||new E5c;this.qa(this.Bb);this.Ba=null}q(b_,qZ);
function K5c(a,b){a.F.Na(!1);b.then(function(b){if(b){for(var c=tw(b,3),e=a.va,f=ha(e.C.Dd()),h=f.next();!h.done;h=f.next())h=h.value,e.D.removeChild(h,e.Qb()),C(h);e.C.clear();c=ha(c);for(f=c.next();!f.done;f=c.next())k5c(e,f.value)}a.E9(b)},function(){a.E9(null)})}function L5c(a){var b=a.Nja(),c;if(c=b){a=ha(j5c(a.va));for(c=a.next();!c.done;c=a.next())qw(b,3,c.value);c=b}return c}p=b_.prototype;p.sRa=function(){this.L=!0;XZ(this.D);M5c(this,md("Executing query"));c_(this)};
p.oRa=function(a,b){this.L=!1;this.Oa=b;this.Wa=N5c(a);O5c(this,a);b=this.Ra;a=V(a,2);a=b.Pc.serialize(a);ritz_api.DbxApi.setQueryResult(b.D,a);a=ritz_api.DbxApi.getWidth(b.D);var c=ritz_api.DbxApi.getHeight(b.D),d=ritz_api.GridViewApi.getHeaderDepth(b.D,"COLUMNS"),e=ritz_api.GridViewApi.getHeaderDepth(b.D,"ROWS"),f=a+e,h=c+d;b.C.style.width=f;b.C.style.height=h;qN(b.C,b.F,f,h);w5c(b);ritz_api.GridViewApi.renderOriginView(b.D,0,0);ritz_api.GridViewApi.renderHeaderView(b.D,"ROWS",0,c,0,d,null,null);
ritz_api.GridViewApi.renderHeaderView(b.D,"COLUMNS",0,a,e,0,null,null);ritz_api.GridViewApi.renderGridView(b.D,0,0,a,c,e,d,null,null);L(b.Ia("waffle-dataconnector-querypreviewrenderer-canvas-overlay"),!1);b=Math.min(li(this.Ra.C).height+16,240);var k=void 0===k?!0:k;C(this.Ba);this.Ba=null;k?(k=li(this.Ia("waffle-dataconnector-newqueryeditor-preview-pane")).height,this.Ba=new P5c(k,b,200,this),this.qa(this.Ba),this.Ba.play()):Q5c(this,b);c_(this)};
p.nRa=function(a){a=a.Hg();M5c(this,md("Executing query"),V(a,5))};p.mRa=function(a){this.L=!1;XZ(this.D);a&&10==V(a.Hg(),2)?R5c(this):(a=S5c(this,a),U4c(this.D,a));c_(this)};p.fpa=function(){this.L=!0;XZ(this.D);M5c(this,md("Updating workbook"));c_(this)};p.dpa=function(){this.L=!1};p.cpa=function(a){a=a.Hg();M5c(this,md("Updating workbook"),V(a,5))};p.bpa=function(){this.L=!1;XZ(this.D);var a=S5c(this,void 0);U4c(this.D,a);c_(this)};
p.xa=function(){qZ.prototype.xa.call(this);gr(this.Ib(),I5c);var a=S2c(this);gr(a,J5c)};
p.Ga=function(){var a=this;qZ.prototype.Ga.call(this);this.F.render(this.Ia("waffle-dataconnector-newqueryeditor-editor-pane"));this.O.render(this.Ia("waffle-dataconnector-newqueryeditor-insert-button-wrapper"));this.ma.render(this.Ia("waffle-dataconnector-newqueryeditor-preview-button-wrapper"));this.D.render(this.Ia("waffle-dataconnector-newqueryeditor-message-wrapper"));this.Ra.render(this.Ia("waffle-dataconnector-newqueryeditor-preview-pane"));this.va.render(T5c(this));this.jb.render();this.ub.Kf();
this.J.hb(this.Ia("waffle-dataconnector-newqueryeditor-preview-resize-bar"));this.getHandler().R(this.J,["ue","ve"],function(){var b=a.Ia("waffle-dataconnector-newqueryeditor-editor-pane");ki(b,a.J.C);var c=a.Ia("waffle-dataconnector-newqueryeditor-main");b=a.Ia("waffle-dataconnector-newqueryeditor-preview-pane");c=li(c).height-a.J.C-a.J.bd();ki(b,c)}).R(this.ma,"action",this.tRb).R(this.O,"action",this.Pgb).R(this.ub,"Ge",this.zPb).R(this.F,"input",function(){c_(a)});U5c(this,md("No preview available"))};
p.Ea=function(){qZ.prototype.Ea.call(this)};function T5c(a){return a.Ia("waffle-dataconnector-newqueryeditor-sidebar")}function Q5c(a,b){var c=a.Ia("waffle-dataconnector-newqueryeditor-main");b=li(c).height-a.J.bd()-b;a=a.J;xq(a.Nc,M4c(a));a.C="vertical"==a.D?oCa(a.Nc,b):pCa(a.Nc,b);c=ha("vertical"==a.D?[a.C,0]:[0,a.C]);b=c.next().value;c=c.next().value;KM(a.Qa(),b,c,a.Ke());a.dispatchEvent("ue")}p.zPb=function(){c_(this)};
function c_(a){var b=L5c(a);if(a.L||null==b)a.O.Na(!1),a.ma.Na(!1);else{a.ma.Na(!0);var c=!!a.Oa;b=!!a.Oa&&a.Oa.equals(b);var d=!!a.Wa;a.O.Na(!c||b&&!d)}}p.tRb=function(){dC.Wb(V5c(this))};p.Pgb=function(){var a=L5c(this);this.Sb.Wb(this.Zb(a))};function V5c(a){var b=new CZ;W(b,1,a.Hb);a=L5c(a);W(b,2,a);W(b,3,30);return b}function S5c(a,b){var c=b?V(b.Hg(),2):1;b=b?V(b.Hg(),3):null;return N4c(a.Boa(),c,b)}
function O5c(a,b){var c=0;a.D.C.D||(M5c(a,md("Executing query"),100),c=1500);Ji(function(){if(!a.isDisposed()){XZ(a.D);var c=md(H5c(b,a.Wa));N5c(b)?U4c(a.D,c):U5c(a,c)}},c)}function U5c(a,b){a=a.D;var c=a.Ia("waffle-dataconnector-dialog-info-message");XZ(a);sd(c,b||md(""));L(c,!!b)}function M5c(a,b,c){a=a.D;sd(a.Ia("waffle-dataconnector-dialog-progress-label"),b);null!=c&&O3c(a.C,c);L(a.Ia("waffle-dataconnector-dialog-progress-message"),!0)}
function R5c(a){var b="waffle-dataconnector-ssologin-"+Zb(),c=Q4c(b);U4c(a.D,c);(b=Od(b))&&a.getHandler().R(b,"click",function(){return W5c(a)})}function W5c(a){F5c(a.Bb,function(){dC.Wb(V5c(a))})}function P5c(a,b,c,d){qt.call(this,[a],[b],c);this.F=d}q(P5c,qt);P5c.prototype.Y_=function(){Q5c(this.F,this.coords[0])};P5c.prototype.HS=function(){Q5c(this.F,this.TP[0])};function N5c(a){return 1E4<V(a,3)||!!V(a,4)};function X5c(a){this.C=a}function Y5c(a,b){return new l4c(b,function(b){return z4c(a.C,b)},function(a){if(4==a.Hg().getState()||1==a.Hg().getState()){var b=new AZ;a=a.Hg().getToken();W(b,3,a);return b}return null})}function Z5c(a,b){return new l4c(b,function(b){return D4c(a.C,b)},function(a){if(4==a.Hg().getState()||1==a.Hg().getState()){var b=new KZ;a=a.Hg().getToken();W(b,3,a);return b}return null})}
function $5c(a,b){return new l4c(b,function(b){return B4c(a.C,b)},function(a){if(1==a.Hg().getState()){var b=new CZ;a=a.Hg().getToken();W(b,4,a);return b}return null})}function a6c(a,b){return new l4c(b,function(b){return C4c(a.C,b)},function(a){if(4==a.Hg().getState()||1==a.Hg().getState()){var b=new FZ;a=a.Hg().getToken();W(b,2,a);return b}return null})};function b6c(){return P('<div class="'+R("waffle-dataconnector-queryeditor-content")+'"><div class="'+R("waffle-dataconnector-queryeditor-editor-pane")+'"></div><div class="'+R("waffle-dataconnector-queryeditor-preview-pane")+'"><div class="'+R("waffle-dataconnector-queryeditor-preview-canvas-wrapper")+'"></div><div class="'+R("waffle-dataconnector-queryeditor-preview-overlay")+'"><div class="'+R("waffle-dataconnector-queryeditor-preview-overlay-text")+'"></div></div></div></div>')};function c6c(a,b,c,d,e,f,h,k){SZ.call(this,f,h);var l=this;Cq(this,"Query Editor");S3c(this);this.Lc=a;this.C=b;this.Fa(this.C);this.Ba=c;this.Wc=d;this.Bb=e;this.J=this.oa().xa("CANVAS");pN(this.J);this.va=oN(this.J);this.ub=ritz_api.DbxApi.createGridViewModel(101,24);this.F=ritz_api.DbxApi.createGridView(this.ub,this.va,this.Bb.D,this.Bb.C);qN(this.J,this.va,800,243);d6c(this);Q3c(this,this.Ba,function(){return l.Wc(e6c(l.C))});R3c(this);this.Pc=new xw;this.ma=null;this.Oa=!1;this.xb=k||new E5c;
this.qa(this.xb);this.L=!1;this.zc=new f6c(this);this.qa(this.zc)}q(c6c,SZ);p=c6c.prototype;p.xa=function(){SZ.prototype.xa.call(this);gr(this.Ib(),b6c)};
p.Ga=function(){var a=this;SZ.prototype.Ga.call(this);this.C.render(this.Ia("waffle-dataconnector-queryeditor-editor-pane"));kj(this.Wa,this.C.L,dC,mj,function(){return g6c(a)});this.getHandler().R(this.C,"He",this.Bsa);var b=this.Ia("waffle-dataconnector-queryeditor-preview-canvas-wrapper");b.appendChild(this.J);Bh(b,"native-scrollbar");Bh(b,"native-scrollbar-ltr");h6c(this,!1);TZ(this);this.Bsa();i6c(this.C,"Only users with edit access can view and edit the query")};
p.Ea=function(){SZ.prototype.Ea.call(this);delete this.ub;delete this.F};p.sRa=function(){this.L=!0;L(this.Ia("waffle-dataconnector-queryeditor-preview-overlay-text"),!1);TZ(this);V3c(this,"Executing query");j6c(this)};
p.oRa=function(a,b){this.L=!1;this.ma=b;this.Oa=k6c(a);l6c(this,a);a=V(a,2);a=this.Pc.serialize(a);ritz_api.DbxApi.setQueryResult(this.F,a);a=ritz_api.DbxApi.getWidth(this.F);b=ritz_api.DbxApi.getHeight(this.F);var c=ritz_api.GridViewApi.getHeaderDepth(this.F,"COLUMNS"),d=ritz_api.GridViewApi.getHeaderDepth(this.F,"ROWS"),e=a+d,f=b+c;this.J.style.width=e;this.J.style.height=f;qN(this.J,this.va,e,f);d6c(this);ritz_api.GridViewApi.renderOriginView(this.F,0,0);ritz_api.GridViewApi.renderHeaderView(this.F,
"ROWS",0,b,0,c,null,null);ritz_api.GridViewApi.renderHeaderView(this.F,"COLUMNS",0,a,d,0,null,null);ritz_api.GridViewApi.renderGridView(this.F,0,0,a,b,d,c,null,null);m6c(this,!1);j6c(this);i6c(this.C,"All users with view access can view query results in the workbook.");h6c(this,!0)};function l6c(a,b){var c=0;a.O.D||(V3c(a,"Executing query",100),c=1500);Ji(function(){if(!a.isDisposed()){TZ(a);n6c(a);var c=md(H5c(b,a.Oa));k6c(b)?T3c(a,c):U3c(a,c)}},c)}
p.nRa=function(a){a=a.Hg();V3c(this,"Executing query",V(a,5))};p.mRa=function(a){this.L=!1;TZ(this);a&&10==V(a.Hg(),2)?o6c(this):T3c(this,p6c(a));this.Bsa()};function o6c(a){var b="waffle-dataconnector-ssologin-"+Zb(),c=Q4c(b);T3c(a,c);(b=Od(b))&&a.getHandler().R(b,"click",function(){return q6c(a)})}function q6c(a){F5c(a.xb,function(){dC.Wb(g6c(a))})}
function n6c(a){var b=e6c(a.C);if(b&&a.ma&&!b.equals(a.ma)){b=new Bp;var c="This preview is out of date."+(b.le("br")+"Please re-run your query.");b=b.format(c);m6c(a,!0);sd(a.Ia("waffle-dataconnector-queryeditor-preview-overlay-text"),b);L(a.Ia("waffle-dataconnector-queryeditor-preview-overlay-text"),!0)}else m6c(a,!1)}p.Bsa=function(){n6c(this);j6c(this)};
function j6c(a){var b=e6c(a.C);if(a.L||null==b)a.Ba.Na(!1),dC.Na(!1);else{dC.Na(!0);var c=!!a.ma;b=!!a.ma&&a.ma.equals(b);var d=!!a.Oa;a.Ba.Na(!c||b&&!d)}}function m6c(a,b){Fh(a.Ia("waffle-dataconnector-queryeditor-preview-pane"),"waffle-dataconnector-queryeditor-preview-inactive",b)}p.fpa=function(){this.L=!0;TZ(this);V3c(this,"Updating workbook");j6c(this)};p.dpa=function(){this.L=!1};p.cpa=function(a){a=a.Hg();V3c(this,"Updating workbook",V(a,5))};
p.bpa=function(){this.L=!1;TZ(this);T3c(this,p6c(void 0));j6c(this)};function p6c(a){var b=a?V(a.Hg(),2):1;a=a?V(a.Hg(),3):null;return N4c(2,b,a)}function g6c(a){var b=new CZ;W(b,1,a.Lc);a=e6c(a.C);W(b,2,a);W(b,3,30);return b}function d6c(a){a.va.fillStyle="#f3f3f3";a.va.fillRect(0,0,a.J.width,a.J.height)}function h6c(a,b){b!=oi(a.Ia("waffle-dataconnector-queryeditor-preview-pane"))&&(b?a.zc.play():L(a.Ia("waffle-dataconnector-queryeditor-preview-pane"),!1))}
function k6c(a){return 1E4<V(a,3)||!!V(a,4)}function r6c(a){M.apply(this,arguments)}q(r6c,M);function i6c(a,b){var c=J(I(),"docs-idu");c&&(b+=" ");var d=a.Ia("waffle-dataconnector-queryeditor-sharing-message");ee(d);b=a.oa().xa("SPAN",void 0,b);d.appendChild(b);c&&(a=a.oa().xa("A",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/sharing",target:"_blank"},"Learn more"),d.appendChild(a))}function f6c(a){qt.call(this,[0],[1],350);this.F=a}q(f6c,qt);
f6c.prototype.JS=function(){var a=this.F.Ia("waffle-dataconnector-queryeditor-preview-pane");L(a,!0);ki(a,0)};f6c.prototype.Y_=function(){var a=this.rk,b=this.F.Ia("waffle-dataconnector-queryeditor-preview-pane");ki(b,243*a);this.F.vd()};function s6c(){return P('<div class="'+R("waffle-dataconnector-bigquery-query-settings-widget")+'"><div class="'+R("waffle-dataconnector-bigquery-query-settings-widget-project-section")+'"></div></div>')};function t6c(a,b,c){b=c||b;a='<div class="'+R("waffle-dataconnector-queryeditor-query-settings-header")+'">'+O(Ds({icon:rr("docs-icon-img docs-icon-settings")},b))+'<span class="'+R("waffle-dataconnector-queryeditor-query-settings-title")+'">';return P(a+"Query Settings</span></div>")};function u6c(a,b){YZ.call(this,N(t6c),b);b=a.C;a=a.D;this.C=new wV;this.C.setContent("Billing project");for(var c=0,d=0;d<b.length;d++){var e=b[d];this.C.yd(new Bk(e.getName(),e));null!=a&&e.getId()==a&&(c=d)}this.C.jf(c);this.Fa(this.C)}q(u6c,YZ);u6c.prototype.xa=function(){YZ.prototype.xa.call(this);this.setContent(N(s6c));this.C.render(this.Ia("waffle-dataconnector-bigquery-query-settings-widget-project-section"))};
u6c.prototype.Ga=function(){var a=this;YZ.prototype.Ga.call(this);this.getHandler().R(this.C,"change",function(b){b.stopPropagation();a.dispatchEvent("Ie")});this.Xd(!0);this.C.np();this.Xd(!1)};function v6c(a,b,c,d,e,f,h){b_.call(this,b,c,d,e,f,h);T2c(this,"BigQuery query editor");this.H=new u6c(a,this.oa());this.Fa(this.H)}q(v6c,b_);v6c.prototype.xa=function(){b_.prototype.xa.call(this);this.H.render(T5c(this))};v6c.prototype.Nja=function(){var a=this.F.C.value;if(!a)return null;var b=new tZ,c=this.H.C.We().La().getId();W(b,1,a);W(b,2,c);a=new vZ;W(a,4,b);return a};
v6c.prototype.E9=function(a){var b=V(a,4);D5c(this.F,V(b,1));a:{a=this.H;b=b.TB();for(var c=a.C.Fi(),d=0;d<c;d++)if(a.C.hf(d).La().getId()==b){a.C.jf(d);break a}}};v6c.prototype.Boa=n(3);function w6c(a){var b='<div class="'+R("waffle-dataconnector-jdbc-query-settings-widget")+'"><div class="'+R("waffle-dataconnector-jdbc-query-settings-widget-connection-name-section")+'"><div class="'+R("waffle-dataconnector-jdbc-query-settings-widget-connection-name-label")+'">';b=b+"Connection name:"+('</div><div class="'+R("waffle-dataconnector-jdbc-query-settings-widget-connection-name")+'">'+O(a.gP)+"</div></div></div>");return P(b)};function x6c(a,b){YZ.call(this,N(t6c),b);this.C=a}q(x6c,YZ);x6c.prototype.xa=function(){YZ.prototype.xa.call(this);this.setContent(N(w6c,{gP:this.C}))};function y6c(){return P('<div class="'+R("waffle-dataconnector-schemamenu")+'"><div class="'+R("waffle-dataconnector-schemamenu-content")+'"></div></div>')};function z6c(a){ik.apply(this,arguments)}q(z6c,ik);z6c.prototype.xa=function(){return N(y6c)};z6c.prototype.hc=n("waffle-dataconnector-schemamenu");z6c.prototype.Ib=function(a){return Sd("waffle-dataconnector-schemamenu-content",a)};ta(z6c);function A6c(a){return P('<div class="'+R("waffle-dataconnector-tablesubmenu")+'"><div class="'+R("waffle-dataconnector-tablesubmenu-tablename")+'">'+O(a.OXb)+'</div><div class="'+R("waffle-dataconnector-tablesubmenu-columnwrapper")+'"></div></div>')}function B6c(a){return P('<li class="'+R("waffle-dataconnector-tablesubmenu-column")+'">'+O(a.columnName)+"</li>")};function C6c(){}q(C6c,Ci);C6c.prototype.xa=function(a){return N(A6c,{OXb:a.getContent()})};C6c.prototype.hc=n("waffle-dataconnector-tablesubmenu");function D6c(a,b,c){var d=Xd("UL","waffle-dataconnector-tablesubmenu-columns");z(c,function(a){a=N(B6c,{columnName:a});d.appendChild(a)});Uca(b.Ib(),d)}ta(C6c);function E6c(a,b){var c=a.getName();if(V(a,2)){var d=V(a,2);F6c.contains(d)||(c=d+"."+c)}jk.call(this,c,C6c.getInstance(),b);this.Ze(64,!0);this.Ze(1,!1);this.Ze(32,!1);this.J=a;this.H=0;this.C=null}q(E6c,jk);E6c.prototype.Ga=function(){jk.prototype.Ga.call(this);this.Ib().style.H="initial"};E6c.prototype.Nd=function(){return jk.prototype.Nd.call(this)};E6c.prototype.Ib=function(){return this.yb("waffle-dataconnector-tablesubmenu-columnwrapper")};
E6c.prototype.Xh=function(a){pe(this.Ia("waffle-dataconnector-tablesubmenu-columnwrapper"),a.target)||jk.prototype.Xh.call(this,a)};var F6c=new Pm(["dbo","public"]);function G6c(a,b,c){uk.call(this,"vertical",z6c.getInstance(),c);this.H=a;this.J=b;this.C=0;this.D=new YU;this.qa(this.D)}q(G6c,uk);G6c.prototype.Ga=function(){uk.prototype.Ga.call(this);this.D.render(this.getElement())};
G6c.prototype.tLa=function(a){var b=this,c=a.target;2!=c.H&&1!=c.H&&(H6c(this.J,this.H,c.J).then(function(a){b.isDisposed()||c.isDisposed()||(a=tw(a,4),D6c(c.Nd(),c,a),c.H=2,C(c.C),c.C=null)},function(){c.H=0;C(c.C);c.C=null}),c.H=1,c.C=new YU,c.Fa(c.C),c.C.render(c.getElement()),ZU(c.C,!0))};function I6c(a){2!=a.C&&1!=a.C&&(J6c(a),K6c(a.J,a.H).then(function(b){a.isDisposed()||(b=tw(b,4),L6c(a,b))},function(){a.C=0;ZU(a.D,!1)}))}
function L6c(a,b){z(b,function(b){b=new E6c(b);b.render(a.Ib());a.Fa(b)});M6c(a)}function J6c(a){a.C=1;ZU(a.D,!0)}function M6c(a){a.C=2;ZU(a.D,!1)}G6c.prototype.Ib=function(){return this.Ia("waffle-dataconnector-schemamenu-content")};function N6c(a,b,c){YZ.call(this,"Schema",c);this.C=new G6c(a,b,c);this.Fa(this.C)}q(N6c,YZ);N6c.prototype.xa=function(){YZ.prototype.xa.call(this);this.C.render(this.Ib())};function O6c(a,b,c,d,e,f,h,k){b_.call(this,a,c,d,e,h,k);T2c(this,"Jdbc query editor");this.Cb=new x6c(b);this.Fa(this.Cb);this.H=new N6c(a,f,this.oa());this.Fa(this.H)}q(O6c,b_);p=O6c.prototype;p.xa=function(){b_.prototype.xa.call(this);this.Cb.render(T5c(this));this.H.render(T5c(this))};p.Ga=function(){b_.prototype.Ga.call(this);I6c(this.H.C)};p.Nja=function(){var a=this.F.C.value;if(!a)return null;var b=new vZ;W(b,1,a);return b};p.E9=function(a){a=a?V(a,1):"";D5c(this.F,a);this.F.Na(!0)};
p.Boa=n(1);function P6c(){var a='<div class="'+R("waffle-dataconnector-plx-query-settings-widget")+'"><div class="'+R("waffle-dataconnector-plx-query-settings-widget-engine-section")+'"></div><div class="'+R("waffle-dataconnector-plx-query-settings-widget-script-section")+'"><div class="'+R("waffle-dataconnector-plx-query-settings-widget-script-label")+'">';a=a+"External script"+('</div><div class="'+R("waffle-dataconnector-plx-query-settings-widget-script-chip-wrapper")+'"></div><div class="'+R("waffle-dataconnector-plx-query-settings-widget-script-button-wrapper")+
'"></div></div></div>');return P(a)};function Q6c(a){YZ.call(this,N(t6c),a);this.F="";this.D=new ZZ(this.F);this.Fa(this.D);this.D.C.Rd("Click to open the Plx script editor");this.D.D.Rd("Unlink this Plx script");this.H=new NV("Add existing script");this.Fa(this.H);this.H.Id("waffle-dataconnector-plx-query-settings-widget-link-script-button");this.C=new wV;this.C.setContent("Engine");a=ha(nc(R6c));for(var b=a.next();!b.done;b=a.next())b=b.value,this.C.yd(new Bk(b.caption,b.value));this.C.jf(0);this.Fa(this.C);this.L=new Un;this.qa(this.L)}
q(Q6c,YZ);Q6c.prototype.xa=function(){YZ.prototype.xa.call(this);this.setContent(N(P6c));this.C.render(this.Ia("waffle-dataconnector-plx-query-settings-widget-engine-section"));this.D.render(this.Ia("waffle-dataconnector-plx-query-settings-widget-script-section"));this.H.render(this.Ia("waffle-dataconnector-plx-query-settings-widget-script-button-wrapper"))};
Q6c.prototype.Ga=function(){var a=this;YZ.prototype.Ga.call(this);this.getHandler().R(this.H,"action",function(b){b.stopPropagation();a.dispatchEvent("Je")}).R(this.D,"Ae",function(b){b.stopPropagation();a.dispatchEvent("Le")}).R(this.D,"ze",function(b){b.stopPropagation();Dp(O2c(a.F),{target:"_blank"})}).R(this.C,"change",function(b){b.stopPropagation();a.dispatchEvent("Me")});this.Xd(!0);this.C.np();this.Xd(!1);S6c(this)};
function S6c(a){var b=!!a.F;b&&a.D.setContent(a.F);a.D.setVisible(b);a.H.setVisible(!b);a.H.Na(!b);a.C.Na(!b)}var T6c=Object.freeze({caption:"Dremel",value:"DREMEL"}),U6c=Object.freeze({caption:"F1",value:"F1"}),V6c=Object.freeze({caption:"Procella",value:"PROCELLA"}),R6c={F_a:T6c,d0a:U6c,V2a:V6c};function W6c(){return P('<div class="'+R("docs-material-labeled-text-field")+'"><div class="'+R("docs-material-labeled-text-field-content")+'"></div><input type="text" class="'+R("docs-material-labeled-text-field-input")+'"></div>')};function X6c(){}q(X6c,TV);p=X6c.prototype;p.hc=n("docs-material-labeled-text-field");p.xa=function(a){var b=N(W6c);b.id=a.getId();var c=Sd("docs-material-labeled-text-field-input",b);c.id=yi(a,"input");if(a=a.getContent())a=hBc(c,a,"docs-material-labeled-text-field-label"),de(this.Ib(b),a);return b};p.setContent=function(a,b){b=hBc(a,b,"docs-material-labeled-text-field-label");TV.prototype.setContent.call(this,a,b)};p.Ib=function(a){return a?Sd("docs-material-labeled-text-field-content",a):null};
p.fM=function(a){return Sd("docs-material-labeled-text-field-input",a)};ta(X6c);function Y6c(a,b,c){a=void 0===a?0:a;b=void 0===b?X6c.getInstance():b;UV.call(this,a,b,c);this.Bf(cc())}q(Y6c,UV);Y6c.prototype.Ga=function(){UV.prototype.Ga.call(this);Z6c(this)};Y6c.prototype.yoa=function(){UV.prototype.yoa.call(this);Z6c(this)};Y6c.prototype.Pa=function(a){UV.prototype.Pa.call(this,a);this.Qb()&&Z6c(this)};function Z6c(a){a.Nd();var b=0!=a.La().length;Fh(a.Qa(),"docs-material-labeled-text-field-has-text",b)};function $6c(a,b,c){RZ.call(this,b,c);this.F=a?new Y6c:new UV;this.Fa(this.F);this.F.Id("waffle-dataconnector-simple-text-input-prompt-text-field");a&&this.F.setContent(a);this.C.Id("waffle-dataconnector-simple-text-input-prompt-add-button")}q($6c,RZ);$6c.prototype.xa=function(){RZ.prototype.xa.call(this);var a=this.oa().xa("DIV","waffle-dataconnector-simple-text-input-prompt-text-field-wrapper");de(this.Ib(),a);this.F.render(a)};$6c.prototype.Pa=function(a){this.F.Pa(a)};
$6c.prototype.Ga=function(){var a=this;RZ.prototype.Ga.call(this);this.getHandler().R(this.C,"action",function(){var b=a.F.La();""!=b&&a.resolve(b)})};function a7c(a,b,c,d,e,f){b_.call(this,a,b,c,d,e,f);T2c(this,"Plx Query Editor");this.H=new Q6c(this.oa());this.Fa(this.H)}q(a7c,b_);p=a7c.prototype;p.Ga=function(){b_.prototype.Ga.call(this);this.getHandler().R(this.H,"Je",this.IQb).R(this.H,"Le",this.nNb)};p.xa=function(){b_.prototype.xa.call(this);this.H.render(T5c(this))};p.Nja=function(){var a=this.F.C.value,b=this.H.F;if(!a&&!b)return null;var c=new vZ,d=new sZ;b?W(d,3,b):(W(d,1,a),a=this.H.C.We().La(),W(d,2,a));W(c,2,d);return c};
p.E9=function(a){this.F.Na(!0);if(a){var b=V(a,2);a=V(b,1);var c=V(b,2);b=V(b,3);if(c)try{a:{for(var d=this.H,e=d.C.Fi(),f=0;f<e;f++)if(d.C.hf(f).La()==c){d.C.jf(f);break a}throw Error("Unrecognized engine type");}}catch(h){}b&&b7c(this,b);a&&D5c(this.F,a)}else D5c(this.F,"")};p.Boa=n(2);
p.IQb=function(){var a=this,b=this.H.F,c=new $6c("Script ID");Cq(c,"Add existing script");c.C.setContent("Add");c.Pa(b);this.qa(c);c.setVisible(!0);qf(c.getResult(),function(){return C(c)}).then(function(b){return b7c(a,b)},ba())};
function b7c(a,b){if(!a.isDisposed()){var c=a.H;c.F=b||"";S6c(c);c=a.F;if(b){c.Na(!1);var d=new Bp;var e=d.le("a",{href:O2c(b),target:"_blank"});e=e+"Edit your existing script by viewing it in Plx"+d.ue("a");d=d.format(e);C5c(c,d)}else c.Na(!0),A5c(c,!1);zB(b?"Script added":"Script removed");c_(a)}}p.nNb=function(){b7c(this,null)};function c7c(){return P('<div class="'+R("waffle-dataconnector-linked-script-chip")+'"><div class="'+R("waffle-dataconnector-linked-script-chip-content")+'" tabindex="0"></div><div class="'+R("waffle-dataconnector-linked-script-chip-close-badge-wrapper")+'"></div></div>')};function d7c(a,b){M.call(this,b);this.D=a;this.C=new $4c;lk(this.C,"Remove script");this.Fa(this.C)}q(d7c,M);d7c.prototype.xa=function(){this.Ua=N(c7c);var a=this.Ia("waffle-dataconnector-linked-script-chip-content");var b=this.D;b=this.oa().xa("A",{href:O2c(b),target:"_blank"},b);a.appendChild(b)};
d7c.prototype.Ga=function(){var a=this;M.prototype.Ga.call(this);this.C.render(this.Ia("waffle-dataconnector-linked-script-chip-close-badge-wrapper"));var b="Linked plx script: "+this.D;yh(this.Ia("waffle-dataconnector-linked-script-chip-content"),b);this.getHandler().R(this.C,"action",function(){return a.dispatchEvent("Ne")})};function e7c(){var a=P,b='<div class="'+R("waffle-dataconnector-plxqueryeditormodule")+'"><div class="'+R("waffle-dataconnector-plxqueryeditormodule-sidebar")+'"><div class="'+R("waffle-dataconnector-plxqueryeditormodule-sidebar-header")+'">Plx</div><div class="'+R("waffle-dataconnector-plxqueryeditormodule-link-script-button-wrapper")+'"></div><div class="'+R("waffle-dataconnector-plxqueryeditormodule-script-chip-wrapper")+'"></div><div class="'+R("waffle-dataconnector-plxqueryeditormodule-engine-select-wrapper")+
'"></div></div><div class="'+R("waffle-dataconnector-plxqueryeditormodule-main")+'"><div class="'+R("waffle-dataconnector-plxqueryeditormodule-editor-wrapper")+'"></div>';var c=P('<div class="'+R("waffle-dataconnector-queryeditor-sharing-message-container")+'"><div class="'+R("waffle-dataconnector-queryeditor-sharing-message")+'"></div></div>');return a(b+O(c)+"</div></div>")};function f7c(a,b,c){r6c.call(this,c);var d=this;this.H=this.J=null;this.F=new NV("Add existing script");this.Fa(this.F);this.D=new wV;this.D.setContent("Engine");g7c(this);this.D.jf(0);this.Fa(this.D);this.C=new a_(void 0,this.oa());this.Fa(this.C);this.L=new NV;this.L.Id("waffle-dataconnector-plxqueryeditormodule-preview-button");this.Fa(this.L);this.O=new Mi(function(){h7c(d,null)});this.qa(this.O);b&&(this.F.Na(!1),B5c(this.C),qf(b.then(function(a){var b=V(a,2);a=V(b,1);var c=V(b,3);b=V(b,2);D5c(d.C,
a||"");h7c(d,c);b&&d.D.Pa(b);d.F.Na(!0)},ba()),function(){d.dispatchEvent("He")}))}q(f7c,r6c);f7c.prototype.xa=function(){this.Ua=N(e7c)};
f7c.prototype.Ga=function(){var a=this;r6c.prototype.Ga.call(this);this.C.render(this.Ia("waffle-dataconnector-plxqueryeditormodule-editor-wrapper"));this.L.render(this.Ia("waffle-dataconnector-queryeditor-sharing-message-container"));this.F.render(this.Ia("waffle-dataconnector-plxqueryeditormodule-link-script-button-wrapper"));this.D.render(this.Ia("waffle-dataconnector-plxqueryeditormodule-engine-select-wrapper"));this.getHandler().R(this.C,"input",function(){a.dispatchEvent("He")}).R(this.F,"action",
function(){return i7c(a)}).R(this,"Ne",function(){a.O.start()}).R(this.D,"aftershow",function(a){return a.stopPropagation()})};function e6c(a){var b=a.C.C.value;if(!b&&!a.J)return null;var c=new vZ,d=new sZ;a.J?W(d,3,a.J):(W(d,1,b),a=a.D.We().La(),W(d,2,a));W(c,2,d);return c}function g7c(a){for(var b=ha(nc(j7c)),c=b.next();!c.done;c=b.next())c=c.value,a.D.yd(new Bk(c.caption,c.value))}
function i7c(a){var b=new $6c("Script ID");Cq(b,"Add existing script");b.C.setContent("Add");a.qa(b);b.setVisible(!0);qf(qf(b.getResult(),function(){return C(b)}).then(function(b){return h7c(a,b)},ba()),function(){(null!=a.J?a.H.Qa():a.D.Qa()).focus()})}
function h7c(a,b){if(!a.isDisposed()){a.J=b;var c=!!b;a.C.Na(!c);a.D.Na(!c);a.F.setVisible(!c);a.F.Na(!c);C(a.H);a.H=null;if(b){a.H=new d7c(b);a.Fa(a.H);a.H.render(a.Ia("waffle-dataconnector-plxqueryeditormodule-script-chip-wrapper"));c=new Bp;var d=c.le("a",{href:O2c(b),target:"_blank"});d=d+"Edit your existing script by viewing it in Plx"+c.ue("a");c=c.format(d);a.C.Na(!1);C5c(a.C,c)}else a.C.Na(!0),A5c(a.C,!1);zB(b?"Script added":"Script removed");a.dispatchEvent("He")}}
var k7c=Object.freeze({caption:"Dremel",value:"DREMEL"}),l7c=Object.freeze({caption:"F1",value:"F1"}),m7c=Object.freeze({caption:"Procella",value:"PROCELLA"}),j7c={F_a:k7c,d0a:l7c,V2a:m7c};function n7c(a,b){this.C=a;this.D=b;this.pb=new Md}function o7c(a,b,c){return new O6c(b,c,aC,function(a){return p7c(b,a)},new $Z(a.C,a.pb),a.D,void 0,a.pb)}function q7c(a,b,c,d,e){a=new O6c(b,c,bC,function(a){return r7c(d,a)},new $Z(a.C,a.pb),a.D,void 0,a.pb);K5c(a,e);return a}function s7c(a,b){if(J(I(),"fenqeu"))return new a7c(b,aC,function(a){return p7c(b,a)},new $Z(a.C,a.pb),void 0,a.pb);var c=new f7c(b,void 0,a.pb);return new c6c(b,c,aC,function(a){return p7c(b,a)},a.C,void 0,a.pb)}
function t7c(a,b,c,d){if(J(I(),"fenqeu"))return a=new a7c(b,bC,function(a){return r7c(c,a)},new $Z(a.C,a.pb),void 0,a.pb),K5c(a,d),a;d=new f7c(b,d,a.pb);return new c6c(b,d,bC,function(a){return r7c(c,a)},a.C,void 0,a.pb)}function u7c(a,b,c){return new v6c(c,b,aC,function(a){return p7c(b,a)},new $Z(a.C,a.pb),void 0,a.pb)}function p7c(a,b){var c=new AZ;W(c,1,a);W(c,2,b);return c}function r7c(a,b){var c=new KZ;W(c,1,a);W(c,2,b);return c};function v7c(a){this.C=a}function K6c(a,b){var c=new HZ;W(c,1,b);return F4c(a.C,c)}function H6c(a,b,c){var d=new w3c;W(d,1,b);W(d,2,c);return G4c(a.C,d)};function w7c(a,b,c,d,e){var f="Error in query on "+d;d=new L3c;d.Id("waffle-dataconnector-error-popup");Cq(d,f);d.C.setContent("Open query editor");d.J.setContent("Ok");a=10==a?Q4c(e):N4c(c,a,b);Dq(d,a);return d};function x7c(a,b,c,d,e,f){A.call(this);this.H=new r4c;this.qa(this.H);this.L=a;this.J=new x4c;this.V=new X5c(this.J);this.D=b;this.va=c;this.Db=d;this.O=new n7c(e,new v7c(this.J));this.F=null;this.$=new E;this.qa(this.$);this.C=null;this.Ja=new Ih(this);this.qa(this.Ja);this.Yb=new Se(this);this.qa(this.Yb);this.ma=new E5c;this.qa(this.ma);b=Acc();a=new Rt(Bcc.concat(["waffle-dataconnector-connection-selected"]));c=Bcc.concat(["waffle-dataconnector-active-sheet-db-connection","sheet-access-no-protected-range-for-sheet"]);
b||c.push("waffle-dataconnector-active-sheet-not-plx");b=new Rt(c);f.C(aC,tR).D(aC,tR).C(bC,tR).D(bC,tR).C(n4a,tR).D(n4a,tR).C(l4a,tR).C(eC,b).D(eC,b).C(cC,b).D(cC,b).C(dC,tR).C(fC,a);this.Ja.R(this.$,["show","hide"],this.Arb).R(this.D,"Ba",this.JMb).R(this.D,"Ca",this.BEb).R(this.D,"Ua",this.zEb);this.Yb.subscribe(l4a,"action",this.$fa).subscribe(dC,"action",this.xBb).subscribe(aC,"action",this.Dqb).subscribe(eC,"action",this.DCb).subscribe(cC,"action",this.ERa).subscribe(bC,"action",this.Usb).subscribe(n4a,
"action",this.IBb).subscribe(fC,"action",this.qqb);y7c(this)}q(x7c,A);p=x7c.prototype;p.Mf=function(a){this.J.Mf(a)};function d_(a,b){C(a.F);a.F=b;a.F.Qd(a.$);b instanceof Bq?a.Db.ji(a.F):a.Db.ji(new hcb(a.F));a.F.render();a.F.setVisible(!0)}p.$fa=function(){var a=this.H;a.C&&C(a.C);a.C=null;C(this.F);this.F=null};p.JMb=function(){y7c(this)};p.BEb=function(){this.C&&(C(this.C),this.C=null,UQ())};p.zEb=function(){y7c(this)};
function y7c(a){var b=a.D.C.C;if(b&&null!=b.D&&null==a.C){b=a.D.C.C;var c=V(b.D,2);c=gqb(a.L,c);var d;2!=V(c,3)||Acc()?d=c.getName():d="Database connection";a.C=new v4c(d,b.Ab(),a.H,a.D,a.va);a.qa(a.C);a.C.show()}}p.Arb=function(){this.F&&this.F.isVisible()||(dC.Pa(null),fC.Pa(null))};
p.HQb=function(){var a=new e4c;this.qa(a);d_(this,a);E4c(this.J).then(function(b){var c=[];tw(b,1).forEach(function(a){c.push($3c((new Z3c).Bf(a.getId()).rf(a.getName()).setType(V(a,3))).build())});a.isDisposed()||(g4c(a,c),f4c(a,!1))})};p.M8a=function(){var a=this;z7c(this,"Connecting to Plx...","Plx",2).then(function(b){b=new X3c(b,2);a.qa(b);d_(a,b)},function(){wp.getInstance().postMessage(yp("Could not connect to Plx","error",!0))})};
p.L8a=function(){var a=this,b=new W2c;this.qa(b);d_(this,b);qf(b.getResult().then(function(b){b&&A7c(a)},ba()),function(){return C(b)})};function A7c(a){var b;rf(z7c(a,"Connecting to BigQuery...","BigQuery",3).then(function(c){b=c;var d=a.J,e=new z3c;W(e,1,c);return I4c(d,e)}).then(function(c){c=tw(c,4);B7c(a,b,c)}),function(){wp.getInstance().postMessage(yp("Could not connect to Big Query","error",!0))})}
function B7c(a,b,c){c=new G3c(c);var d=new J3c(c);a.qa(d);d_(a,d);d.getResult().then(function(c){c=u7c(a.O,b,c);a.qa(c);d_(a,c)},function(){return C(d)})}function z7c(a,b,c,d){var e=pf(),f=wp.getInstance().postMessage(yp(b,"info",!0));b=new wZ;b.rf(c);W(b,2,d);qf(y4c(a.J,b).then(function(a){a=V(a,2);e.resolve(a)},function(a){return e.reject(a)}),function(){return xp(wp.getInstance(),f)});return e.C}
function C7c(a,b){var c=wp.getInstance().postMessage(yp("Importing connection...","info",!0)),d=new xZ;d.Bf(b);d.setType(1);return qf(A4c(a.J,d),function(){return xp(wp.getInstance(),c)})}p.IBb=function(){var a=this.F,b=a.F;switch(a.C){case 2:D7c(this,b);break;case 1:E7c(this,b)}};function E7c(a,b){var c=gqb(a.L,b).getName();b=o7c(a.O,b,c);a.qa(b);d_(a,b)}function D7c(a,b){b=s7c(a.O,b);a.qa(b);d_(a,b)}
p.qqb=function(){var a=this,b=fC.La(),c=b.getId(),d=b.getType();switch(d){case 2:D7c(this,c);break;case 1:gqb(this.L,b.getId())?E7c(this,c):C7c(this,c).then(function(){E7c(a,c)},ba());break;default:throw Error("Unsupported connection type: "+d);}};p.xBb=function(a){var b=this.F;b.sRa();var c=V(a,2);a=$5c(this.V,a);s4c(this.H,a);o4c(p4c(n4c(a,function(a){b.isDisposed()||b.oRa(a,c)}),function(a){b.isDisposed()||b.nRa(a)}),function(a){b.isDisposed()||b.mRa(a)}).start()};
p.Dqb=function(a){var b=this,c=this.F,d=Y5c(this.V,a);s4c(this.H,d);var e=F7c(function(a){return G7c(b,a)});o4c(p4c(n4c(d,function(a){c.isDisposed()||c.dpa();e(a);if(b.C&&!b.C.isDisposed()){var d=b.C;d.D==a.Ab()&&UZ(d.C,!1)}}),function(a){c.isDisposed()||c.cpa(a);if(a.jg()&&(e(a),b.C&&!b.C.isDisposed())){var d=b.C;d.D==a.Ab()&&VZ(d.C,V(a.Hg(),5))}}),function(a){var e=V(a.Hg(),2);a=V(a.Hg(),3);var f=u4c(b.H,d);if(f&&b.C&&!b.C.isDisposed()){var l=b.C;l.D==f&&UZ(l.C,!1)}c.isDisposed()?f&&H7c(b,f,e,a):
c.bpa()}).start();c.fpa()};function G7c(a,b){var c=dc(b.Ab());Number.isNaN(c);t4c(a.H,c,a.H.C);a.H.C=null;a.$fa();AF(a.D,c)?xI(a.D,c):a.Ja.Sc(a.D,["Ma","Ba"],function(b){"Ma"==b.type&&b.ah==c&&xI(a.D,c)})}p.DCb=function(){I7c(this,this.D.C.C.Ab())};
function I7c(a,b){var c=new FZ;W(c,1,b.toString());c=a6c(a.V,c);t4c(a.H,b,c);o4c(p4c(n4c(c,function(){if(a.C&&!a.C.isDisposed()){var c=a.C;c.D==b&&UZ(c.C,!1)}}),function(c){if(a.C&&!a.C.isDisposed()){var d=a.C;d.D==b&&VZ(d.C,V(c.Hg(),5))}}),function(c){var d=V(c.Hg(),2);c=V(c.Hg(),3);if(a.C&&!a.C.isDisposed()){var f=a.C;f.D==b&&UZ(f.C,!1)}H7c(a,b,d,c)}).start();VZ(a.C.C)}
function H7c(a,b,c,d){var e=AF(a.D,b),f=e&&e.D;if(f){e=e.ge();f=J7c(a,f);var h="waffle-dataconnector-ssologin-"+Zb(),k=w7c(c,d,f,e,h);a.qa(k);a.Db.ji(k);k.render();k.setVisible(!0);qf(k.getResult().then(function(){return a.ERa(b)},ba()),function(){return C(k)});(c=Od(h))&&RZ.prototype.getHandler.call(k).R(c,"click",function(){K7c(a,b,k)})}}function K7c(a,b,c){F5c(a.ma,function(){C(c);I7c(a,b)})}
p.ERa=function(a){if((a=t(a)?AF(this.D,a):this.D.C.C)&&null!=a.D){var b=a.D;a=V(b,2);b=V(b,1);switch(V(gqb(this.L,a),3)){case 2:var c=t7c(this.O,a,b,L7c(this,b));break;case 1:c=gqb(this.L,a).getName(),c=q7c(this.O,a,c,b,L7c(this,b))}this.qa(c);d_(this,c)}};function L7c(a,b){var c=pf(),d=new D3c;W(d,1,b);H4c(a.J,d).then(function(a){V(a,1)?c.resolve(V(a,2)):c.reject()},function(a){return c.reject(a)});return c.C}
p.Usb=function(a){var b=this,c=this.D.C.C.Ab(),d=this.F;a=Z5c(this.V,a);s4c(this.H,a);var e=F7c(function(){t4c(b.H,b.D.C.C.Ab(),b.H.C);b.H.C=null;b.$fa()});o4c(p4c(n4c(a,function(){d.isDisposed()||d.dpa();e();if(b.C&&!b.C.isDisposed()){var a=b.C;a.D==c&&UZ(a.C,!1)}}),function(a){d.isDisposed()||d.cpa(a);e();if(b.C&&!b.C.isDisposed()){var f=b.C;f.D==c&&VZ(f.C,V(a.Hg(),5))}}),function(a){var e=V(a.Hg(),2);a=V(a.Hg(),3);if(b.C&&!b.C.isDisposed()){var f=b.C;f.D==c&&UZ(f.C,!1)}d.isDisposed()?H7c(b,c,e,
a):d.bpa()}).start();d.fpa()};function J7c(a,b){b=V(b,2);a=a.L.C[b];b=V(a,3);a.getName();return b}function F7c(a){var b=a;return function(a){for(var c=[],e=0;e<arguments.length;++e)c[e]=arguments[e];b&&(e=b,b=null,e.apply(null,[].concat(rT(c))))}};function M7c(){A.call(this)}q(M7c,oB);M7c.prototype.C=function(){return x7c};uB("dataconnector",M7c);
