Kx.prototype.z8=qQ(59,function(){return ow(this,3)});SE.prototype.z8=qQ(58,function(){return ow(this,5)});Kx.prototype.W5=qQ(57,function(){return V(this,3)});SE.prototype.W5=qQ(56,function(){return V(this,5)});Kx.prototype.B8=qQ(55,function(){return ow(this,2)});SE.prototype.B8=qQ(54,function(){return ow(this,4)});Kx.prototype.l6=qQ(53,function(){return V(this,2)});SE.prototype.l6=qQ(52,function(){return V(this,4)});function a8c(a,b){Pf(a,11).push(b)}
function b8c(a,b){return(a=kT(a,b))?a.rect:null}function c8c(a,b){a.D=b}function d8c(a){Nf(this,a,0,-1,null,null)}x(d8c,Mf);function e8c(a){Nf(this,a,0,-1,null,null)}x(e8c,Mf);var f8c=/['()]/g;function g8c(a){return"%"+a.charCodeAt(0).toString(16)}function h8c(a){a=Nb(String(a));f8c.lastIndex=0;return f8c.test(a)?a.replace(f8c,g8c):a}function i8c(a){return a.El()+Xb(a.C)}
function j8c(a,b,c){b=c||b;c='<div class="shadow-docs-feedback '+(a.Kd?" "+R(a.Kd):"")+'"><div class="shadow-docs-feedback-title">'+O(a.title)+'</div><span class="shadow-docs-feedback-title-separator">&#8208;</span>';c+=O(Br({Kd:"shadow-docs-feedback-send-feedback-button",style:4,content:sr("Send feedback")},b));if(a.by){a=c;c=b;var d={};c=P(Fs(qr({uP:rr("docs-icon-close-thin")},d),c));c=a+O(Br({Kd:"shadow-docs-feedback-close-button",content:sr(""+O(c)),style:4,title:rr("Close")},b))}return P(c+"</div>")}
;function k8c(a,b,c,d){M.call(this,c);this.J=a;this.H=b;this.V=d||{};a:switch(a){case "editor-header":case "warning-dialogs":c="Office Native Editing";break a;default:c=""}this.O=c;a:switch(a){case "editor-header":a="shadow-docs-feedback-editor-header";break a;case "warning-dialogs":a="shadow-docs-feedback-warning-dialogs";break a;default:a=""}this.F=a;this.D=new Cr;this.Fa(this.D);(this.C=b?new Cr:null)&&this.Fa(this.C)}x(k8c,M);
k8c.prototype.xa=function(){this.Ua=N(j8c,{title:this.O,by:this.H,Kd:this.F},void 0,this.oa());this.D.hb(this.Ia("shadow-docs-feedback-send-feedback-button"));this.C&&this.C.hb(this.Ia("shadow-docs-feedback-close-button"))};k8c.prototype.Ga=function(){var a=this;k8c.ea.Ga.call(this);this.getHandler().R(this.D,"action",this.L);this.C&&this.getHandler().R(this.C,"action",function(){return L(a.Qa(),!1)})};k8c.prototype.L=function(){var a={};a.shadowDocsFeedbackSource=this.J;Cc(a,this.V);Yu.getInstance().C(a)};function l8c(a){var b=P;var c=sr(""+O(a.T4b));c='<div class="docs-unsupportedofficefeatureswarning-content-header"><div class="docs-unsupportedofficefeatureswarning-content-header-warningtext">'+O(c)+'</div><div class="docs-unsupportedofficefeatureswarning-content-header-restorefiletext">';c=P(c+"The original file can be restored from version history</div></div>");var d='<div class="docs-unsupportedofficefeatureswarning-content-features-list">';a=a.Zc;for(var e=a.length,f=0;f<e;f++)d+=P('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+
O(rr(""+a[f]))+"</div>");d=P(d+"</div>");return b(c+d)};function j_(a,b,c,d){du.call(this,"docs-unsupportedofficefeatureswarning",void 0,d);this.O=b;this.ma=c;this.J=new NV(this.dGa());this.Fa(this.J);this.C=null;this.w8()&&(this.C=new NV(this.pGa()),this.Fa(this.C));this.F=null;a.F&&J(I(),"docs-esdttfl")&&(this.F=new k8c("warning-dialogs",!1,d),this.Fa(this.F));Pq(this,null);Oq(this,!1);this.Fz(!1);this.Qi=!0}x(j_,du);p=j_.prototype;p.ska=n("alertdialog");
p.xa=function(){j_.ea.xa.call(this);gr(this.Ib(),l8c,{Zc:this.O,T4b:this.ma},void 0);var a=Gq(this);this.F&&this.F.render(a);this.J.render(a);this.w8()&&this.C.render(a);L(a,!0);L(Fq(this),!1);ar(this,null);Bh(this.Qa(),this.rDa())};p.Ga=function(){var a=this;j_.ea.Ga.call(this);this.getHandler().R(this.J,"action",function(){return a.nla()});this.w8()&&this.getHandler().R(this.C,"action",function(){a.setVisible(!1)})};p.nla=function(){this.setVisible(!1)};p.w8=Ie;p.pGa=sa;function m8c(a,b,c,d){j_.call(this,a,b,c,d);this.L=!1}x(m8c,j_);p=m8c.prototype;p.rDa=n("docs-editconsentdialog");p.dGa=n("Continue Editing");p.w8=Je;p.pGa=n("Cancel");p.nla=function(){m8c.ea.nla.call(this);this.L=!0;K.s2.Wb()};p.pn=function(){m8c.ea.pn.call(this);this.L||K.q2.Wb()};function n8c(a,b,c,d){j_.call(this,a,b,c,d)}x(n8c,j_);n8c.prototype.rDa=n("docs-unsupportedfeatureslistdialog");n8c.prototype.dGa=n("Ok");function o8c(a){return P('<input type="text" id="docs-copy-link" class="'+R("docs-copy-link")+'" value="'+R(a.link)+'" readonly="readonly">')};function k_(a,b,c,d){du.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ba="";this.F=b||null;this.va=c||new DCb(a);this.ma=null!=d?d:null;a=new Mq;Rq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.va.C()&&Rq(a,{key:"copy-link",caption:"Copy Link"});Pq(this,a)}x(k_,du);p=k_.prototype;
p.xa=function(){k_.ea.xa.call(this);Bh(Hq(this),"copy-link-dialog");Bh(Qq(this.D,"done"),"copy-link-done-button");this.C=N(o8c,{link:this.Ba},void 0,this.oa());uh(this.C,"label","Link to this comment");this.Ib().appendChild(this.C);if(this.L=Qq(this.D,"copy-link")){var a=Xd("DIV");Bh(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Fq(this));this.O=new wp(a);this.J=yp("Link copied to clipboard.","info",!1,4E3)}null!==this.ma&&(Sh(this.Yt(),"z-index",this.ma),Sh(Hq(this),"z-index",this.ma+
1))};p.Km=function(){k_.ea.Km.call(this);this.F&&this.getHandler().R(this.F,"copy",this.YDa);this.C.focus();this.C.select()};p.pn=function(){k_.ea.pn.call(this);this.F&&this.getHandler().Qc(this.F,"copy",this.YDa)};p.Ga=function(){k_.ea.Ga.call(this);this.getHandler().R(this.C,"click",this.eVb);this.L&&this.getHandler().R(this.L,"click",this.zqb)};p.KVb=function(a){this.Ba=a;this.C&&(this.C.value=a)};p.eVb=function(a){a.target.focus();a.target.select()};
p.zqb=function(a){a.stopPropagation();this.F&&this.va.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.YDa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Ea=function(){k_.ea.Ea.call(this);C(this.J);delete this.J;delete this.L;delete this.C};function l_(){var a=new sO(null);tQ(a,!0);return a};function p8c(a,b,c){E.call(this);this.D=a;this.Li=b;this.Zb=c;this.V=this.H=this.Ha=this.Ba=this.$=this.F=null;this.zc=new eR;this.qa(this.zc);this.Le=new eR;this.qa(this.Le);this.va=this.O=null;this.Ed=new eR;this.qa(this.Ed);this.Se=new eR;this.qa(this.Se);this.Ra=this.Ma=this.Oa=this.ma=this.L=null;this.Ud=new eR;this.qa(this.Ud);this.re=new eR;this.qa(this.re);this.hd=new eR;this.qa(this.hd);this.Fe=new eR;this.qa(this.Fe);this.Wa=this.Wc=null;this.C=new WV("");this.qa(this.C);this.jb=this.J=
this.Cb=this.Bb=this.kf=this.Lc=this.Sb=this.xb=null;this.jh=this.qd=!1;this.Hb=this.Wf=this.Ta=this.ub=null;this.Df=new Ih(this);this.qa(this.Df);this.Pc=new xw;this.Kg=this.Ki=this.Nh=this.wg=this.Oh=this.Ka=null;this.Vx();a=this.Df;a.R(this.F,"action",this.gwb);a.R(this.$,"action",this.Yla);a.R(this.Ba,"action",this.Yla);a.R(this.Ha,"action",this.Yla);a.R(this.J,"focus",Da(this.jUa,!0));a.R(this.J,"blur",Da(this.jUa,!1));a.R(this.J,"change",this.Lla);a.R(this.J,"keyup",this.Lla);b=[this.O,this.va,
this.H,this.V,this.L,this.ma,this.Ma,this.Ra];for(c=0;c<b.length;c++)this.Df.R(b[c],"change",v(this.b_b,this,b[c])),this.Df.R(b[c],"keyup",v(this.bwb,this,b[c]));a.R(this.Ta,"change",v(this.fMa,this));a.R(this.Oa,"change",v(this.IHb,this));a.Cg(this.jb,ff,this.aDb)}x(p8c,E);var q8c="placeholder"in document.createElement("input"),r8c=/\s*,\s*/;
function s8c(a){var b=a.Kg;b||(b=[{hj:"List from a range",type:4},{hj:"List of items",type:3},{hj:"Number",type:0},{hj:"Text",type:1},{hj:"Date",type:2},{hj:"Custom formula is",type:5}],J(I(),"fecdv")&&b.push({hj:"Checkbox",type:6}),a.Kg=b);return b}
function t8c(a){var b=a.Ki;b||(b=[{hj:"contains",code:9,inputs:0,example:"Approved"},{hj:"does not contain",code:10,inputs:0,example:"Approved"},{hj:"equals",code:13,inputs:0,example:"Approved"},{hj:"is valid email",code:14,inputs:-1,example:null},{hj:"is valid url",code:15,inputs:-1,example:null}],a.Ki=b);return b}
function u8c(a){var b=a.wg;b||(b=[{hj:"is valid date",code:30,inputs:-1,example:null},{hj:"equal to",code:16,inputs:2,example:"11/15/2014"},{hj:"before",code:17,inputs:2,example:"11/15/2014"},{hj:"on or before",code:19,inputs:2,example:"11/15/2014"},{hj:"after",code:18,inputs:2,example:"11/15/2014"},{hj:"on or after",code:20,inputs:2,example:"11/15/2014"},{hj:"between",code:21,inputs:3,example:"11/15/2014",UP:"11/15/2015"},{hj:"not between",code:22,inputs:3,example:"11/15/2014",UP:"11/15/2015"}],
a.wg=b);return b}function v8c(a){var b=a.Nh;b||(b=[{hj:"range",code:23,inputs:6,example:null},{hj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Nh=b);return b}
function w8c(a){var b=a.Oh;b||(b=[{hj:"between",code:7,inputs:8,example:"10",UP:"100"},{hj:"not between",code:8,inputs:8,example:"10",UP:"100"},{hj:"less than",code:3,inputs:7,example:"10"},{hj:"less than or equal to",code:4,inputs:7,example:"10"},{hj:"greater than",code:1,inputs:7,example:"10"},{hj:"greater than or equal to",code:2,inputs:7,example:"10"},{hj:"equal to",code:5,inputs:7,example:"10"},{hj:"not equal to",code:6,inputs:7,example:"10"}],a.Oh=b);return b}
function x8c(){return{hj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function y8c(){return{hj:"",code:31,inputs:-1,example:""}}p=p8c.prototype;
p.Vx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,u,w,y,B,H=a.oa(),Q;var Y=H.xa("TR","waffle-dv-trrules",H.xa("TD","waffle-dv-label",H.xa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),H.xa("TD",{colspan:"7"},l=H.xa("DIV","goog-inline-block"),Q=H.xa("DIV","goog-inline-block"),h=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=H.xa("SPAN","waffle-dv-separator","and"),k=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.hd.hb(h);this.Fe.hb(k);this.Ed.hb(c);this.Se.hb(d);this.zc.hb(e);this.Le.hb(f);var U=l_();xi(U,l);var ja=l_();xi(ja,l);var oa=l_();xi(oa,l);var za=l_();xi(za,l);var Ia=z8c(a,Q);(w=U.getElement())&&uh(w,"labelledby","waffle-dv-criteria");
var Ka;var Ba=H.xa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",H.xa("TD"),H.xa("TD",{colspan:"7"},Ka=H.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new iu;gu(w,Ka);xi(w,Ka);var qb=H.xa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",H.xa("TD"),H.xa("TD",{colspan:"7"},m=H.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Eb=new iu;gu(Eb,m);xi(Eb,m);var Va=H.xa("TR","waffle-dv-trrules",H.xa("TD"),H.xa("TD","waffle-dv-customcheckboxlabel",
H.xa("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),H.xa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var zb=H.xa("TR","waffle-dv-trrules",H.xa("TD"),H.xa("TD","waffle-dv-customcheckboxlabel",H.xa("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),H.xa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},u=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Ud.hb(r);
this.re.hb(u);uh(r,"labelledby","customCheckboxInputLabel_checked");uh(u,"labelledby","customCheckboxInputLabel_unchecked");hR(this.Ud,"e.g., TRUE");hR(this.re,"e.g., FALSE");var yc=H.xa("TR","waffle-dv-trrules",H.xa("TD","waffle-dv-label",H.xa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),H.xa("TD",{colspan:"7"},H.xa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},H.xa("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),H.xa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),H.xa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),H.xa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new JDc(!0);KDc(m,"onInvalidData",yc);var $b=H.xa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",H.xa("TD",null,H.xa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),H.xa("TD",{colspan:"7"},y=H.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Ec=new iu;gu(Ec,y);xi(Ec,y);y=Ec.Qa();var Mc=Cia(y,"labelledby");uh(y,"labelledby","waffle-dv-appearance "+Mc);y=H.xa("TR","waffle-dv-trrules",H.xa("TD"),H.xa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},B=H.xa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Mc=H.xa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));te(Mc,!0);a=a.Ba.childNodes[0];H.appendChild(a,Y);H.appendChild(a,
Ba);H.appendChild(a,qb);H.appendChild(a,Va);H.appendChild(a,zb);H.appendChild(a,yc);H.appendChild(a,$b);H.appendChild(a,y);this.C.render(l);H=this.C;H.toa=29;H.resize();H=this.C;H.yPa=200;H.resize();this.C.getElement().style.width="324px";q8c?this.C.getElement().placeholder="Enter items separated by a comma...":(H=this.C.getElement(),dj(H,"Enter items separated by a comma...","Enter items separated by a comma..."));if(H=this.C.getElement())yh(H,"Enter items separated by a comma..."),Ch(H,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=B;U.setVisible(!0);H=s8c(this);A8c(this,H,U);H=w8c(this);A8c(this,H,za);H=t8c(this);A8c(this,H,ja);H=u8c(this);A8c(this,H,oa);B8c(this,U,za,ja,oa,h,k,c,d,e,f,b,l,Ia,Ba,y,w,Ka,Mc,Ec,Q,m,Eb,r,u,qb,Va,zb)};
function B8c(a,b,c,d,e,f,h,k,l,m,r,u,w,y,B,H,Q,Y,U,ja,oa,za,Ia,Ka,Ba,qb,Eb,Va){a.F=b;a.F.setVisible(!0);a.Ba=c;a.$=e;a.Ha=d;a.Wc=u;a.L=f;a.ma=h;a.O=k;a.va=l;a.H=m;a.V=r;a.Wa=w;a.Ka=y;a.xb=oa;a.Oa=Ia;a.Ma=Ka;a.Ra=Ba;a.kf=qb;a.Bb=Eb;a.Cb=Va;L(a.kf,!1);L(a.Bb,!1);L(a.Cb,!1);ja.rc(!1);a.Ta=ja;a.Hb=za;C8c(a,!1);a.Sb=B;Q.rc(!0);a.ub=Q;a.Wf=Y;a.Lc=H;L(a.Lc,!0);D8c(a);E8c(a);a.jb=U;L(a.jb,!1)}
function F8c(a,b){L(a.Sb,23==b||24==b);a.Wf.innerText="Show dropdown list in cell";b=31==b;L(a.kf,b);var c=a.Oa.isChecked();L(a.Bb,b&&c);L(a.Cb,b&&c)}function G8c(a){B8c(a,a.F,a.Ba,a.Ha,a.$,a.L,a.ma,a.O,a.va,a.H,a.V,a.Wc,a.Wa,a.Ka,a.Sb,a.Lc,a.ub,a.Wf,a.jb,a.Ta,a.xb,a.Hb,a.Oa,a.Ma,a.Ra,a.kf,a.Bb,a.Cb)}function A8c(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.oa();e=new Bk(b[d].hj,null,e);c.yd(e);th(e.getElement(),"menuitem")}c.jf(0)}p.Yla=function(){E8c(this);this.J.value=H8c(this);this.dispatchEvent("change")};
p.gwb=function(){D8c(this);E8c(this);this.J.value=H8c(this);this.dispatchEvent("change")};p.jUa=ca("jh");p.Lla=function(a){this.qd||a&&!Wka(a)||this.J.value===I8c(this)||(this.qd=!0,L(this.jb,!0))};p.aDb=function(){this.qd=!1;this.J.value=H8c(this);L(this.jb,!1)};p.fMa=function(){L(this.Lc,this.Ta.isChecked())};p.IHb=function(){var a=this.Oa.isChecked();a||J8c(this);L(this.Bb,a);L(this.Cb,a);K8c(this)};function K8c(a){a.J.value=H8c(a)}function L8c(a){K8c(a);a.C.resize()}
p.b_b=function(a){K8c(this);M8c(this,a)?(this.D.Bl=0,m_(a),this.dispatchEvent("change")):(this.D.Bl=1,n_(a),this.dispatchEvent("error"))};p.bwb=function(){this.dispatchEvent("keyup")};function M8c(a,b){if(0!=o_(a))return!0;var c=b.value;if(null!=c&&oi(b)){if(!p_(a.D))return!0;a=q_(a,c,N8c(a).code);return null!=a&&(ow(a,3)||ow(a,5)&&a.Do().od()&&3==V(a.Do().La(),1))}return!0}function n_(a){a.select();Bh(a,"waffle-input-error")}function m_(a){a&&Dh(a,"waffle-input-error")}
function J8c(a){m_(a.C.getElement());m_(a.H);m_(a.V);m_(a.L);m_(a.ma);m_(a.Ma);m_(a.O);m_(a.va);m_(a.Ka.Cr());a.D.Bl=0;a.dispatchEvent("change")}function o_(a){return s8c(a)[a.F.Wg()].type}function D8c(a){var b=o_(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Ba.setVisible(d);a.Ha.setVisible(e);L(a.Wa,f);L(a.xb,h);L(a.L,!1);L(a.ma,!1);L(a.O,!1);L(a.va,!1);L(a.H,!1);L(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function N8c(a){var b;null!=O8c(a)?b=O8c(a):a.$.isVisible()?b=u8c(a)[a.$.Wg()]:a.Ba.isVisible()?b=w8c(a)[a.Ba.Wg()]:5==o_(a)?b=x8c():6==o_(a)?b=y8c():b=t8c(a)[a.Ha.Wg()];return b}function O8c(a){var b=v8c(a);return 4==o_(a)?b[0]:3==o_(a)?b[1]:null}
function E8c(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=N8c(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var u=N8c(a);if(3==o_(a))q8c?a.C.getElement().placeholder="Enter items separated by a comma...":(u=a.C.getElement(),dj(u,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(u.example)if(0==u.inputs||1==u.inputs)hR(a.Ed,"e.g., "+
u.example),hR(a.Se,"e.g., "+u.UP||"");else if(2==u.inputs||3==u.inputs)hR(a.zc,"e.g., "+u.example),hR(a.Le,"e.g., "+u.UP||"");else if(7==u.inputs||8==u.inputs)hR(a.hd,"e.g., "+u.example),hR(a.Fe,"e.g., "+u.UP||"");J8c(a);L(a.L,b);L(a.ma,c);L(a.O,d);L(a.va,e);L(a.H,f);L(a.V,h);L(a.Wa,l);l&&a.C.resize();L(a.xb,m);F8c(a,r.code);L(a.Wc,k)}
function q_(a,b,c){var d=p_(a.D);if(""==b||null==d.jd)return null;var e=d.rect,f=e.mc();e=e.kc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.jd+"",f,e,b,c,!0))?a.Pc.Ad(ex.Ca(),b):null}
function r_(a){var b=new jx,c=N8c(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(q_(a,a.O.value,d));break;case 1:e.push(q_(a,a.O.value,d));e.push(q_(a,a.va.value,d));break;case 2:e.push(q_(a,a.H.value,d));break;case 3:e.push(q_(a,a.H.value,d));e.push(q_(a,a.V.value,d));break;case 7:e.push(q_(a,a.L.value,d));break;case 8:e.push(q_(a,a.L.value,d));e.push(q_(a,a.ma.value,d));break;case 5:a=a.C.La().split(",");for(c=0;c<a.length;c++)e.push(Nuc(a[c]));break;case 6:c=Abb("="+a.Ka.La());e.push(q_(a,c,d));
break;case -1:a.Oa.isChecked()&&(e.push(q_(a,Lb(a.Ma.value),d)),Jb(a.Ra.value)||e.push(q_(a,Lb(a.Ra.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=YQ(d,e);W(b,1,d);return b}function P8c(a){var b=Lb(a.Ka.La());!a.Zb.C.D[Lb(Xb(b).toLowerCase())]&&jT(a.Zb,b)&&(b=ctc(a.Zb,b,!0));return b}function H8c(a){return a.qd||a.jh?a.J.value:I8c(a)}
function I8c(a){var b="";var c=o_(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=u8c(a)[a.$.Wg()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Ha.isVisible())c=t8c(a)[a.Ha.Wg()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=O8c(a),b+="Click and enter a value from ";else if(5==o_(a))c=x8c(),b="Enter a value that satisfies the formula:";else if(6==o_(a))if(c=y8c(),a.Oa.isChecked()&&!Jb(Lb(a.Ma.value))){b=Lb(a.Ma.value);var e=
Lb(a.Ra.value);b=Jb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=w8c(a)[a.Ba.Wg()],b+="Enter a number ";-1!=c.inputs&&(b+=c.hj);e=P8c(a);23==c.code&&""!=e&&d&&(d=ctc(a.Zb,e,!0))&&(b+=" "+d);Jb(Xb(a.O.value))||0!=c.inputs&&1!=c.inputs?Jb(Xb(a.H.value))||2!=c.inputs&&3!=c.inputs?Jb(Xb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Jb(Xb(a.va.value))||1!=c.inputs?Jb(Xb(a.V.value))||3!=c.inputs?Jb(Xb(a.ma.value))||
8!=c.inputs||(b+=" and "+a.ma.value):b+=" and "+a.V.value:b+=" and "+a.va.value;return b}function C8c(a,b){LDc(a.Hb,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function s_(a,b){switch(b){case 0:a.F.jf(2);break;case 1:a.F.jf(3);break;case 2:a.F.jf(4);break;case 3:a.F.jf(1);break;case 4:a.F.jf(0);break;case 5:a.F.jf(5);break;case 6:a.F.jf(6)}}
function Q8c(a,b,c,d,e){a.F.jf(0);a.$.jf(0);a.Ba.jf(0);a.Ha.jf(0);a.J.value="";a.L.value="";a.ma.value="";a.H.value="";a.V.value="";a.O.value="";a.va.value="";a.C.Pa("");a.Ka.Pa("");C8c(a,!1);var f=a.qd=!1,h=!1,k=!1,l=!1,m=!1,r=!1,u=!1,w=!1,y=!1,B=!1,H=!1,Q=!1,Y=!1,U=!1,ja=!1,oa=!1,za=!1,Ia=!1,Ka=b&&kx(b);b=Ka&&gx(Ka);if((Ka=Ka&&hx(Ka))&&b){for(var Ba=v8c(a),qb=u8c(a),Eb=w8c(a),Va=t8c(a),zb=x8c(),yc=y8c(),$b=0,Ec=0;Ec<Ba.length;Ec++)if(b==Ba[Ec].code){$b=Ba[Ec].inputs;23==Ba[Ec].code?(oa=!0,s_(a,
4)):(Q=!0,s_(a,3));a.ub.rc(!!e);break}for(e=0;e<qb.length;e++)if(b==qb[e].code){$b=qb[e].inputs;a.$.jf(e);s_(a,2);Y=w=!0;break}for(e=0;e<Eb.length;e++)if(b==Eb[e].code){$b=Eb[e].inputs;a.Ba.jf(e);s_(a,0);U=y=!0;break}for(e=0;e<Va.length;e++)if(b==Va[e].code){$b=Va[e].inputs;a.Ha.jf(e);s_(a,1);ja=B=!0;break}b==zb.code&&($b=zb.inputs,s_(a,5),za=!0);b==yc.code&&($b=yc.inputs,s_(a,6),Ia=!0);if(Y||ja||U||Q||oa||za||Ia)if(ja=p_(a.D),Y=ja.rect.mc(),U=ja.rect.kc(),ja=ja.jd+"",-1==$b)Ia&&0<Ka.length&&(H=!0,
a.Oa.rc(!0),a.Ud.Pa(lH(Ka[0],ja,Y,U)),1<Ka.length&&a.re.Pa(lH(Ka[1],ja,Y,U)));else if(0==$b)m=lH(Ka[0],ja,Y,U),a.Ed.Pa(m),m=!0;else if(1==$b)r=lH(Ka[0],ja,Y,U),m=lH(Ka[1],ja,Y,U),a.Ed.Pa(r),a.Se.Pa(m),r=m=u=!0;else if(2==$b)f=lH(Ka[0],ja,Y,U),a.zc.Pa(f),f=!0;else if(3==$b)h=lH(Ka[0],ja,Y,U),f=lH(Ka[1],ja,Y,U),a.zc.Pa(h),a.Le.Pa(f),h=f=u=!0;else if(7==$b)k=lH(Ka[0],ja,Y,U),a.hd.Pa(k),k=!0;else if(8==$b)l=lH(Ka[0],ja,Y,U),k=lH(Ka[1],ja,Y,U),a.hd.Pa(l),a.Fe.Pa(k),l=k=u=!0;else if(5==$b){Q=!0;Ia=[];for($b=
0;$b<Ka.length;$b++)Ia.push(lH(Ka[$b],ja,Y,U));a.C.Pa(Ia.join(","));a.C.resize()}else 6==$b&&(oa=!0,Ia=lH(Ka[0],ja,Y,U),null!=Ia&&(Ia=Ia.substring(1),Ka=!!qF(Ia),Ia=($b=sF(Ia,a.Li,!1,!0))?uF($b.rect,$b.Og):Ia,Ka||(Ia=rF(Ia)),a.Ka.Pa(Ia)));else a.F.jf(0),oa=!0;L(a.Wc,u);a.$.setVisible(w);a.Ba.setVisible(y);a.Ha.setVisible(B);L(a.H,f);L(a.V,h);L(a.O,m);L(a.va,r);L(a.L,k);L(a.ma,l);L(a.Bb,H);L(a.Cb,H);L(a.Sb,!0);L(a.Wa,Q);a.C.resize();L(a.xb,oa);null!=b&&F8c(a,b)}else{if(J(I(),"feadv")){w=OJ(a.Li);y=
w.Kc();B=new Pm;for(H=y.mc();H<y.Vc();H++)for(Q=y.kc();Q<y.Xc();Q++)oa=w.dh(H,Q),""!=sH(oa)&&Qm(B,sH(oa).split(r8c));B.isEmpty()?w=!1:(G8c(a),a.C.Pa(B.Dd().join(",")),s_(a,3),D8c(a),w=!0)}else w=!1;w||G8c(a)}a.fMa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Qb(Lb(c.substring(w+9))));a.Ta.rc(!!c);c&&(H8c(a)!=c&&a.Lla(),a.J.value=c,L(a.Lc,!0));C8c(a,d)}
p.Ea=function(){this.Sb=this.ub=this.jb=this.J=this.Wc=this.Ra=this.Ma=this.ma=this.L=this.va=this.O=this.V=this.H=null;C(this.Ka);this.Ka=null;C(this.ub);this.ub=null;C(this.Ha);this.Ha=null;C(this.Ba);this.Ba=null;C(this.$);this.$=null;C(this.F);this.F=null;C(this.Ta);this.Ta=null;C(this.Hb);this.Hb=null;p8c.ea.Ea.call(this)};function R8c(a){var b=a.description;a=a.nTb;return P('<div class="waffle-dv-rec-chip" title="'+R(b)+'"><div class="waffle-dv-rec-range">'+O(a)+'</div><div class="waffle-dv-rec-description">'+O(b)+"</div></div>")}function S8c(){return P('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function T8c(a,b,c,d,e,f,h){Bq.call(this);this.Cb=a;this.Df=b;this.ub=c;this.Fe=d;this.O=e;this.Ta=f;this.Bb=h;this.ma=new M(this.oa());this.Fa(this.ma);this.hd=new lr("",new $U,this.oa());this.Fa(this.hd);this.Wa=new M(this.oa());this.Fa(this.Wa);this.Oa=new YU(!1,"#4285f4");this.Fa(this.Oa);this.Ed=new bV(c,U8c.kda,U8c.lda);this.qa(this.Ed);this.F=this.Ba=null;this.qd=new Ih(this);this.qa(this.qd);this.xb=this.va=this.L=this.C=null;this.Ra=J(I(),"fedvs");this.jb=this.J=null;this.Hb=-1;this.Lc=[];
this.zc=[];this.re=-1;a=pG(this.ub).Kc();this.Se=xA(a.mc(),a.kc(),a.Vc(),a.Xc());this.Sb=null;this.Zb=!1;this.Wc=new Ih(this);this.qa(this.Wc);this.va=new Mq;this.va.set("save","Save",!1);this.va.set("clear","Remove validation",!1,!1);this.va.set("cancel","Cancel",!1,!0);Pq(this,this.va);Lq(this,!1);this.render();a=this.Ib();b=this.oa();c=U8c;Cq(this,"Data validation");this.L||(d=b.xa("DIV",{"class":c.SYa}),e=b.xa("DIV",{"class":c.RYa},d),b.appendChild(a,e),this.L=new vp(e),this.L.setType("warning"),
this.L.setContent(""),this.L.render(d),wwa(this.L,!0),this.L.setVisible(!1));this.Ra&&(e=b.xa("DIV",c.z4a),f=b.xa("DIV",{id:V8c.Rya},"Suggested validations"),d=b.xa("DIV",c.y4a),h=b.xa("DIV",c.wva,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.hd.hb(h),L(h,iB),this.ma.hb(d),e=b.xa("DIV",c.k4a),b.appendChild(d,e),this.Wa.hb(e),this.Oa.render(e),ZU(this.Oa,!0));this.Ba=b.xa("TABLE",{cellSpacing:"0","class":c.vE},b.xa("TBODY"));b.appendChild(a,this.Ba);
this.Ra&&Bh(this.Ba,c.G4a);a=this.Ib();a=Ld(a);b=a.xa("TR",U8c.W4a);b.appendChild(a.xa("TD","waffle-dv-label",a.xa("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.xa("TD",{colspan:"7"});this.C=z8c(this,c);W8c(this);b.appendChild(c);a.appendChild(this.Ba.childNodes[0],b);(a=this.C.Cr())&&uh(a,"labelledby","waffle-dv-cell-range");this.F=new p8c(this,this.Cb,this.O);ar(this,"save");X8c(this)}x(T8c,Bq);
var U8c={RYa:"waffle-input-error-butter-container",SYa:"waffle-input-error-butter-wrap",wva:"waffle-dv-feedback-link",kda:"waffle-dv-highlight-styled-border",lda:"waffle-dv-highlight-styled-rect",Vva:"waffle-input-error",k4a:"waffle-dv-rec-spinner-container",hea:"waffle-dv-rec-chip-selected",y4a:"waffle-dv-rec-wrapper",z4a:"waffle-dv-recs-title-bar",vE:"waffle-dv-table",G4a:"waffle-dv-table-with-suggestions",W4a:"waffle-dv-trrules"},V8c={Rya:"waffle-dv-recs-title"};p=T8c.prototype;p.Bl=0;
function W8c(a){if(a.C){var b=a.Cb.getActiveGrid();b&&(b=uF(pG(a.ub).Kc(),b.ge(),!0),a.C.Pa(b))}}function X8c(a){a.qd.R(a,"dialogselect",a.a_b).R(a.F,"error",a.$vb).R(a.F,"change",a.$Zb).R(a.C,"change",function(){a.F&&K8c(a.F);if(a.Ra){var b=p_(a);a.Zb||a.J&&b&&b.intersects(kT(a.O,a.jb))||Y8c(a)}});a.Ra&&a.qd.R(a.Ta,"recommender-calc-ended",a.ZZb).R(a.hd,"action",function(){K.Qu.Wb({source:"dataValidationDialogFeedback"})})}p.$vb=function(){Z8c(this)};
p.$Zb=function(){Z8c(this);Sq(this.va,"save",!0)};function $8c(a){var b=a.oa();a=a.ma.Qa();var c=N(S8c);b.appendChild(a,c)}
p.ZZb=function(a){var b=this;ZU(this.Oa,!1);L(this.Wa.Qa(),!1);a=a.C;if(0==a.length)$8c(this);else for(var c=this.oa(),d=this.ma.Qa(),e=0,f=a9c(this),h=!1,k={Xe:0};k.Xe<a.length;k={RH:k.RH,lw:k.lw,o0:k.o0,Xe:k.Xe,Ye:k.Ye,HD:k.HD},k.Xe++){var l=a[k.Xe],m=V(l,13);if(3<=e||!m)break;e++;k.Ye=gT(l);k.o0=uF(WA(k.Ye));k.lw=V(m,3);this.Lc.push(k.lw);this.zc.push(k.o0);m="";switch(gx(k.lw)){case 14:m="Is valid email";break;case 15:m="Is valid URL";break;case 30:m="Is valid date";break;case 24:m="List: "+hx(k.lw).map(function(a){return V(a.Do().La(),
2)}).join();break;case 1:m="Greater than "+V(hx(k.lw)[0].Do().La(),3);break;case 7:m=hx(k.lw);m="Between "+(V(m[0].Do().La(),3)+(" and "+V(m[1].Do().La(),3)));break;case 5:m=hx(k.lw);m="Equal to "+V(m[0].Do().La(),3);break;default:Jec.C("Unrecognized data validation type.")}var r=V8c;k.HD=N(R8c,{description:m,nTb:k.o0});k.RH=new Cr("",c);k.RH.Ze(8,!0);k.RH.hb(k.HD);uh(k.HD,"describedby",r.Rya);this.ma.Fa(k.RH);c.appendChild(d,k.HD);this.Wc.R(k.RH,"action",function(a){return function(){b9c(b,a.RH,
a.lw,a.o0,a.Xe)}}(k)).R(k.HD,"mouseenter",function(a){return function(){cV(b.Ed,pT(a.Ye))}}(k)).R(k.HD,"mouseleave",function(){dV(b.Ed)}).R(k.HD,"focus",function(a){return function(){di(a.HD,d)}}(k));l=.98<=V(l,2);m=this.Sb&&!this.Sb.equals(kx(r_(this.F)))&&(!this.J||!c9c(this)||!gx(this.J)==gx(kx(r_(this.F))));r=d9c(this);m||h||f&&!BT(Muc(f),k.Ye)&&(r||!N_a(f,k.Ye)||!l||!l&&24!=gx(k.lw)&&7!=gx(k.lw)&&5!=gx(k.lw))||(h=!0,k.RH.dispatchEvent("action"))}};
function b9c(a,b,c,d,e){var f=U8c,h=Ah(b.Qa(),f.hea);a.ma.xf(function(a){a.Gk(f.hea,!1);a.Mc(!1)});b.Gk(f.hea,!h);b.Mc(!h);a.Zb=!0;h?(a.show(!0),a.J=null,a.jb=null,a.Hb=-1):(b=new jx,W(b,1,c),Q8c(a.F,b,null,null,!0),L8c(a.F),a.C.Pa(d),a.J=c,a.jb=d,a.Hb=e);a.Zb=!1}p.a_b=function(a){if("save"==a.key){if(!e9c(this)){a.preventDefault();return}}else if("clear"==a.key&&!f9c(this)){a.preventDefault();return}this.C&&this.C.Na(!1)};
function Z8c(a){var b=g9c(a.Bl);b&&a.L.setContent(b);a.L.setVisible(0!=a.Bl);b=2==a.Bl||4==a.Bl;var c=U8c,d=a.oa().$w(a.C.getElement());Fh(d,c.Vva,b);b&&a.C.Cr().select()}
function g9c(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function h9c(a){var b=a.F,c=o_(b);if(0==c){c=b.L;var d=b.ma,e=M8c(b,c),f=M8c(b,d);e&&f?b.D.Bl=0:(e||n_(c),f||n_(d),b.D.Bl=1)}else if(1==c)c=b.O,d=b.va,e=!oi(c)||!Jb(Xb(c.value)),f=!oi(d)||!Jb(Xb(d.value)),e&&f?b.D.Bl=0:(e||n_(c),f||n_(d),b.D.Bl=6);else if(2==c)c=b.H,d=b.V,e=!oi(c)||!Jb(Xb(c.value)),f=!oi(d)||!Jb(Xb(d.value)),e&&f?b.D.Bl=0:(e||n_(c),f||n_(d),b.D.Bl=7);else if(3==c||4==c)c=0,4==o_(b)?(d=P8c(b),jT(b.Zb,d)?(d=P8c(b),d=kT(b.Zb,d),e=p_(b.D),null!=d&&null!=e&&d.jd==e.jd&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==o_(b)&&b.C.getElement()&&Jb(Xb(b.C.La()))&&(c=5),d=c,c=0==d,b.D.Bl=d,d=b.xb&&oi(b.xb),b.Wa&&oi(b.Wa)?(Fh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.oa().$w(b.Ka.getElement()),Fh(d,"waffle-input-error",!c),b.Ka.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Oa.isChecked()){c=b.Ma;e=b.Ra;d=Lb(Xb(c.value));e=Lb(Xb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=ec(d)==ec(e);f=d==e||h||f;Jb(d)?(n_(c),b.D.Bl=8):f?b.D.Bl=9:NL(d)||NL(e)?b.D.Bl=10:b.D.Bl=0}}else b.D.Bl=0;b=a.C.La();b=jT(a.O,b);2==a.Bl&&b?a.Bl=0:0!=a.Bl||b||(a.Bl=2);Z8c(a);return 0!=a.Bl}
function e9c(a){if(h9c(a))return!1;var b=a.F,c=b.Hb.isChecked("rejectInvalidData_radio"),d=H8c(b);b.Ta.isChecked()||(d="");var e=r_(b);if(!e)return!1;var f=new ty;W(f,1,e);W(f,2,d);W(f,3,c);Jsc(f,oi(b.Sb)&&b.ub.isChecked());b=a9c(a);if(!b)return!1;c=new yg;e=kx(e);d=a.J&&gx(a.J)==gx(e);var h=hx(e);if(d){var k=i9c(a,b8c(a.O,a.jb)),l=c9c(a);k=BT(k,b);G(c,12,!l||!k);var m=new d8c;G(m,1,!k);G(m,2,!l);G(m,3,a.Hb);sQ(c,17,Xfa[0],m)}else{for(var r=m=k=l=!1,u=!1,w=0;w<a.zc.length;w++){var y=i9c(a,b8c(a.O,
a.zc[w]));if(y){var B=BT(y,b);y=N_a(y,b);var H=a.Lc[w],Q=gx(H)==gx(e);H=hx(H);H=vb(H,h,function(a,b){return a.equals(b)});u|=H;l|=B&&Q&&H;k|=B;m|=B&&Q;r|=y}}w=new e8c;G(w,1,l);G(w,2,k);G(w,3,m);G(w,4,r);G(w,5,u);sQ(c,18,Xfa[0],w)}Csc(c,yAc(gx(e)));l=ha(a.Lc);for(k=l.next();!k.done;k=l.next())a8c(c,yAc(gx(k.value)));l=Fa()-a.re;G(c,14,l);l=new wg;Tf(l,58,c);c=Aj(Bj(new zj,l),1).build();a.Bb.Vb(d?35578:35301,c);31==gx(e)&&a.Bb.Vb(0<h.length?35604:35603,c);a.Fe.C(new mR(f,b));return!0}
function c9c(a){var b=r_(a.F);if(!b||!a.J)return!1;b=hx(kx(b));a=hx(a.J);return vb(a,b,function(a,b){return a.Do().La().equals(b.Do().La())})}
function f9c(a){var b=a9c(a);if(!b)return!1;try{if(!r_(a.F))return a.Bb.Vb(35300),!0;var c=kx(r_(a.F)),d=a.J&&gx(a.J)==gx(c),e=!1,f=new yg;if(d){var h=ekb(pG(a.ub).hp().Ec(),b8c(a.O,a.C.La()));Yj(h,function(a){zH(a)&&(e=!0);return e});if(!e){var k=new e8c;G(k,6,!0);sQ(f,18,Xfa[0],k)}}var l=new wg;Tf(l,58,f);var m=Aj(Bj(new zj,l),1).build();a.Bb.Vb(35300,m);return!0}finally{a.Fe.C(new mR(new ty,b))}}function a9c(a){var b=b8c(a.O,a.C.La());return i9c(a,b)}
function i9c(a,b){var c=a.C.La();a=(a=kT(a.O,c))?a.jd:null;return b&&null!=a?UA(b,a):null}function p_(a){var b=a.C.La();return kT(a.O,b)}function z8c(a,b){var c=a.Cb.C.ge();a=new QU(a.ub,v(a.YZb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.oa());a.render(b);return a}p.setVisible=function(a){T8c.ea.setVisible.call(this,a);a&&this.xb&&(this.xb.focus(),this.xb=null)};p.YZb=function(a,b,c,d){this.xb=a.Cr();this.Df.dca(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=OJ(this.Cb),e=zH(YH(d,dI(d)));d=null;var f=!1;e&&(e=e.uy,d=V(e,1),b=V(e,2),c=V(e,3),f=V(e,4));Q8c(this.F,d,b,c,f);this.Sb=(b=r_(this.F))?kx(b):null;this.setVisible(!0);this.C&&this.C.Na(!0);W8c(this);L8c(this.F);Y8c(this,a);this.re=Fa()};function Y8c(a,b){a.Ra&&!b&&(Usc(a.Ta)?(ZU(a.Oa,!0),L(a.Wa.Qa(),!0),a.ma.Fd(!0),a.Wc.Jc(),Qsc(a.Ta),d9c(a)?Htc(a.Ta,!0,!1,!1,[6],[p_(a).rect]):Itc(a.Ta,!0,!1,[6])):(ZU(a.Oa,!1),L(a.Wa.Qa(),!1),$8c(a)))}
function d9c(a){var b=p_(a);return null!=b&&!DA(b.rect)&&!b.rect.equals(a.Se)}p.Ea=function(){C(this.F);this.F=null;C(this.C);this.va=this.Ba=this.C=null;C(this.L);T8c.ea.Ea.call(this)};function j9c(a,b,c,d,e){Bq.call(this);this.Lc=d.L;this.Ta=c;this.jb=d.C;this.Ra=d;this.Zb=e;this.Wa=null;this.Cb=d.$;Cq(this,"Find and replace");Lq(this,!1);c=this.Ib();d=Ld(c);this.C=d.xa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Oa=d.xa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new sO(null);this.qa(this.F);this.Wc=b;this.O=new QU(this.Ta,v(this.A_b,this),!1,"",!0);this.qa(this.O);this.va=null;this.ma=new iu;this.qa(this.ma);this.Ba=new iu;this.qa(this.Ba);
this.L=new iu;this.qa(this.L);this.J=new iu;this.qa(this.J);this.Sb=this.xb=this.Bb=this.Hb=!1;this.ub=d.xa("SPAN");Kuc(this.ub);this.zc=new Bs(this.C);this.qa(this.zc);a=k9c;d.xa("LABEL",{"for":a.Ava},"Search");b=d.xa("LABEL",{"for":a.Dwa},"Match case");e=d.xa("LABEL",{"for":a.Ewa},"Match entire cell contents");var f=d.xa("LABEL",{},"Also search within formulas"),h=d.xa("LABEL",{"for":a.jya},"Search using regular expressions "),k=(new ul(g1a)).toString(),l=d.xa("SPAN",null,d.xa("A",{target:"_blank",
href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()});k=yi(this,"findLabel");var m=yi(this,"replaceLabel"),r=yi(this,"findScopeLabel"),u=d.xa("DIV","goog-inline-block"),w=d.xa("DIV",a.D3a);l=d.xa("TABLE",null,d.xa("TBODY",null,d.xa("TR",null,d.xa("TD",a.LABEL,d.xa("LABEL",{id:k},"Find")),d.xa("TD",null,this.C)),d.xa("TR",null,d.xa("TD",a.LABEL,d.xa("LABEL",{id:m},"Replace with")),d.xa("TD",null,this.Oa)),d.xa("TR",null,d.xa("TD",null,d.xa("LABEL",
{id:r},"Search")),d.xa("TD",null,u,w)),d.xa("TR",null,d.xa("TD",null,""),d.xa("TD",null,b,d.xa("BR"),e,d.xa("BR"),h,l,d.xa("BR"),f)),d.xa("TR",null,d.xa("TD",{colspan:"2"},this.ub))));this.F.render(u);Bh(this.F.getElement(),a.Ava);this.O.render(w);xi(this.ma,b);gu(this.ma,b);this.ma.getElement().id=a.Dwa;xi(this.Ba,e);gu(this.Ba,e);this.Ba.getElement().id=a.Ewa;xi(this.L,h);gu(this.L,h);this.L.getElement().id=a.jya;gu(this.J,f);xi(this.J,f);uh(this.C,"labelledby",k);uh(this.Oa,"labelledby",m);uh(this.F.Qa(),
"labelledby",r);d.appendChild(c,l);c=new Mq;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Pq(this,c);ar(this,"");this.getHandler().R(this,"dialogselect",this.B_b).R(this.zc,"input",this.ana).R(this.L,"change",this.NDb).R(this.F,"change",this.hub).R(this.O,"change",this.C_b).R(this.J,"change",this.ODb);c=new Cs;c.hb(this.C);this.qa(c);c=new Cs;c.hb(this.Oa);this.qa(c);l9c(this);c=new zq(this.getElement());this.qa(c);this.getHandler().R(c,
"focusin",this.uXa).R(this.getElement(),"mousedown",this.uXa)}x(j9c,Bq);var k9c={eua:"waffle-find-replace-dialog-border",Ava:"waffle-find-replace-find-scope-select",Vva:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",Dwa:"find-replace-case",Ewa:"find-replace-cell",jya:"find-replace-regex",D3a:"waffle-find-replace-selection-input goog-inline-block"};
function l9c(a){var b=pG(a.Ta),c=null,d=null;b&&(c=kUb(b),d=BF(a.jb,c.jd).ge());a.J.rc(a.Cb);var e=new Bk("All sheets",W9a.pYa),f=new Bk("This sheet",W9a.N3a),h=new Bk("Specific range",W9a.OI);a.F.yd(e);a.F.yd(f);a.F.yd(h);f=c?BI(a.jb,c.jd):null;f=(f=c&&f?NH(f,c.rect.mc(),c.rect.kc()):null)?f.lh():1;c&&c.rect.lh()>f?Ur(a.F,h):Ur(a.F,e);b&&a.O.Pa(uF(c.rect,d))}function m9c(a){var b=a.F.We().Sa(),c=vI(a.Ta.C);return 0==b?sF(a.O.La(),a.jb,!1,!0):1!=b||null===c?null:new OA(c,"",new wA(0,0,1,1))}p=j9c.prototype;
p.uXa=function(a){a.target==this.getElement()?this.focus():this.Zb.Lb(2)};p.C_b=function(){n9c(this)};p.ODb=function(){var a=this.J.isChecked();K8b(this.Ra,a)};p.hub=function(){n9c(this)};p.NDb=function(){this.L.isChecked()&&this.ma.rc(!0);this.ana()};
p.B_b=function(a){var b=o9c;if("findNext"==a.key)a.preventDefault(),this.Hb&&(t_(this,null),p9c(this,b.zva));else if("replace"==a.key)a.preventDefault(),this.Bb&&(t_(this,null),p9c(this,b.zxa));else if("replaceAll"==a.key&&(a.preventDefault(),this.Sb)){a=v(function(){t_(this,null);p9c(this,b.yxa)},this);var c=this.F.We().Sa();1<this.jb.D.length&&2==c&&!this.xb?(psc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.xb=!0):a()}};
p.ana=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Qq(this.D,"findNext").disabled=!a;this.Hb=a;q9c(this,a);this.Bb&&!a&&r9c(this,!1);Fh(this.C,"waffle-input-error",b)};p.A_b=function(a,b,c){this.Wa=a.Cr();this.Wc.dca(this,a,b,c,!1,!0)};
function n9c(a){var b=0==a.F.We().Sa();a.O.setVisible(b);C(a.va);a.va=null;var c=m9c(a),d=pG(a.Ta);b&&d&&c&&(a.va=kO(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.va.setVisible(!0),a.qa(a.va))}function p9c(a,b){if(0==a.F.We().Sa()&&null==m9c(a))Fh(a.O.D,"waffle-range-selection-error",!0),t_(a,"Invalid range");else{var c=a.F.We().Sa();a.dispatchEvent(new s9c(b,a.C.value,a.Oa.value,c,a.ma.isChecked(),a.Ba.isChecked(),a.L.isChecked(),a.J.isChecked(),m9c(a)))}}
p.setVisible=function(a){var b=this.Ra.Ld();q9c(this,!b);r9c(this,!b);this.Oa.disabled=b;j9c.ea.setVisible.call(this,a);a&&this.Wa&&(this.Wa.focus(),this.Wa=null)};p.DVb=function(a){this.C.value=a};p.JTa=function(){this.C.select()};p.focus=function(){this.Qb()&&this.isVisible()&&(this.C.focus(),this.Zb.Lb(2),Ws(this.C,this.C.value.length),this.ana())};function r9c(a,b,c){b=b&&!a.Ra.Ld()&&0==!a.C.value.length;a.Bb=b;a=Qq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function q9c(a,b){var c=!!$a(dmb(a.Lc),function(a){return!a.wj()});b=b&&!a.Ra.Ld()&&!c&&0==!a.C.value.length;a.Sb=b;a=Qq(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}function t_(a,b){var c=Ld(a.Ib());a=a.ub;b?(0<ke(a).length&&c.appendChild(a,c.xa("BR")),c.appendChild(a,c.xa("B",null,De(c,b)))):c.Fd(a)}p.Ea=function(){j9c.ea.Ea.call(this);this.xb=!1;K8b(this.Ra,this.Cb)};
function s9c(a,b,c,d,e,f,h,k,l){D.call(this,a);this.F=b;this.H=c;this.C=d;this.O=e;this.V=f;this.Ba=h;this.Ha=k;this.Ka=l||null}x(s9c,D);var o9c={zva:"findnext",Kfc:"findall",zxa:"replace",yxa:"replaceall",DONE:"done",F7b:"canceled"};function t9c(a,b,c,d,e){A.call(this);var f=o9c;this.H=null;this.C=a;this.D=b;this.F=c;this.O=d;this.L=e;this.J=new Ih(this);this.qa(this.J);this.J.R(a,f.yxa,this.UCb).R(a,f.zxa,this.VCb).R(a,f.zva,this.tXa).R(a,f.DONE,this.msb)}x(t9c,A);var u_={XN:"cg",YN:"cr",WN:"cc",yva:"loop"};p=t9c.prototype;p.wXb=function(){this.C.setVisible(!0);u9c(this,null)};p.tXa=function(a){if(qG(this.D.C)){var b=pG(this.D).Sa(),c=this.H;c||(c=dI(b),c=Dc(u_.XN,b.$b(),u_.YN,nI(b,c.y),u_.WN,oI(b,c.x)));v9c(this,a,b,c)}};
function v9c(a,b,c,d){var e=new xw,f=w9c(b);x9c(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.Ad((new Z9a).Ca(),a);a=V(f,1);var d=b.type;qG(this.D.C)&&(c?ow(c,1)?(d=V(c,1),c=Dc(u_.XN,parseInt(d.Ab(),10),u_.YN,d.gs(),u_.WN,d.getColumnIndex(),u_.yva,V(c,2)),y9c(this,a,c)):(y9c(this,a,{}),"replace"==d&&this.C.focus()):z9c(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function x9c(a,b,c){if(c){var d=""+c[u_.XN],e=new ry;W(e,1,d);W(e,2,rkb(b,c[u_.YN],"r"));W(e,3,rkb(b,c[u_.WN],"c"));W(a,10,e)}}
function w9c(a){var b=new cE;W(b,1,a.F);W(b,3,a.H);W(b,5,a.C);if(0==a.C||1==a.C){var c=a.Ka,d=new Rw;W(d,1,""+c.jd);var e=c.rect.mc();W(d,2,e);Sw(d,c.rect.Vc());d.zr(c.rect.kc());d.$x(c.rect.Xc());b.setSelection(d)}W(b,6,a.O||!1);W(b,7,a.V||!1);W(b,8,a.Ba||!1);b.setType(a.Ha?1:0);W(b,11,0);return b}function y9c(a,b,c){c?c&&null!=c.cg?(b=c[u_.XN],c[u_.yva]&&t_(a.C,"No more results found, looping around"),a.F.IA(b,v(a.z_b,a,c))):(u9c(a,null),t_(a.C,"There are no entries matching "+b)):z9c(a)}
p.z_b=function(a){var b=pG(this.D).Sa(),c=a[u_.YN],d=a[u_.WN];a[u_.YN]=nI(b,c);a[u_.WN]=oI(b,d);u9c(this,a);a=new Dd(d,c);b=new OA(b.$b(),"",zA(a));lT(this.F,b,v(this.c6a,this,a))};
p.c6a=function(a){if(!this.isDisposed()){this.C.focus();var b=pG(this.D).Sa();xH(b.dh(a.y,a.x))&&!this.C.J.isChecked()&&r9c(this.C,!1,"Can't replace formula");var c=PH(b,a.y),d=QH(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=tF(a),a=sH(YH(b,a)),t_(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function z9c(a){t_(a.C,null);t_(a.C,"Error while searching spreadsheet. Please try again.")}
p.VCb=function(a){if(!this.L.Ld()){var b=this.H;if(b){var c=tH(this.F,b[u_.XN]);if(c){c=c.Ec();var d=rkb(c,b[u_.YN],"r"),e=rkb(c,b[u_.WN],"c"),f=c.dh(d,e);if(!xH(f)||this.C.J.isChecked()){f=sH(f);var h=new xw,k=w9c(a);W(k,5,0);x9c(k,c,b);var l=new Rw;W(l,1,""+b[u_.XN]);W(l,2,d);Sw(l,d+1);l.zr(e);l.$x(e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);A9c(this,c,k,f,b,!1);this.tXa(a)}}}}};
p.UCb=function(a){if(!this.L.Ld()&&qG(this.D.C)){var b=this.F.getActiveGrid().Ec(),c=w9c(a);A9c(this,b,c,a.F,a.H,!0)}};
function A9c(a,b,c,d,e,f){b=new XV(b,c);xF(b,v(function(a,b){a?(a=V(b,5),b=V(b,4),b=0==a?"No matches found":f?(new Lt(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),t_(this.C,null),t_(this.C,b)):z9c(this)},a));t_(a.C,null);t_(a.C,"Working...");a.O.C(b)}p.msb=function(){u9c(this,null)};function u9c(a,b){a.H=b;(a=a.C)&&r9c(a,null!=b)};function B9c(a){a=a||{};var b=a.type;return P('<input class="'+R("jfk-textinput")+(a.Kd?" "+R(a.Kd):"")+'"'+(a.id?' id="'+R(a.id)+'"':"")+(a.maxLength?' maxlength="'+R(a.maxLength)+'"':"")+(a.N$&&a.YYb?' label="'+R(a.N$)+'"':"")+(a.name?' name="'+R(a.name)+'"':"")+(a.N$?' placeholder="'+R(a.N$)+'"':"")+' type="'+R(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+R(a.pattern)+'"':"")+(a.value?' value="'+R(a.value)+'"':"")+(a.dir?' dir="'+R(a.dir)+'"':"")+(a.attributes?" "+wr(a.attributes):"")+">")};function C9c(a){a=""+D9c({id:"waffle-resize-selection-custom",gOa:a.fha,Tk:sr("<br/>"+O(B9c({id:"waffle-resize-input",Kd:"waffle-resize-inset-input"})))});a+=D9c({id:"waffle-resize-selection-auto",gOa:rr("Fit to data"),Tk:sr("")});return P(a)}function D9c(a){return P('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+R(a.id)+'"><label for="'+R(a.id)+'" class="waffle-resize-label">'+O(a.gOa)+"</label>"+O(a.Tk)+"</div>")}
function E9c(a){var b=a.Agb;a='<label for="waffle-resize-input">'+O(a.fha)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return P(a)};function F9c(a,b,c,d,e){Bq.call(this);this.L=a;this.Ba=b;var f=this.L.Kc().kd();this.C=f;this.F=Ua($H(this.L),function(a){return a.kd()==f});this.J=new eR;this.O=new JDc(!0);this.ma=new iu;this.Oa=c;this.Ra=d;this.va=e}x(F9c,Bq);var G9c={vI:"waffle-resize-selection-auto",Dr:"waffle-resize-selection-custom",oda:"waffle-resize-input",p2a:"waffle-resize-selection",v3a:"waffle-resize-rows-can-grow-checkbox"};p=F9c.prototype;
p.xa=function(){F9c.ea.xa.call(this);var a=this.F[0];if("r"==this.C){var b=a.mc();a=a.Vc()-1;var c=String(lF(b+1)),d=String(lF(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.kc(),a=a.Xc()-1,c=nF(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+nF(a)));Cq(this,b);"r"==this.C?this.Ib().appendChild(N(E9c,{fha:H9c(this),Agb:J(I(),"fefrh")})):this.Ib().appendChild(N(C9c,{fha:H9c(this)}));ar(this,
"ok")};p.Ga=function(){F9c.ea.Ga.call(this);var a=this.oa(),b="r"==this.C;this.J.hb(a.getElement(G9c.oda));J(I(),"fefrh")&&b&&(a=a.getElement(G9c.v3a),gu(this.ma,a),xi(this.ma,a));a=this.L.Kc();var c=a.kd();a=Neb(dkb(this.L,c,FA(a,c)));this.J.Pa(String(a));b||(KDc(this.O,G9c.p2a),LDc(this.O,G9c.Dr));this.getHandler().R(this,"dialogselect",this.U0b).R(this.J.getElement(),"focus",this.MHb)};p.MHb=function(){"c"==this.C&&LDc(this.O,G9c.Dr)};p.focus=function(){this.Qb()&&iR(this.J)};
function H9c(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(JH+")"):"Enter new column width in pixels. (Default: "+(Peb+")")}
p.U0b=function(a){if("ok"==a.key)if((a="r"==this.C)||MDc(this.O)==G9c.Dr){var b=parseInt(this.J.La(),10);isNaN(b)?yB("Entered value is not a number."):2>b||2E3<b?yB("Size must be between 2 and 2000 pixels."):(this.va.C("r"==this.C?35310:35308),b=new tK(this.L,this.F[0],b,this.F.slice(1)),J(I(),"fefrh")&&a&&(a=!this.ma.isChecked(),b.O=a),this.Ba.C(b))}else pG(this.Oa),this.va.C(35307),xXb(this.F,this.Ra,this.Ba)};function I9c(a){Nf(this,a,0,-1,null,null)}x(I9c,Mf);I9c.prototype.getType=function(){return F(this,3)};I9c.prototype.setType=function(a){G(this,3,a)};function J9c(a){M.call(this,a);this.$=mB("email");this.C=this.D=null}x(J9c,M);p=J9c.prototype;
p.xa=function(){var a=this.oa();var b=this.oa();this.C=new AU;this.qa(this.C);this.D=new AU;this.qa(this.D);var c=b.xa("DIV","waffle-dialog-notifications-input");th(c,"presentation");this.F=new yU;zU(this.F,b.xa("LABEL",null,"Any changes are made"));this.F.render(c);this.C.YG(this.F);var d=b.xa("DIV","waffle-dialog-notifications-input");th(d,"presentation");this.J=new yU;zU(this.J,b.xa("LABEL",null,"A user submits a form"));this.J.render(d);this.C.YG(this.J);var e=b.xa("DIV","waffle-dialog-notifications-input");
th(e,"presentation");this.H=new yU;zU(this.H,b.xa("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.YG(this.H);var f=b.xa("DIV","waffle-dialog-notifications-input");th(f,"presentation");this.L=new yU;zU(this.L,b.xa("LABEL",null,"Email - right away"));this.L.render(f);this.D.YG(this.L);b=b.xa("DIV",null,b.xa("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.xa("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.xa("DIV",{style:"padding: 5px"}),
b.xa("DIV","waffle-dialog-notifications-label","Notify me with..."),b.xa("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.oa();d=c.xa("DIV");this.O=KQ("Save",c);this.Fa(this.O,!1);this.O.render(d);this.V=new Cr("Cancel",c);this.Fa(this.V,!1);this.V.render(d);this.Ua=a.xa("DIV","waffle-dialog-notifications",a.xa("DIV",null,b),a.xa("DIV",null,d))};
p.Ga=function(){J9c.ea.Ga.call(this);this.getHandler().R(this.O,"action",this.NUb,!0).R(this.V,"action",v(this.dispatchEvent,this,new D("cancelRuleEdit"))).R(this.C,"change",this.bta).R(this.D,"change",this.bta)};p.Uc=function(a){J9c.ea.Uc.call(this,a);a?1==a.getType()?BU(this.C,this.F):2==a.getType()&&BU(this.C,this.J):BU(this.C,null);a?2==F(a,2)?BU(this.D,this.H):1==F(a,2)&&BU(this.D,this.L):BU(this.D,null);this.bta()};p.focus=function(){var a=CU(this.C),b=this.C.C.hf(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};p.NUb=function(){this.dispatchEvent(new D("saveRule",K9c(this)))};function K9c(a){var b=new I9c,c=a.Sa();c&&(c=F(c,1),G(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?G(b,2,1):a.H.isChecked()&&G(b,2,2);return b}p.bta=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Na(a)};function L9c(a){return P("<div><div>"+O(a.r8a)+"</div>"+O(hu({id:"waffle-confirm-suppress-checkbox",Kd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+O(a.Xra)+"</span></div>")};function M9c(a,b,c,d,e,f,h){if(ya(c)){var k=new Mq;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=MCa;return N9c(d||"Heads up!",a,b,k,e,f,h)}function N9c(a,b,c,d,e,f,h){b=od(b);if(f){b=er(L9c({r8a:b,Xra:f}));var k=new iu;var l=c;c=function(){l(k.isChecked())}}a=aDa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Fa(k),k.hb(ze(a.oa(),"waffle-confirm-suppress-checkbox")),c=ze(a.oa(),"waffle-confirm-suppress-label"),gu(k,c),k.rc(!1));return a};function v_(a,b){M.call(this,b);this.Uc(a)}x(v_,M);
v_.prototype.xa=function(){var a=this.Sa(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==F(a,2)?c+="send digest email":1==F(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.oa();a=d.xa("TD",null);b=d.xa("TD",{width:"50px"});c=d.xa("TR",{valign:"center"},d.xa("TD",null,d.xa("SPAN","waffle-notification-rule",c)),d.xa("TD",{align:"right"},d.xa("TABLE",null,d.xa("TBODY",null,d.xa("TR",null,a,b)))));d=Di(jr,"waffle-notifications-add");this.D=new lr("Edit",
d,this.oa());this.D.Id("goog-link-button");this.D.Id("menuMainLink");this.Fa(this.D,!1);this.D.render(a);this.C=new lr("Delete",d,this.oa());this.C.Id("goog-link-button");this.C.Id("menuMainLink");this.Fa(this.C,!1);this.C.render(b);this.Ua=c};v_.prototype.Ga=function(){v_.ea.Ga.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};v_.prototype.H=function(){this.dispatchEvent(new D("edit",this.Sa()))};
v_.prototype.F=function(){var a=v(function(){this.dispatchEvent(new D("del",this.Sa()))},this),b=v(function(){this.C.getElement().focus()},this);M9c("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function O9c(a){M.call(this,a);this.C=null}x(O9c,M);O9c.prototype.xa=function(){var a=this.oa();this.C=a.xa("TBODY");this.Ua=a.xa("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};O9c.prototype.Ib=g("C");O9c.prototype.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};function P9c(a,b,c){Bq.call(this);this.L=b;Cq(this,"Set notification rules");Lq(this,!1);a=new Mq;a.set("cancel","Done",!1,!0);Pq(this,a);this.C=new J9c(c);this.Fa(this.C,!1);this.F=new O9c;this.Fa(this.F,!1);this.J=new lr("Add another notification rule",mP.getInstance(),this.oa());this.Fa(this.J,!1)}x(P9c,Bq);p=P9c.prototype;
p.xa=function(){P9c.ea.xa.call(this);var a=this.oa(),b=kqb(new ul(d1a+"91588")).toString();b=a.xa("A",{target:"_blank",href:b},"Help");var c=a.xa("DIV");this.J.render(c);this.ma=a.xa("DIV");this.O=a.xa("DIV");var d=a.xa("DIV","waffle-dialog-notifications-bounds",this.ma,this.O);b=a.xa("DIV",null,a.xa("DIV",{align:"right"},b),d,c);a.appendChild(this.Ib(),b);ar(this,"")};
p.Ga=function(){P9c.ea.Ga.call(this);this.F.render(this.ma);this.C.render(this.O);this.getHandler().R(this,"edit",this.d1b).R(this,"del",this.c1b).R(this.J,"action",this.b1b).R(this,"saveRule",this.MUb).R(this,"cancelRuleEdit",this.D7a)};p.E_=function(a){this.isDisposed()||(this.C.setVisible(!1),Q9c(this,!1),aB(this.L,"/notifications/list",v(this.FYb,this,a)).we())};
p.FYb=function(a,b,c){if(!this.isDisposed()){b=c.sf();c=[];for(var d=0;d<b.length;d++)c[d]=new I9c(b[d]);this.Uc(c);if(a&&0==c.length)R9c(this,null,!1);else{if(a=this.Sa())if(b=this.F,b.Fd(!0),b.oa().Fd(b.Ib()),b.Uc(a),c=b.oa(),0==a.length)c.appendChild(b.Ib(),c.xa("TR",null,c.xa("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Fa(new v_(a[d],c),!0);Q9c(this,!0);this.focus()}}};
p.MUb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();F(a,1)?ku(aB(this.L,"/notifications/set",v(this.E_,this,!1)),{rule:b}).we():ku(aB(this.L,"/notifications/create",v(this.E_,this,!1)),{rule:b}).we()};p.D7a=function(){this.C.setVisible(!1);this.E_(!1)};p.d1b=function(a){R9c(this,a?a.target:null,!0)};p.b1b=function(){R9c(this,null,!0)};function R9c(a,b,c){Q9c(a,!1);var d=a.C;d.Uc(b);d.setVisible(!0);c&&a.C.focus()}
p.c1b=function(a){this.F.setVisible(!1);a=a.target;ku(aB(this.L,"/notifications/delete",v(this.E_,this,!1)),{rule_id:F(a,1)}).we()};function Q9c(a,b){a.F.setVisible(b);var c=Gq(a);L(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.E_(!0)};function S9c(a,b,c){b=c||b;c='<tr class="dialog-settings-general-settings-div"><div>';var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(O(a.B9a)+"</a>");c=c+d+"</div>";a.yWb&&(c+='<div class="dialog-settings-english-name-div">'+O(hu({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
c+="Always use English function names</label></div>");return P(c+"</tr>")}function T9c(){return P('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function w_(a,b,c,d){Bq.call(this);this.Hb=a;this.Wc=b;this.ma=c;this.zc=d;this.C={};this.Bb=this.jb=!1;this.Zb=this.Cb=this.xb="";this.Lc=new xw;this.J=[];this.F=this.Lc.Ad((new Lx).Ca(),ritz_api.RitzModelApi.getWorkbookProperties());Cq(this,"Settings for this spreadsheet");this.Wa=!1;this.Ra=new iu;this.Fa(this.Ra);this.O=new FT;this.Fa(this.O);this.L=new FT;this.Fa(this.L);this.ub=new XT;this.Fa(this.ub);this.Oa=this.Ta=null;this.Sb=new It(1);this.va=this.Ba="";this.C[0]=l_();this.C[1]=l_();this.C[2]=
l_();this.C[3]=l_();this.C[4]=new eR;this.C[5]=new eR}x(w_,Bq);var U9c=null,V9c={N2:0,M4a:1,BYa:2,d1a:3,x1a:4,FZa:5},W9c={p5a:"waffle-settings-dialog-english-name-checkbox",q5a:"waffle-settings-dialog-english-name-checkbox-label"},X9c=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],Y9c=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=w_.prototype;
p.xa=function(){w_.ea.xa.call(this);var a=this.Ib(),b=this.oa(),c=[Z9c(b,"Locale","waffle-settings-label-locale"),$9c(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),a$c(this),Z9c(b,"Time zone","waffle-settings-label-timezone"),$9c(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
a$c(this)],d=[];d.push(Z9c(b,"Recalculation","waffle-settings-label-autorecalc"));d.push($9c(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(a$c(this));d.push(Z9c(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=kqb(new ul(d1a+"58515")).toString();e=b.xa("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push($9c(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=Z9c(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=$9c(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");b$c(e);d.push(e);this.J.push(e);e=Z9c(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=$9c(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");b$c(e);d.push(e);this.J.push(e);"OFF"==this.C[3].We().La()&&c$c(this);d.push(a$c(this));c=kb(c,d);c.push(N(S9c,{B9a:this.Cb,yWb:this.Wa}));this.Ta=b.xa("TABLE","dialog-settings",b.xa("TBODY",null,c));this.Oa=b.xa("table","dialog-settings",b.xa("tbody",null,d));c=N(T9c);b.appendChild(a,c);this.ub.hb(c);b.appendChild(a,
this.Ta);b.appendChild(a,this.Oa);L(this.Oa,!1);U9c||(a=new Mq(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),U9c=a);Pq(this,U9c);d$c(this,4,ow(this.F,3)&&V(this.F,3).B8()?V(this.F,3).l6().toString():"50");d$c(this,5,ow(this.F,3)&&V(this.F,3).z8()?V(this.F,3).W5().toString():"0.05");ar(this,"save")};function b$c(a){a=a.firstChild.firstChild;Bh(a,"jfk-textinput");Sh(a,"width","7em")}function c$c(a){for(var b=0;b<a.J.length;b++)L(a.J[b],!1)}
function Z9c(a,b,c){return a.xa("TR",null,a.xa("TD",{id:c,"class":"dialog-settings-label"},b))}function $9c(a,b,c,d,e,f,h){b=b.xa("TR",null,b.xa("TD","dialog-settings-input"),b.xa("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.Qa();uh(a,"labelledby",e);uh(a,"describedby",f);return b}function a$c(a){a=a.oa();return a.xa("TR",null,a.xa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.xa("HR",{"class":"dialog-settings-sep"})))}
p.Ga=function(){w_.ea.Ga.call(this);cf(this,"dialogselect",v(this.t1b,this));this.getHandler().R(this.C[3],"action",this.NWb);this.getHandler().R(this.ub,"select",this.qGb);var a=this.C[4].getElement();this.O.gj(a);IT(this.O,a,a);this.O.render();HT(this.O);this.getHandler().R(a,"change",v(this.dZb,this));a=this.C[5].getElement();this.L.gj(a);IT(this.L,a);this.L.render();HT(this.L);this.getHandler().R(a,"change",v(this.cZb,this));if(this.Wa){a=this.oa().getElement(W9c.p5a);var b=this.oa().getElement(W9c.q5a);
this.Ra.hb(a);gu(this.Ra,b);this.Ra.rc(!o1a||dqb(this.ma.F))}};p.setVisible=function(a){if(a){if(!this.jb){e$c(this);return}var b=this.ma.O;d$c(this,0,b.C);b=b.H||wvb().name();d$c(this,1,b);d$c(this,2,ow(this.F,3)&&V(this.F,3).oma()?V(this.F,3).Via().toString():"");d$c(this,3,ow(this.F,3)&&ow(V(this.F,3),1)?V(V(this.F,3),1)?"ON":"OFF":"OFF")}w_.ea.setVisible.call(this,a);this.jb&&!this.Bb&&((a=Od("ds-settings-link"))&&ud(a,this.xb),this.Bb=!0)};
function e$c(a){Os(a.Wc.Te("/info/settings").Cf(f$c()),v(function(a){a=a.sf();(a={locale:a.l?this.mK(a.l):null,UVa:a.tz?this.mK(a.tz):null,K9a:a.dls,kLb:a.dln,aZb:a.hl},a.locale)&&a.UVa&&(g$c(this,0,a.locale),g$c(this,1,a.UVa),g$c(this,2,X9c),g$c(this,3,Y9c),this.xb=a.K9a,this.Cb=a.kLb,this.Zb=a.aZb,this.Wa=o1a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Zb),this.jb=!0);this.setVisible(!0)},a)).we()}
function f$c(){var a=Fl(mB("win").location.href),b=Dl(a,"hl");a=Dl(a,"forcehl");return["hl",b,"forcehl",a]}function g$c(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Bk(e.caption,e.value);a.yd(e);th(e.getElement(),"menuitem")}a.tc().getElement().style.overflow="auto";tQ(a,!0)}p.mK=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function d$c(a,b,c){(a=a.C[b])&&a.Pa(c)}
p.t1b=function(a){if("save"==a.key)if("ON"!=this.C[3].We().La()||""==this.Ba&&""==this.va){h$c(this);a=this.ma.O.C;this.Hb.C(i$c(this));this.Hb.C(j$c(this));if(this.Wa){var b=!o1a||dqb(this.ma.F);var c=this.Ra.isChecked();b!=c?(pqb(this.ma,c),b=Aj(new zj,1).build(),this.zc.Vb(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].We(),c=null!=c&&c.La()!=a);c&&Fsa(this.ma.D.C,this.s1b)}else a.preventDefault(),h$c(this),""!=this.Ba&&GT(this.O,this.Ba,!0),""!=this.va&&GT(this.L,this.va,!0)};
p.NWb=function(a){if("ON"==a.target.La())for(a=0;a<this.J.length;a++)L(this.J[a],!0);else c$c(this);h$c(this)};function h$c(a){HT(a.O);HT(a.L)}p.dZb=function(){this.Ba="";var a=this.C[4].La()||"";a=this.Sb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ba="Please enter an integer value.";else if(0>=a||1E4<a)this.Ba="Please enter a value between 1 and 10000."};p.cZb=function(){this.va="";var a=this.C[5].La()||"";a=this.Sb.parse(a);isNaN(a)?this.va="Please enter a numeric value.":0>a&&(this.va="Please enter a non-negative value.")};
p.qGb=function(a){switch(a.target.getId()){case "general-settings-tab":L(this.Ta,!0);L(this.Oa,!1);break;case "calculation-settings-tab":L(this.Ta,!1),L(this.Oa,!0)}};function i$c(a){var b=a.C,c=b[V9c.BYa].We().La(),d=b[V9c.d1a].We().La();a=b[V9c.x1a].La()||"";b=b[V9c.FZa].La()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new wK(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function j$c(a){var b=a.C;a=a.ma.O;var c=b[V9c.N2].We();c=null==c?a.C:c.La();b=b[V9c.M4a].We();b=null==b?a.H||wvb().name():b.La();return new kwb(c,b)}p.s1b=function(){(new mwb).exec()};p.Ea=function(){hc(this.C,C);delete this.C;w_.ea.Ea.call(this)};function k$c(a,b,c,d,e,f,h,k){Bq.call(this,void 0,!1,k);this.J=this.L=this.ma=this.O=null;this.Oa=a;this.C=b;this.va=h;this.F=[];this.Ba=new Dcc(a,d,e,f)}q(k$c,Bq);p=k$c.prototype;
p.xa=function(){Bq.prototype.xa.call(this);var a=this.oa(),b=this.C.Kc(),c=tF(MA(b)),d=tF(new Dd(b.left+b.width-1,b.top+b.height-1));Cq(this,"Sort range from "+(c+(" to "+d)));l$c||(c=new Mq,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),l$c=c);Pq(this,l$c);ar(this,"save");var e;c=a.xa("DIV",{style:"overflow: hidden"},d=a.xa("SPAN","jfk-checkbox"),e=a.xa("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.J=new iu(void 0,a);f.hb(d);gu(f,e);1==b.height&&f.Na(!1);VJ(this.Oa,this.C.$b(),
b)||(f.rc(!0),f.Na(!1));J(I(),"fetdrisd")&&ritz_api.TablesApi.getTables((new xw).serialize(UA(b,this.C.$b())),v(function(a){if(0<a.length){var c=a[0];a=EQ(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c)&&1==J_a(SA(a)))c=UA(b,this.C.$b()),c=a.Ab()==c.Ab()&&F_a(SA(a),SA(c))&&F_a(TA(a),TA(c));c&&f.rc(!0)}},this));d=this.Ib();a.appendChild(d,c);this.O=a.xa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.xa("TABLE",{cellSpacing:"0"},this.ma=a.xa("TBODY")));
a.appendChild(d,this.O);c=m$c(this);this.F.push(c);c=a.xa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);te(c,!0);th(c,"button");this.L=c};p.Ga=function(){Bq.prototype.Ga.call(this);this.getHandler().R(this,"dialogselect",this.fMb).Cg(this.L,ff,this.Lmb).R(this.J,"change",this.gvb)};
function m$c(a){var b=a.oa(),c=0==a.F.length,d=new n$c(a,c,a.C,a.F.length,b),e=b.xa("TR",null,b.xa("TD",{colspan:"4"},b.xa("DIV","waffle-sd-row-separator")));d.render(a.ma);b.appendChild(a.ma,e);c||a.getHandler().Cg(d.D,ff,v(a.c9a,a,d));a=o$c(a);p$c(d,a);return d}p.c9a=function(a){var b=this.F;if(1<b.length){var c=Sa(b,a);-1!=c&&(jb(b,c),b=a.getElement(),b=me(b),a.dispose(),ie(b),L(this.L,!0),this.L.focus(),zB("Sort criteria removed."))}};
function o$c(a){var b=a.C.Kc(),c=b.kc();b=b.Xc();var d=Wa(a.F,function(a){return a.$j()},a);if(d)for(var e=mI(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=oI(a.C,f);if(!bb(d,h))return h}return null}p.gvb=function(){for(var a=this.F,b=0;b<a.length;b++)p$c(a[b])};p.Lmb=function(){var a=KA(this.C.Kc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(m$c(this)),zB("Sort criteria added."));di(Ra(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&L(this.L,!1)};
p.fMb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.$j());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Kc();d=KA(c,"r");if(this.J.isChecked()&&1<d){d=c.mc()+1;e=c.kc();var f=c.Vc(),h=c.Xc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}d=Aj(new zj,1).build();this.va.Vb(this.J.isChecked()?35697:35698,d);a=new Ccc(a,b,this.C,c,this.J.isChecked());Ecc(this.Ba,this.C,a)}};p.Ea=function(){Bq.prototype.Ea.call(this);Bb(this.F)};var l$c=null;
function n$c(a,b,c,d,e){M.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.V=-1;this.$=a;this.O=b;this.H=c}q(n$c,M);n$c.prototype.$j=function(){var a=this.C.We();return a?a.La():-1};
n$c.prototype.xa=function(){var a=this.oa(),b=this.O?"sort by":"then by",c,d,e,f=a.xa("TR","waffle-sd-tr-rules",a.xa("TD","waffle-sd-delete",this.O?"":this.D=a.xa("SPAN",{title:"Remove sort criteria."},"x")),a.xa("TD","waffle-sd-td-rules",a.xa("LABEL",{id:yi(this,"csl")},b)),b=a.xa("TD","waffle-sd-column-selector"),a.xa("TD","waffle-sd-td-ascending",e=a.xa("DIV",null,c=a.xa("DIV",{title:"Ascending"}),d=a.xa("DIV",{title:"Descending"}))));th(e,"radiogroup");e=this.F=new yU(a,Ee(a,Fp(LM(!0,this.Ke()))),
"ascending");e.render(c);a=this.L=new yU(a,Ee(a,Fp(LM(!1,this.Ke()))),"descending");a.render(d);this.J=new AU([e,a]);BU(this.J,e);a=this.C=l_();a.render(b);uh(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(te(this.D,!0),th(this.D,"button"),yh(this.D,"Remove sort criteria."));this.Ua=f};
function p$c(a,b){var c=a.oa(),d=a.$.J.isChecked(),e=a.H.Kc(),f=e.mc(),h=e.kc();e=e.Xc();a.V=b||a.$j();for(b=a.C.Fi();0<b;b--)a.C.cC(0);for(;h<e;h++)b=Sb(sH(a.H.dh(f,h)),25),b=new Bk(Jb(b)||!d?"Column "+nF(h):b,oI(a.H,h),c),b.Id("waffle-sd-menu-item"),a.C.yd(b);a.C.jf(0);0<=a.V&&a.C.Pa(a.V)}n$c.prototype.Ea=function(){M.prototype.Ea.call(this);this.C=this.D=this.H=this.$=null;C(this.F);C(this.L);C(this.J);this.J=this.L=this.F=null};function q$c(a,b,c){return $Ca(a||"There was a problem",od(b),void 0,void 0,void 0,void 0,c)};function r$c(a,b){Bq.call(this,"docs-material-dialog",a,b);Pq(this,null);Oq(this,!0);Iq(this,this.$J?0:.6);this.O=new NV("Ok");this.Fa(this.O);this.C=new qDc("Cancel");this.Fa(this.C)}q(r$c,Bq);p=r$c.prototype;p.Ga=function(){var a=this;Bq.prototype.Ga.call(this);this.getHandler().R(this.O,"action",function(){return a.Z7()}).R(this.C,"action",function(){a.dispatchEvent("Pe")&&a.setVisible(!1)}).R(this.Qa(),"keypress",this.aMb)};
p.aMb=function(a){13==a.keyCode&&(a.target==HCa(this)||a.target==this.C.getElement()?this.dispatchEvent("Pe")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.Z7())};p.Z7=function(){this.dispatchEvent("Oe")&&this.setVisible(!1)};p.xa=function(){Bq.prototype.xa.call(this);var a=Gq(this);this.C.render(a);this.O.render(a);L(a,!0);gr(HCa(this),sDc)};p.Fz=function(a){Bq.prototype.Fz.call(this,a);Iq(this,this.$J?0:.6)};function s$c(a,b,c){r$c.call(this);Cq(this,"Grouping rule");this.va=a;this.Oa=b;this.Ba=c;this.ma=new M;this.Fa(this.ma,!0);this.F=new t$c("Minimum value","e.g. 0",!0);this.ma.Fa(this.F,!0);this.L=new t$c("Maximum value","e.g. 100",!0);this.ma.Fa(this.L,!0);this.J=new t$c("Interval size","e.g. 10",!1);this.Fa(this.J,!0);(a=this.va.C.getActiveGrid())&&(a=sI(a.Ec()))&&(a=u$c(this,a))&&ow(a,10)&&ow(V(a,10),3)&&(a=V(V(a,10),3),ow(a,1)&&(b=V(a,1),this.F.D.Pa(YV.format(b))),ow(a,2)&&(b=V(a,2),this.J.D.Pa(YV.format(b))),
ow(a,3)&&(a=V(a,3),this.L.D.Pa(YV.format(a))))}q(s$c,r$c);
s$c.prototype.Z7=function(){var a=v$c(this.F),b=v$c(this.J),c=v$c(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(w$c(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(w$c(this.F,"Value too large"),d=!1):d=!0;if(d){d=new My;d.setType(2);var e=new Py;null!=a&&W(e,1,a);null!=b&&W(e,2,b);null!=c&&W(e,3,c);W(d,3,e);if(a=this.va.C.getActiveGrid())if(a=a.Ec(),b=sI(a))if(c=u$c(this,b))W(c,10,d),this.Oa.C(new QL(b,a)),zB("Pivot table headings grouped.");r$c.prototype.Z7.call(this)}};
function u$c(a,b){b=vib(b,function(b){return b.gY()==a.Ba});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return ow(b[0],10)?b[0]:b[1]}function t$c(a,b,c,d){M.call(this,d);this.L=a;this.O=b;this.V=c;this.J=new M;this.Fa(this.J,!0);this.D=new UV;this.Fa(this.D,!0);this.H=null;this.C=new M;this.Fa(this.C,!0);this.F=new FT(this.oa(),!0,!0);this.qa(this.F)}q(t$c,M);
t$c.prototype.Ga=function(){M.prototype.Ga.call(this);this.Qa().className="waffle-pivot-histogram-errorable-input";this.J.Qa().className="waffle-pivot-histogram-dialog-caption";this.oa().Re(this.J.getElement(),this.L);this.H=this.D.Nd().fM(this.D.Qa());this.H.placeholder=this.O;yh(this.H,this.L+" - "+this.O);IT(this.F,this.H);this.C.Qa().className="waffle-pivot-histogram-dialog-error";th(this.C.Qa(),"alert");uh(this.C.Qa(),"live","polite");x$c(this)};
function v$c(a){x$c(a);var b=a.D.La();if(Jb(b)){if(a.V)return null;w$c(a,"Required");return NaN}b=YV.parse(b);isNaN(b)&&w$c(a,"Must be a number");return b}function w$c(a,b){a.C.Qa().style.visibility="";a.oa().Re(a.C.Qa(),b);GT(a.F,b,!1)}function x$c(a){a.C.Qa().style.visibility="hidden";HT(a.F)};function y$c(a){return P("<li class='nfd-format-pill'><div class='nfd-format-display'>"+O(a.shb)+"</div><div class='nfd-format-sample'>"+O(a.aUb)+"</div></li>")};function z$c(a,b,c){M.call(this);this.Uc(a);this.D=b;this.C=c}x(z$c,M);p=z$c.prototype;p.xa=function(){var a=this.Sa(),b=this.C?eba(a.qz(),30):a.qz();a=this.C?A8b(a,this.D):"";this.Ua=N(y$c,{shb:b,aUb:a})};p.Ga=function(){z$c.ea.Ga.call(this);te(this.getElement(),!0);var a=new ek(this.getElement());this.qa(a);this.getHandler().R(a,"key",this.o3b).R(this.getElement(),"mousedown",this.n3b).R(this.getElement(),"dblclick",this.nsb)};
p.o3b=function(a){function b(a,b){for(;b=a(b);)if(oi(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(me,this.getElement());break;case 38:b(Yca,this.getElement())}};p.n3b=function(a){a.preventDefault();this.dispatchEvent("change")};p.nsb=function(){this.dispatchEvent("action")};function A$c(a,b,c){M.call(this);this.D=b;this.C=c;B$c(this,a)}x(A$c,M);A$c.prototype.xa=function(){this.Ua=this.oa().xa("UL","nfd-pill-container")};function B$c(a,b){z(b,function(b){a.Fa(new z$c(b,a.D,a.C),!0)})}A$c.prototype.filter=function(a){a=a.toLowerCase();this.xf(function(b){var c=Jb(Xb(a)),d=b.Sa().qz().toLowerCase();c=c||Rb(d,a);L(b.getElement(),c)})};function x_(a){Bq.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Hga();this.Fa(this.input,!0);this.J=new M;this.Fa(this.J,!0);a=this.u6();ob(a,void 0,i8c);this.C=new A$c(a,this.mY(),this.TUa());this.J.Fa(this.C,!0);Pq(this,null);this.Qi=!0}x(x_,Bq);p=x_.prototype;p.QXa=Ke;p.TUa=Je;p.isEmpty=function(){return Jb(this.input.La())};p.mf=function(){return this.input.Sa().mf()};p.xa=function(){x_.ea.xa.call(this);var a=Xd("DIV","dialog-separator");he(a,Fq(this))};
p.Ga=function(){x_.ea.Ga.call(this);Bh(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.vub).R(this.C,"action",this.lta).R(this.input.O,"action",this.lta).R(this.input,"afterhide",this.Ymb);this.input.V&&this.getHandler().R(this.input.V,"input",this.g3b);var a=this.input.va;a&&this.getHandler().R(a,"key",this.h3b);a=this.u6()[0];this.input.cN(a)};p.Ymb=function(a){a.stopPropagation()};p.vub=function(a){this.input.cN(a.target.Sa());C$c(this.input,!1)};
p.g3b=function(){this.C.filter(this.input.La());C$c(this.input,!this.input.Sa().mf())};p.h3b=function(a){13==a.keyCode&&this.lta()};p.lta=function(){this.mf()&&!this.isEmpty()?(z3a.Wb(new DQ(this.f2(),void 0,this.QXa())),this.setVisible(!1)):(C$c(this.input,!0),this.input.OFa())};function y_(a,b,c,d,e){Bk.call(this,b,c,d,e);this.C=a}x(y_,Bk);y_.prototype.bk=function(){var a=y_.ea.bk.call(this),b=this.getParent();return b&&b instanceof uk&&!b.isVisible()?this.C(a,this.Sa()):a};function z_(a){M.call(this);this.J=new M;this.qa(this.J);this.D=new eR("");this.qa(this.D);this.O=new Cr("");this.qa(this.O);this.$=a;this.va=null}x(z_,M);p=z_.prototype;
p.Ga=function(){z_.ea.Ga.call(this);var a=Ai(this,"nfd-icwr");this.J.hb(a);this.Fa(this.J);if(a=Ai(this,"nfd-i"))this.D.hb(a),this.D.Qd(this.J),Dh(this.D.getElement(),"jfk-textinput"),a=new Cs,a.hb(this.D.getElement()),this.qa(a),this.V=a=new Bs(this.D.getElement()),this.qa(a),this.va=a=new ek(this.D.getElement()),this.qa(a),a=new zq(this.D.getElement()),this.getHandler().R(a,"focusout",Da(this.OXa,!1)).R(a,"focusin",Da(this.OXa,!0)).R(this.V,"input",this.f3b);a=Ai(this,"nfd-a");this.O.hb(a);this.Fa(this.O)};
p.La=function(){return this.D.La()};p.f3b=function(){var a=this.Sa(),b=this.La();W(a.qH,2,b);this.PXa()};p.PXa=Ke;p.OXa=function(a){Fh(this.J.getElement(),"nfd-input-focus",a)};p.cN=function(a){this.Uc(a.clone());this.D.Pa(a.qz());try{this.D.getElement().focus()}catch(b){}};p.OFa=function(){this.D.getElement().focus()};function C$c(a,b){a=a.J.getElement();Fh(a,"nfd-invalid",b)};function D$c(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+R(a.c_)+"'>"+E$c(a)+"</div>"+F$c(a,b)+"</div>")}function G$c(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+R(a.c_)+"'></div>"+F$c(a,b)+"</div>")}
function H$c(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+R(a.c_)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+E$c(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+R(a.RJb)+"'></div></div></div></div>"+F$c(a,b)+"</div>")}
function I$c(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+J$c({label:""});a+=J$c({label:sr("Negative:")});a+=J$c({label:sr("Zero:")});a+=J$c({label:sr("Text:")});return P(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function J$c(a){return P("<tr><td class='nfd-sample-label'>"+O(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function F$c(a,b){a=""+O(Br({id:a.gW,style:2,Kd:"nfd-apply",content:rr("Apply")},b));return P(a)}function E$c(a){return P(O(B9c({id:a.zNa,N$:a.ANa,YYb:!0})))};function K$c(a){z_.call(this,a);this.F=new M;this.C=new sO("")}x(K$c,z_);p=K$c.prototype;p.xa=function(){this.Ua=N(H$c,{c_:yi(this,"nfd-icwr"),zNa:yi(this,"nfd-i"),ANa:this.$,RJb:yi(this,"nfd-ic"),gW:yi(this,"nfd-a")})};p.Ga=function(){K$c.ea.Ga.call(this);var a=Ai(this,"nfd-ic");this.F.hb(a);this.F.Qd(this.J);this.F.Fa(this.C,!0);this.getHandler().R(this.C,"aftershow",this.i3b).R(this.C,"action",this.xKa).R(this.V,"input",Da(this.HWa,null))};
p.cN=function(a){K$c.ea.cN.call(this,a);a.C&&this.D.Pa(Ht[a.C][1]);this.HWa(a)};
p.HWa=function(a){a=a?a.C:void 0;var b=this.C;b.Nf(null);if(a){var c=this.Sa(),d=c.C;L$c(this,c);c=Icc(d,Ht[d][2]);c=new DQ(M$c(c),Hcc[d],d);L$c(this,c);c=Icc(d,d+" "+Ht[d][1]);d=new DQ(M$c(c),Hcc[d],d);L$c(this,d)}else this.Sa().C=null;var e="[$"+this.La()+"]";d=a?Hcc[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new DQ(M$c(c[e]),d,a);L$c(this,f)}b.jf(0);this.xKa();Bh(b.tc().getElement(),"number-format-menu")};function L$c(a,b){var c=new y_(function(a){return eba(a,25)},A8b(b,1E3),b);a.qa(c);a.qa(b);c.qp(!0);a=a.C;for(b=0;b<a.Fi();b++)if(a.hf(b).bk()==c.bk())return;a.yd(c)}p.xKa=function(){for(var a=this.C,b=0;b<a.Fi();b++)a.hf(b).rc(!1);a.fI()};p.i3b=function(){this.C.We().rc(!0)};function M$c(a){var b=new Dw;W(b,2,a);b.setType(4);return b};function N$c(a){x_.call(this,a);Cq(this,"Custom currencies")}x(N$c,x_);p=N$c.prototype;p.mY=n(1000.12);p.Hga=function(){return new K$c("Custom currency")};p.u6=function(){var a=this;T$b();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=Hcc[e]:c8c(d,Kcc(d.El()))}var f=[];hc(Ht,function(b,c){b=Jcc(c);a.qa(b);f.push(b)});var h=WDc();tb(f,function(a,b){return h(a.qz(),b.qz())});return b.concat(f)};
p.f2=function(){var a=new Dw;a.setType(4);W(a,3,1);var b=this.input.C.We().La().El();W(a,2,b);return a};p.QXa=function(){return this.input.Sa().C};function O$c(a){M.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(O$c,M);O$c.prototype.xa=function(){var a=N(I$c);this.F=Sd("nfd-sample-label",a);this.D=Oca("nfd-rendered-sample",a);this.Ua=a};function A_(a,b){z_.call(this,a);this.C=new O$c(b);this.Uc(new DQ(""))}x(A_,z_);A_.prototype.xa=function(){this.Ua=N(D$c,{zNa:yi(this,"nfd-i"),ANa:this.$,c_:yi(this,"nfd-icwr"),gW:yi(this,"nfd-a")})};A_.prototype.Ga=function(){A_.ea.Ga.call(this);this.Fa(this.C,!0);P$c(this)};A_.prototype.PXa=function(){P$c(this)};A_.prototype.cN=function(a){A_.ea.cN.call(this,a);P$c(this)};
function P$c(a){var b=a.Sa();if(b){var c=a.C;a=b.El().split(";").length-1;re(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=A8b(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.El()),k=d<=a;L(oe(e),k);re(e,f);Sh(e,"color",h||"")}d=b.mf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.El()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.El());c=c.D[3];L(oe(c),3<=a);re(c,d);Sh(c,"color",b||"")}};function Q$c(a){x_.call(this,a);Cq(this,"Custom number formats")}x(Q$c,x_);Q$c.prototype.mY=n(1234.56);Q$c.prototype.Hga=function(){return new A_("Custom number format",1234.56)};
Q$c.prototype.u6=function(){var a=this.F;a.push(new DQ("0"));a.push(new DQ("0.00"));a.push(new DQ("#,##0"));a.push(new DQ("#,##0.00"));a.push(new DQ("#,##0_);(#,##0)"));a.push(new DQ("#,##0_);[Red](#,##0)"));a.push(new DQ("#,##0.00_);(#,##0.00)"));a.push(new DQ("#,##0.00_);[Red](#,##0.00)"));a.push(new DQ("$#,##0_);($#,##0)"));a.push(new DQ("$#,##0_);[Red]($#,##0)"));a.push(new DQ("$#,##0.00_);($#,##0.00)"));a.push(new DQ("$#,##0.00_);[Red]($#,##0.00)"));a.push(new DQ("@"));a.push(new DQ("0%"));a.push(new DQ("0.00%"));
a.push(new DQ("0.00E+00"));a.push(new DQ("##0.0E+0"));a.push(new DQ("# ?/?"));a.push(new DQ("# ??/??"));a.push(new DQ('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new DQ('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new DQ('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new DQ('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};Q$c.prototype.f2=function(){var a=new Dw;a.setType(2);W(a,3,1);var b=this.input.La();W(a,2,b);return a};function B_(a,b){Gk.call(this,b,new R$c(a))}x(B_,Gk);p=B_.prototype;p.kh=function(a,b,c){B_.ea.kh.call(this,a,b,c);a.Qb()&&this.Qb()&&a.getParent()==this&&S$c(this)};p.Ga=function(){B_.ea.Ga.call(this);S$c(this)};p.Yc=function(a){B_.ea.Yc.call(this,a);S$c(this)};p.removeChild=function(a,b){a=B_.ea.removeChild.call(this,a,b);S$c(this);return a};p.Hp=function(a,b){a=B_.ea.Hp.call(this,a,b);S$c(this);return a};
p.Hj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=yk(this);if(c){b=39==b;this.Ke()&&(b=!b);c=c.getElement();c=Sa(c.parentNode.childNodes,c);var d=(d=(d=yk(this))?mda(d.getElement(),T$c):null)?Sa(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=U$c(this,e);b?b=U$c(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.Iaa(this.Oq()+b);b=!0}else b=!1}b=!b}return b?B_.ea.Hj.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function U$c(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function S$c(a){var b,c=a.Nd(),d=a.ad(),e=lb(Rd("div",T$c,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.oa().xa("DIV",T$c),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.ad();k++)a.ld(k)instanceof Fk?(d.push(new V$c(b,k,!0)),b=k+1):a.ld(k)instanceof Ak&&(0==k?h=!0:(a.ld(k-1),d.push(new V$c(b,k-1,!1)),b=k));k=a.ad();0<d.length&&Ra(d).end!=k-1&&d.push(new V$c(b,k-1,!1));b=h;h=a.ad();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.ad()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else W$c(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.ad();f++){for(;f>c[d];)++d;b=a.ld(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Fk?L(h,!1):L(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function W$c(a,b,c){function d(a){return a.end-a.start-(a.NIb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;gb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,gb(a,l,1))}}function V$c(a,b,c){this.start=a;this.end=b;this.NIb=c}function R$c(a){Ek.call(this);this.D=a}x(R$c,Ek);var T$c="docs-multi-menu-col";function X$c(a){A.call(this);this.C=a}x(X$c,A);X$c.prototype.create=function(){return new B_(this.C)};function Y$c(a,b){z_.call(this,a);this.ma=new M;this.H=new Z$c;this.F=new M;a=(new X$c(3)).create();a.Fa(new Ak("Date"),!0);a.Fa(new Bk("Day","DAY_TOKEN"),!0);a.Fa(new Bk("Month","MONTH_TOKEN"),!0);a.Fa(new Bk("Year","YEAR_TOKEN"),!0);a.Fa(new Ak("Time"),!0);a.Fa(new Bk("Hours","HOURS_TOKEN"),!0);a.Fa(new Bk("Minutes","MINUTES_TOKEN"),!0);a.Fa(new Bk("Seconds","SECONDS_TOKEN"),!0);a.Fa(new Bk("Milliseconds","MILLIS_TOKEN"),!0);a.Fa(new Bk("AM/PM","AM_PM_TOKEN"),!0);a.Fa(new Ak("Duration"),!0);a.Fa(new Bk("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Fa(new Bk("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Fa(new Bk("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new PRb(a);this.C=b}x(Y$c,z_);p=Y$c.prototype;p.xa=function(){this.Ua=N(G$c,{c_:yi(this,"nfd-icwr"),gW:yi(this,"nfd-a")})};
p.Ga=function(){Y$c.ea.Ga.call(this);Bh(this.getElement(),"nfd-date-time-input");var a=Ai(this,"nfd-icwr"),b=this.ma;b.hb(a);b.Qd(this);b.Fa(this.L,!0);Bh(this.L.getElement(),"nfd-date-time-menu-button");Bh(this.L.tc().getElement(),"nfd-date-time-menu");yh(this.L.Qa(),"Add a date or time format");b.Fa(this.H,!0);Nc||Bh(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Fa(a,!0);Sh(a.getElement(),"display","inline");this.getHandler().R(this,"Qe",Da(this.RXa,"left")).R(this,"Ue",Da(this.yLa,
"left")).R(this,"Ve",Da(this.yLa,"right")).R(this,"We",Da(this.jMa,"left")).R(this,"Xe",Da(this.jMa,"right")).R(this,"Te",Da(this.RXa,"right")).R(this.L,"action",this.crb)};p.OFa=function(){this.ma.getElement().focus()};
p.cN=function(a){this.Uc(a.clone());var b=this.F;b.Fd(!0);re(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.El());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?re(this.H.getElement(),d[2]):(e=b.ld(b.ad()-1),d=d[2],re(e.kA.getElement(),ve(e.kA.getElement())+d)):$$c(this,e).Pa(d[1])}0<b.ad()&&b.ld(b.ad()-1).xy.getElement().focus()};
p.La=function(){for(var a=this.H.toString(),b=0;b<this.F.ad();b++)a+=this.F.ld(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Tb(e,"["),e=Tb(e,"]")):c=!0}b+=e}return b};p.crb=function(a){a=a.target.La();$$c(this,a).xy.getElement().focus()};
function $$c(a,b){C$c(a,!1);switch(b){case "DAY_TOKEN":var c=aad(a);break;case "MONTH_TOKEN":c=bad(a);break;case "YEAR_TOKEN":c=cad(a);break;case "HOURS_TOKEN":c=dad();break;case "MINUTES_TOKEN":c=ead();break;case "SECONDS_TOKEN":c=fad();break;case "MILLIS_TOKEN":c=gad();break;case "AM_PM_TOKEN":c=had(a);break;case "ELAPSED_HOURS_TOKEN":c=iad();break;case "ELAPSED_MINUTES_TOKEN":c=jad();break;case "ELAPSED_SECONDS_TOKEN":c=kad()}b=c;b.Fa(new Fk,!0);b.Fa(new Bk("Delete"),!0);c=new lad(c,"");a.F.Fa(c,
!0);return c}p.RXa=function(a,b){b=b.target;if(b instanceof Z$c){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.ld(Bi(this.F,b)+1),!b))return}a=ve(b.kA.getElement());var c=b.getParent(),d=Bi(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=ve(b),re(b,c+a),mad(this.H,c.length)):(d--,b=c.ld(d),c=ve(b.kA.getElement()),re(b.kA.getElement(),ve(b.kA.getElement())+a),mad(b.kA,c.length))};
p.jMa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.ld(Bi(this.F,b)+a))&&a.xy.getElement().focus()};p.yLa=function(a,b){var c="left"==a?-1:0;(b=this.F.ld(Bi(this.F,b.target)+c))||"left"!=a?b&&(b=b.kA):b=this.H;c=ve(b.getElement()).length;mad(b,"left"==a?c:0)};function lad(a,b){M.call(this);this.xy=new sO("",a);this.Fa(this.xy,!0);this.kA=new Z$c(b);this.Fa(this.kA,!0)}x(lad,M);p=lad.prototype;
p.Ga=function(){lad.ea.Ga.call(this);Sh(this.getElement(),"display","inline-block");this.xy.jf(0);this.C=new ek(this.xy.getElement());this.qa(this.C);this.getHandler().R(this.xy,"action",this.j3b).R(this.C,"key",this.k3b)};p.j3b=function(){this.xy.fI();this.xy.We().Sa()||this.dispatchEvent("Te")};p.k3b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Te"));break;case 37:a.preventDefault();this.dispatchEvent("Ue");break;case 39:a.preventDefault(),this.dispatchEvent("Ve")}};
p.toString=function(){return this.xy.We().Sa()+this.kA.toString()};p.Pa=function(a){this.xy.Pa(a)};function Z$c(a){M.call(this);this.C=a||""}x(Z$c,M);p=Z$c.prototype;p.xa=function(){var a=Xd("SPAN");Td(a,{contentEditable:!0});re(a,this.C);var b=a.style;Jc&&!Uc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Nc?"-moz-pre-wrap":"pre-wrap";this.Ua=a};
p.Ga=function(){Z$c.ea.Ga.call(this);var a=new ek(this.getElement());this.qa(a);this.getHandler().R(a,"key",this.l3b).R(this.getElement(),"paste",this.m3b)};function mad(a,b){if(0==ve(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=gL(c,b);a.getElement().focus();b.select()}}
p.l3b=function(a){var b=ue(this.getElement()),c=XK(),d=ve(this.getElement()).length,e=c?0==c.Eh()&&0==c.Fn():Jb(Xb(b));b=c?c.Eh()==d&&c.Fn()==d:Jb(Xb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Qe"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Te"));break;case 40:this.dispatchEvent("Re");break;case 38:this.dispatchEvent("Se");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("We"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Xe"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Paa(ve(this.getElement())).replace(/"/g,'"\\""');return 0==Xb(a).length?"":'"'+a+'"'};p.m3b=function(){var a=v(function(){re(this.getElement(),ve(this.getElement()))},this);Ji(a)};
function aad(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new y_(Da(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new y_(Da(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new y_(Da(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new y_(Da(b,e),a,d));d=new Gk;for(e=0;e<c.length;e++)d.Fa(c[e],!0);return d}
function bad(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new y_(Da(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new y_(Da(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new y_(Da(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new y_(Da(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new y_(Da(b,e),a,d));d=new Gk;for(e=0;e<c.length;e++)d.Fa(c[e],!0);return d}
function cad(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new y_(Da(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new y_(Da(b,e),a,d));d=new Gk;for(e=0;e<c.length;e++)d.Fa(c[e],!0);return d}
function dad(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function ead(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function fad(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function gad(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new y_(Da(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new y_(Da(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function had(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new y_(Da(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new y_(Da(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new y_(Da(b,e),a,d));d=new Gk;for(e=0;e<c.length;e++)d.Fa(c[e],!0);return d}
function iad(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function jad(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function kad(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new y_(Da(a,d),e,c));c=new Gk;for(d=0;d<b.length;d++)c.Fa(b[d],!0);return c};function nad(a){x_.call(this,a);Cq(this,"Custom date and time formats")}x(nad,x_);p=nad.prototype;p.TUa=Ie;p.mY=n(11175.5628472222);p.isEmpty=function(){return Jb(uw(this.f2(),2))};p.mf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(uw(this.f2(),2))};p.Hga=function(){return new Y$c("Custom date time format",11175.5628472222)};p.f2=function(){return oad(this.input.La())};
p.u6=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.mY(),c.El());c.D=d}b=pad(this);ob(b);for(c=0;c<b.length;c++)a.push(new DQ(oad(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.mY(),b[c])));return a};
function pad(a){var b=wt,c=Wa(b.DATEFORMATS,function(a){return qad(a)},a),d=Wa(b.TIMEFORMATS,function(a){return qad(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;ob(b);a=Wa(b,function(a){return qad(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function qad(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Lb(a.join(""))}function oad(a){var b=new Dw;b.setType(7);W(b,3,1);W(b,2,a);return b};function rad(a,b){this.D=a;this.C=b}rad.prototype.getUrl=g("D");rad.prototype.getTitle=g("C");function sad(a,b,c,d,e,f){xs.call(this,a,b,"domain",d,e,f);this.H=c}x(sad,xs);sad.prototype.UV=function(){var a=sad.ea.UV.call(this);a.domainName=this.H;return ic(a,$Ea)};qFa.set("domain",function(a){return new sad(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new sad("","DEFAULT","",!0);function tad(){};function uad(a){for(var b="",c=a.oVb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.mVb[f.Fh()],k=f.getLabel();f=f.zJb;f=P('<div id="'+R(h)+'" tabindex="0" role="link" class="'+R("ess-button")+'" aria-label="'+R(k)+'"><div class="'+R("ess-icon")+" "+R(f)+'"></div></div>');b+=f}return P(b)};function vad(a,b){M.call(this,b);this.D=a||[];this.F=[];this.C=null}x(vad,M);p=vad.prototype;p.Td=!0;p.Xea=!1;p.FP=null;p.cEa=!1;p.Na=function(a,b){this.Td=a;this.Xea=b;if(this.cEa){b=this.oa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.FP.Kqa+"-"+d.Fh()),f=a;Fh(e,"ess-button",f);Fh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();dj(e,f,d)}}};
p.xa=function(){this.Ua=this.ib.createElement("SPAN");var a={};a.Kqa=yi(this,"service");a.oVb=this.D;this.FP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.Fh()]=this.FP.Kqa+"-"+d.Fh();a.mVb=b;this.FP=a;gr(this.getElement(),uad,this.FP);this.cEa=!0};
p.kTb=function(a){if(this.Td){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.Xea)this.dispatchEvent(new wad(new xad(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={qIc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Dp(b,a))&&a.focus()}}};
p.Ga=function(){this.Na(this.Td,this.Xea);for(var a=this.oa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.FP.Kqa+"-"+d.Fh());b.Cg(e,ff,v(this.kTb,this,d))}};p.Ea=function(){vad.ea.Ea.call(this);delete this.F;delete this.D;this.C=null};function wad(a,b){D.call(this,"Ye",b);this.context=a}x(wad,D);function xad(){}x(xad,tad);function C_(a,b,c,d){this.C=a;this.F=b;this.D=c;this.zJb=d;this.H=yad++}var yad=0;C_.prototype.Fh=g("H");C_.prototype.getName=g("F");C_.prototype.getLabel=g("D");function zad(){C_.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(zad,C_);zad.prototype.getUrl=function(a){var b=Wa(a,function(a){return a.getTitle()});a=Wa(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Nb(a.join(","))+"&t="+Nb(b.join(","))};function Aad(){C_.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(Aad,C_);Aad.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Nb(a[0].getUrl())};function Bad(){C_.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(Bad,C_);Bad.prototype.getUrl=function(a){a=Wa(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Nb(a.join("\n"))};function Cad(){C_.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(Cad,C_);Cad.prototype.getUrl=function(a){for(var b=pa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Nb(a)};function D_(a){M.call(this,a)}x(D_,M);function Dad(a){a.dispatchEvent(new D("Ze"))}D_.prototype.pY=function(){return{}};D_.prototype.EK=Ke;D_.prototype.Eqa=sa;function Ead(a){M.call(this,a)}x(Ead,M);Ead.prototype.F=Ke;Ead.prototype.H=sa;Ead.prototype.J=sa;function Fad(a,b,c){b=c||b;c='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+h8c(a.locale)+'&answer=183965">Learn more</a>');c=c+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';
c+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';c+="Embed";c+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+R(a.Bbb)+'" readonly="readonly" aria-label="';c+=vr("Link to published document.");c+=" "+R(a.sSa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';
c+="Or share this link using:";c+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';c+=vr("HTML embed code of published document.");c+=" "+R(a.sSa)+'">'+vDa(a.ugb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+O(Br({id:"pub-dialog-publish-link-button",
style:2,value:a.jTb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+O(Ds({Dt:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));c+="Published content & settings";c+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+O(Br({id:"pub-dialog-publish-button",value:a.hTb},b))+'<div class="pub-dialog-checkbox-container">';
a.cKb&&(c+=O(hu({id:"pub-dialog-dom-signin-req",checked:a.Vs,disabled:a.ZJ},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.ZJ?' class="pub-dialog-disabled-text"':"")+">",d="Require viewers to sign in with their "+(O(a.domain)+" account"),c+=d,c+="</label><br>");a.SP&&(c+=O(hu({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">',c+="Automatically republish when changes are made",
c+="</label>");c+="</div></div></div></div></div>";return P(c)};function E_(a,b,c,d,e,f,h,k,l,m){du.call(this);this.ub=a||"";this.Fe=b;this.hd=c;this.Wc=d;this.Lc=l||"/publishsettings";this.C=new Gad(e);this.Bb=new vad([new Aad,new Bad,new zad,new Cad]);this.Fa(this.Bb);this.va=new Cr(null,this.oa());this.Fa(this.va);this.ma=new Cr(null,this.oa());this.Fa(this.ma);this.Ra=new iu(void 0,this.oa());this.Fa(this.Ra);this.Ba=new iu(void 0,this.oa());this.Fa(this.Ba);this.Ta=0;this.Sb=new Had;this.Fa(this.Sb);this.xb=this.Cb=null;this.J=f||new D_;this.Fa(this.J);this.F=
h||new D_;this.Fa(this.F);this.Oa=k||new Ead;this.Fa(this.Oa);this.O=this.L=null;this.jb=new us(void 0,Iad,this.oa(),2);this.qa(this.jb);this.re=this.qd=null;this.Se=m||new M;this.Zb=this.Wa=this.Hb=null;this.Qi=!0}x(E_,du);var Iad="Press "+((Qc?"\u2318+C":"Ctrl+C")+" to copy.");p=E_.prototype;p.show=function(){Jad(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){E_.ea.setVisible.call(this,a);var b=Ce(this.oa());a?this.getHandler().R(b,"resize",this.vd):this.getHandler().Qc(b,"resize",this.vd)};
p.xa=function(){E_.ea.xa.call(this);var a=this.oa(),b=N(Fad,{cKb:!!this.C.domain,SP:this.C.SP(),Vs:this.C.Vs,domain:this.C.C,ZJ:this.C.ZJ,hTb:Kad(this),jTb:F_(this,Lad(this))?"Published":"Publish",Bbb:this.C.Mk?Mad(this,this.J.pY()):"",ugb:this.C.Mk?Nad(this,this.F.pY()):"",locale:"en",sSa:Iad});a.appendChild(this.Ib(),b);Cq(this,"Publish to the web");Pq(this,null);Bh(this.Ib(),"pub-dialog-content")};
p.Ga=function(){var a=this.oa(),b=a.getElement("pub-dialog-sharing-services-links");this.Bb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Hb=a.getElement("pub-dialog-links-notice");this.Se.render(this.Hb);b=a.getElement("pub-dialog-published-content");this.Oa.render(b);E_.ea.Ga.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.Ra.hb(c),gu(this.Ra,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.Ra,"change",this.hYb));this.C.SP()&&(this.Ba.hb(a.getElement("pub-dialog-auto-publish-checkbox")),gu(this.Ba,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Ba,"change",this.dYb));this.Cb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.xb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");ss(this.jb,this.L);this.Sb.hb(a.getElement("pub-dialog-links-tab-bar"));this.qd=a.getElement("pub-dialog-sharing-services");
this.re=a.getElement("pub-dialog-status-info");this.va.hb(a.getElement("pub-dialog-publish-link-button"));this.ma.hb(a.getElement("pub-dialog-publish-button"));this.Zb=new nP("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Mk);this.qa(this.Zb);b.R(this.Sb,"select",this.TDb).R(this.L,"focus",this.MTa).R(this.O,"focus",this.MTa).R(this.ma,"action",this.lTb).R(this.getElement(),"keyup",this.Lab).R(this.J,"Ze",this.ysa).R(this.F,"Ze",this.ysa).R(this.va,"action",this.UBb).R(this.Oa,
"$e",this.VBb).R(this.Zb,"toggle",this.vd);Oad(this)};function Oad(a){if(a.Qb()){var b=a.oa(),c=a.C.Mk,d=a.C.ZJ;a.Oa.H(a.C.Lm);a.Ra.Na(!d);a.ma.setContent(Kad(a));a.ma.Na(a.C.Mk||!a.C.Lm||!a.C.Lm.isEmpty());a.C.SP()&&a.Ba.rc(a.C.Fw);a.ysa();b=b.Oi("pub-dialog-state-publishing");z(b,function(a){L(a,c)});re(a.re,c?"This document is published to the web.":"This document is not published to the web.");a.vd()}}p.Lab=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function Pad(a,b){var c=window.location.href,d=Zk(c);c=bl(c);var e=Rb(c,"/"+a.Wc+"/")?"/"+a.Wc:"";a.C.Vs&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.ub;b=uJa.test(b)?b:tl("/d/"+a,b);return Yk(c,f,h,d,tl(e,b))}
p.ysa=function(){var a=this.J.EK();if(a=F_(this,a)){var b=this.J.pY();b=this.C.Mk?Mad(this,b):"";this.L.value=b;this.Bb.F=[new rad(b,this.Fe)]}L(this.L,a);L(this.qd,a&&!this.C.ZJ);a=this.F.EK();if(a=F_(this,a))b=this.F.pY(),this.O.value=this.C.Mk?Nad(this,b):"";L(this.O,a);a=F_(this,Lad(this));L(this.Hb,a);this.va.Na(!a);this.va.setContent(F_(this,Lad(this))?"Published":"Publish")};
p.TDb=function(a){a=a.target;this.oa();ts(this.jb);"pub-dialog-link-tab"==a.getId()?(this.Ta=0,L(this.Cb,!0),L(this.xb,!1),ss(this.jb,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.Ta=1,L(this.Cb,!1),L(this.xb,!0),ss(this.jb,this.O));Oad(this)};p.MTa=function(a){Ji(function(){a.target.select()},0)};p.hYb=function(){this.C.Mk?Qad(this,2,!1):this.C.Vs=!this.C.Vs};p.dYb=function(){this.C.Mk?Qad(this,0,!1):this.C.Fw=!this.C.Fw};function Kad(a){return a.C.Mk?"Stop publishing":"Start publishing"}
function Jad(a,b){Os(a.hd.Te(a.Lc).Cf("id",a.ub),v(function(a){this.C.Mk=!!Ym(a,"published");this.C.Vs=!!Ym(a,"requireSignin");this.C.ZJ=!!Ym(a,"domainClosed");this.C.domain=Gsc(a,"domain");this.C.C=Gsc(a,"domainDisplay");this.C.Fw=!Number(Ym(a,"revision"));this.C.Lm=this.tHa(a.sf());this.C.F=Gsc(a,"publishedDocumentId");b()},a)).we()}p.tHa=Ke;p.$Ga=Ke;function Rad(a){return{Fw:a.C.Fw,Mk:a.C.Mk,Vs:a.C.Vs,Lm:a.C.Lm}}
function Qad(a,b,c){c=t(c)?c:!0;var d=Rad(a);switch(b){case 0:d.Fw=!d.Fw;break;case 1:d.Mk=!d.Mk;break;case 2:d.Vs=!d.Vs;break;default:throw Error("Unknown toggle op: "+b);}d.Mk||(d.Lm=a.$Ga());Sad(a,d,c)}
function Sad(a,b,c){Tad(a,!1);Wu(Os(Um(ku(a.hd.Te(a.Lc).Cf("id",a.ub),Uad(a,b)),2),v(function(){this.C.Fw=b.Fw;this.C.Mk=b.Mk;this.C.Vs=b.Vs;this.C.Lm=b.Lm;this.C.Mk&&this.C.Lm&&(F_(this,this.J.EK())||this.J.Eqa(this.C.Lm),F_(this,this.F.EK())||this.F.Eqa(this.C.Lm));Tad(this,!0);Oad(this);if(c&&this.C.Mk)switch(this.Ta){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.Ta);}},a)),v(function(){rKa("An error occurred while saving publishing settings.",
void 0,this.Qb()?this:void 0);Tad(this,!0);Oad(this)},a)).we()}function Uad(a,b){var c={id:a.ub,requireSignin:b.Vs,published:b.Mk};a.C.SP()&&!b.Fw&&(c.revision=a.C.D);b.Lm&&(a=Vad(b.Lm),Cc(c,a));return c}function Tad(a,b){for(var c=[a.Ba,a.ma,a.va,a.Ra],d=0;d<c.length;d++){var e=c[d];!b&&e.Io()&&(a.Wa=e);e.Na(b)}b&&a.Wa&&(a.isVisible()&&a.Wa.isVisible()&&(c=a.Wa.getElement())&&c.focus(),a.Wa=null);a.Oa.J(b)}
p.lTb=function(a,b){if(b||window.confirm(this.C.Mk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ma.setContent("Saving..."),Qad(this,1)};function Lad(a){switch(a.Ta){case 0:return a.J.EK();case 1:return a.F.EK();default:throw Error("Cannot handle selected link type "+a.Ta);}}
p.UBb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=Lad(this),b=Rad(this);b.Mk=!0;a&&(b.Lm&&this.C.Mk?b.Lm=Wad(b.Lm,a):b.Lm=a);this.va.setContent("Publishing...");Sad(this,b,!0)}};p.VBb=function(){var a=this.Oa.F();if(this.C.Mk)if(a&&a.isEmpty())Qad(this,1);else{var b=Rad(this);b.Lm=a;Sad(this,b)}else this.C.Lm=a,Oad(this)};function F_(a,b){var c;(c=a.C.Mk)&&!(c=!b||!a.C.Lm)&&(a=a.C.Lm,c=a.F||!b.F&&Za(b.D.Dd(),a.l9,a)&&Za(b.C,a.Z8,a));return c}
function Gad(a){this.D=a;this.ZJ=this.Vs=this.Mk=!1;this.Fw=!0;this.F=this.C=this.domain=""}Gad.prototype.SP=function(){return!!this.D};function Had(){XT.call(this)}x(Had,XT);Had.prototype.Hj=function(a){return a.keyCode&&27==a.keyCode?!1:Had.ea.Hj.call(this,a)};function Xad(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+h8c(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return P(b+a+"</div>")};function Yad(a,b,c,d){this.F=a;this.ah=b;this.C=c;this.D=d}function Zad(a,b){return new Yad(!1,null,new $ad(a,b||"interactive"),null)}function $ad(a,b){this.id=a;this.format=b};function G_(a,b,c){this.F=a;this.D=new Pm(b);this.C=c}p=G_.prototype;p.l9=function(a){return this.F||this.D.contains(a)};function abd(a,b){return Ya(a.C,function(a){return a.id==b.id})}p.Z8=function(a){return this.F||this.D.contains(a.ah)||abd(this,a)};function bbd(a,b){a.C=Ua(a.C,function(a){return a.ah!=b})}function cbd(a,b){abd(a,b)&&(a.C=Ua(a.C,function(a){return a.id!=b.id}))}
function Wad(a,b){var c=a.F||b.F;if(c)return new G_(c,[],[]);var d=a.clone();z(b.D.Dd(),function(a){d.D.contains(a)||(d.D.add(a),bbd(d,a))});z(b.C,function(a){d.Z8(a)||d.C.push(a)});return d}function Vad(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Dd().join(","),charts:Wa(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&cb(this.C)};p.clone=function(){return new G_(this.F,this.D.Dd(),lb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&vb(this.C,a.C,function(a,c){return a.id==c.id&&a.ah==c.ah})};function dbd(a,b){this.id=a;this.ah=b};function ebd(a,b,c,d){M.call(this,void 0);this.C=c||new Yad(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new sO("",fbd(a,b));tQ(this.D,!0);this.Fa(this.D,!0);a=new Gk;a.Fa(new Bk("Interactive","interactive"),!0);a.Fa(new Bk("Image","image"),!0);this.H=new sO("",a);this.Fa(this.H,!0);a=new Gk;a.Fa(new Bk("Web page","html"),!0);a.Fa(new Bk("Comma-separated values (.csv)","csv"),!0);a.Fa(new Bk("Tab-separated values (.tsv)","tsv"),!0);a.Fa(new Bk("PDF document (.pdf)","pdf"),!0);a.Fa(new Bk("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Fa(new Bk("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new sO("",a);this.Fa(this.F,!0);gbd(this)}x(ebd,D_);var hbd=["xlsx","ods"],ibd=["csv","tsv"];
function fbd(a,b){var c=new Gk;c.Fa(new Bk("Entire Document",new jbd("entireDocument",null)),!0);c.Fa(new Fk,!0);var d=Bpb(b);z(a.D,function(a){c.Fa(new Bk(a.ge(),new jbd("sheet",a.Ab())),!0);if(a=d[a.Ab()])for(var b={},e=0;e<a.length;b={oW:b.oW},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.oW=new Bk("",new jbd("chart",II(k))),AJ(k).then(function(a){return function(b){a.oW.wn(b.getTitle())}}(b)),c.Fa(b.oW,!0),Bh(b.oW.Ib(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=ebd.prototype;
p.Ga=function(){ebd.ea.Ga.call(this);Bh(this.getElement(),"pub-dialog-link-options-container");Bh(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");Bh(this.D.Ib(),"pub-dialog-link-options-document-part-menu-button-content");Bh(this.D.tc().getElement(),"pub-dialog-link-options-document-part-menu");yh(this.D.Qa(),"Sheet or chart selection");yh(this.H.Qa(),"Chart format");yh(this.F.Qa(),"Sheet format");this.getHandler().R(this.D,"change",this.esb).R(this.H,"change",this.$ob).R(this.F,
"change",this.EEb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};p.esb=function(){var a=this.D.We().Sa();switch(a.type){case "entireDocument":this.C=new Yad(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!kbd(this,a,b)&&(b=null);this.C=new Yad(!1,a,null,b||"html");break;case "chart":this.C=Zad(a.id,this.C.C?this.C.C.format:null)}gbd(this);Dad(this)};
p.$ob=function(){var a=this.H.We().Sa();this.C.C&&(this.C.C.format=a,Dad(this))};p.EEb=function(){var a=this.F.We().Sa();this.C.D=a;Dad(this)};
function gbd(a){var b=lb(a.D.Qj.C);b=$a(b,function(a){a=a.Sa();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.ah&&a.id==this.C.ah;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);Ur(a.D,b);b=!!a.C.C;L(a.H.getElement(),b);null!=a.C.C&&a.H.Pa(a.C.C.format);L(a.F.getElement(),a.J&&!b);b||(lbd(a),a.F.Pa(a.C.D))}
function lbd(a){for(var b=a.F.tc(),c=0;c<b.Fi();c++){var d=b.hf(c),e=d.La();d.Na(null==a.C.ah||kbd(a,a.C.ah,e))}}function kbd(a,b,c){if(bb(hbd,c))return!1;a=BF(a.O,b);return null!=a&&1==a.getSheetType()&&bb(ibd,c)?!1:!0}p.pY=g("C");p.EK=function(){if(this.C.F)return new G_(!0,[],[]);if(null!=this.C.ah)return new G_(!1,[this.C.ah],[]);var a=this.L.C(this.C.C.id);a=new dbd(this.C.C.id,a.Ab());return new G_(!1,[],[a])};
p.Eqa=function(a){if(!a.F){var b=a.D.Dd();0<b.length?this.C=new Yad(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=Zad(a[0].id)));gbd(this)}};function jbd(a,b){this.type=a;this.id=b};function H_(a,b){Gr.call(this,void 0,void 0,new rO,void 0);this.Ba=a;this.ma=b;this.H=new G_(!0,[],[]);this.V=!1;this.J=new lP("Entire Document");this.yd(this.J);this.yd(new Fk);mbd(this);tQ(this,!0);nbd(this)}x(H_,Gr);function mbd(a){var b=Bpb(a.ma);z(a.Ba.D,function(c){var d=new lP(c.ge(),c);a.yd(d);(c=b[c.Ab()])&&z(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new lP("",b);AJ(b).then(function(a){c.wn(a.getTitle())});a.yd(c);Bh(c.Ib(),"pub-dialog-published-content-chart-menu-item")}})})}
H_.prototype.Ga=function(){H_.ea.Ga.call(this);Bh(this.getElement(),"pub-dialog-published-content-menu-button");Bh(this.Ib(),"pub-dialog-published-content-menu-button-content");Bh(this.tc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
H_.prototype.Cs=function(a){if(a.target==this.J){a=this.J.isChecked();var b=this.H;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Sa(),b instanceof XD?(b=b.Ab(),a?(a=this.H,a.D.contains(b)||(a.D.add(b),bbd(a,b))):(a=this.H,a.D.contains(b)&&(a.D.remove(b),bbd(a,b)))):(b=new dbd(II(b),b.Ab()),a?(a=this.H,a.Z8(b)||a.C.push(b)):cbd(this.H,b));this.V=!0;nbd(this)};H_.prototype.Xd=function(a,b){H_.ea.Xd.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new D("$e")))};
function nbd(a){var b=a.H.F;a.J.rc(b);z(Fsc(a.tc()),function(c){var d=c.Sa();d&&(d instanceof XD?(c.rc(a.H.l9(d.Ab())),c.Na(!b)):(d=new dbd(II(d),d.Ab()),c.rc(a.H.Z8(d)),c.Na(!a.H.l9(d.ah))))});obd(a)}
function obd(a){if(a.H.F)a.setContent("Entire Document");else{var b=Ua(a.Ba.D,v(function(a){return this.H.l9(a.Ab())},a)),c=Wa(b,function(a){return a.ge()});b=[];for(var d=a.H.C,e=0;e<d.length;e++){var f=a.ma.C(d[e].id);f&&b.push(AJ(f))}Tea(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.$Fa&&d.push(f.value.getTitle())}b=kb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function I_(a,b){M.call(this,void 0);this.C=new H_(a,b);this.Fa(this.C,!0);this.D=!1}x(I_,Ead);I_.prototype.Ga=function(){I_.ea.Ga.call(this);Bh(this.getElement(),"pub-dialog-published-content-container")};I_.prototype.F=function(){return this.C.H};I_.prototype.H=function(a){var b=this.C;b.H=a.clone();nbd(b)};I_.prototype.J=function(a){!a&&this.C.Io()&&(this.D=!0);this.C.Na(a);a&&this.D&&(this.Qb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function pbd(a,b,c,d,e,f,h){var k=null!=h?Zad(h):null;h=new ebd(c,d,k,!0);k=new ebd(c,d,k,!1);E_.call(this,a,b,e,f1a,f,h,k,new I_(c,d),"/publishingsettings",new qbd);this.Df=c;this.zc=d}x(pbd,E_);
pbd.prototype.tHa=function(a){if(a.entireDocument)return new G_(!0,[],[]);var b=a.charts||"";a=Wa((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=Ua(a,function(a){return null!=BF(this.Df,a)},this);b=Wa(b.split(","),function(a){return parseInt(a,10)});b=Ua(b,v(function(a){return!!this.zc.C(a)},this));b=Wa(b,function(a){var b=this.zc.C(a);return new dbd(a,b.Ab())},this);return new G_(!1,a,b)};pbd.prototype.$Ga=function(){return new G_(!0,[],[])};
function Mad(a,b){if(b.F||null!=b.ah){var c="html"==b.D;a=Pad(a,c?"/pubhtml":"/pub");null!=b.ah&&(a=fl(a,"gid",b.ah,"single","true"));c||(a=fl(a,"output",b.D))}else a=fl(Pad(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function Nad(a,b){var c=Mad(a,b);if(b.F||null!=b.ah)c=fl(c,"widget","true","headers","false");a=b.C?(a=a.zc.C(b.C.id))?a.bd():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Pb(c)+'"></iframe>'}function qbd(){}x(qbd,M);qbd.prototype.xa=function(){this.Ua=N(Xad,{locale:"en"})};function rbd(){A.call(this)}x(rbd,oB);p=rbd.prototype;p.Ehb=function(){return q$c};p.Vhb=function(){return M9c};p.FNb=function(a,b,c,d){var e=new Cs;a=new Vq(a,b,c,d,void 0,!0,void 0);ar(a,"ok");b=v(e.hb,e);a.Zma=b;a.qa(e);a.Qi=!0;a.r7=yda(Jb);return a};p.Djb=function(){return F9c};p.P8a=function(a,b,c,d,e,f,h){return new k$c(a,b,c,d,e,f,h,void 0)};p.eib=function(){return T8c};p.OGa=function(){return j9c};p.tib=function(){return t9c};p.Ijb=function(){return w_};p.Hjb=function(){return pbd};
p.ojb=function(){return s$c};p.Gjb=function(){return P9c};p.Zhb=function(){return Q$c};p.Ejb=function(){return N$c};p.Fjb=function(){return nad};p.Yhb=function(){return k_};p.nib=function(){return m8c};p.nkb=function(){return n8c};uB("dialogs",rbd);
